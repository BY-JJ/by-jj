<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.36">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="h.ico"><title>LH的学习笔记</title><meta name="description" content="描述：学习笔记">
    <link rel="modulepreload" href="/by-jj/assets/app.f5f78651.js"><link rel="modulepreload" href="/by-jj/assets/C__JC2.html.ee117102.js"><link rel="modulepreload" href="/by-jj/assets/C__JC2.html.346ef5f2.js"><link rel="modulepreload" href="/by-jj/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/by-jj/assets/style.686345b1.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/by-jj/" class=""><img class="logo" src="/by-jj/laoshi.png" alt="LH的学习笔记"><span class="site-name can-hide">LH的学习笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/by-jj/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/by-jj/guild/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="汇编"><span class="title">汇编</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="汇编"><span class="title">汇编</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="计算机硬件基础"><!--[--><!--]--> 计算机硬件基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="汇编基础"><!--[--><!--]--> 汇编基础 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C语言"><span class="title">C语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C语言"><span class="title">C语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C/" class="" aria-label="C语法基础"><!--[--><!--]--> C语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG/" class="" aria-label="数据结构基础一"><!--[--><!--]--> 数据结构基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG2/" class="" aria-label="数据结构基础二"><!--[--><!--]--> 数据结构基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CTG/" class="" aria-label="C提高"><!--[--><!--]--> C提高 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CSL/" class="" aria-label="C实例"><!--[--><!--]--> C实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C++"><span class="title">C++</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C++"><span class="title">C++</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC1/" class="" aria-label="C++基础一"><!--[--><!--]--> C++基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC2/" class="" aria-label="C++基础二"><!--[--><!--]--> C++基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC3/" class="" aria-label="C++基础三"><!--[--><!--]--> C++基础三 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++KF/" class="" aria-label="C++开发"><!--[--><!--]--> C++开发 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="C#语法基础"><!--[--><!--]--> C#语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="坦克大战"><!--[--><!--]--> 坦克大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="飞机大战"><!--[--><!--]--> 飞机大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="噩梦射手"><!--[--><!--]--> 噩梦射手 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Qt"><span class="title">Qt</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Qt"><span class="title">Qt</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtBJ/" class="" aria-label="Qt笔记"><!--[--><!--]--> Qt笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtCoin/" class="" aria-label="Qt翻金币小游戏"><!--[--><!--]--> Qt翻金币小游戏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6/" class="" aria-label="Qt6基础"><!--[--><!--]--> Qt6基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qml/" class="" aria-label="Qml基础"><!--[--><!--]--> Qml基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpencv/" class="" aria-label="Qtopencv"><!--[--><!--]--> Qtopencv <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpenGL/" class="" aria-label="QtopenGL"><!--[--><!--]--> QtopenGL <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/3D/" class="" aria-label="Qtquick3D基础"><!--[--><!--]--> Qtquick3D基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6KFJC/" class="" aria-label="Qt6跨平台开发基础"><!--[--><!--]--> Qt6跨平台开发基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6SL/" class="" aria-label="Qt6实例"><!--[--><!--]--> Qt6实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Go"><span class="title">Go</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Go"><span class="title">Go</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoYFJC/" class="" aria-label="Go语法基础"><!--[--><!--]--> Go语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoGJYF/" class="" aria-label="Go高级语法"><!--[--><!--]--> Go高级语法 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK1/" class="" aria-label="数据库一"><!--[--><!--]--> 数据库一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK2/" class="" aria-label="数据库二"><!--[--><!--]--> 数据库二 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/by-jj/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/by-jj/guild/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="汇编"><span class="title">汇编</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="汇编"><span class="title">汇编</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="计算机硬件基础"><!--[--><!--]--> 计算机硬件基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="汇编基础"><!--[--><!--]--> 汇编基础 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C语言"><span class="title">C语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C语言"><span class="title">C语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C/" class="" aria-label="C语法基础"><!--[--><!--]--> C语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG/" class="" aria-label="数据结构基础一"><!--[--><!--]--> 数据结构基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG2/" class="" aria-label="数据结构基础二"><!--[--><!--]--> 数据结构基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CTG/" class="" aria-label="C提高"><!--[--><!--]--> C提高 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CSL/" class="" aria-label="C实例"><!--[--><!--]--> C实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C++"><span class="title">C++</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C++"><span class="title">C++</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC1/" class="" aria-label="C++基础一"><!--[--><!--]--> C++基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC2/" class="" aria-label="C++基础二"><!--[--><!--]--> C++基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC3/" class="" aria-label="C++基础三"><!--[--><!--]--> C++基础三 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++KF/" class="" aria-label="C++开发"><!--[--><!--]--> C++开发 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="C#语法基础"><!--[--><!--]--> C#语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="坦克大战"><!--[--><!--]--> 坦克大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="飞机大战"><!--[--><!--]--> 飞机大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="噩梦射手"><!--[--><!--]--> 噩梦射手 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Qt"><span class="title">Qt</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Qt"><span class="title">Qt</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtBJ/" class="" aria-label="Qt笔记"><!--[--><!--]--> Qt笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtCoin/" class="" aria-label="Qt翻金币小游戏"><!--[--><!--]--> Qt翻金币小游戏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6/" class="" aria-label="Qt6基础"><!--[--><!--]--> Qt6基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qml/" class="" aria-label="Qml基础"><!--[--><!--]--> Qml基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpencv/" class="" aria-label="Qtopencv"><!--[--><!--]--> Qtopencv <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpenGL/" class="" aria-label="QtopenGL"><!--[--><!--]--> QtopenGL <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/3D/" class="" aria-label="Qtquick3D基础"><!--[--><!--]--> Qtquick3D基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6KFJC/" class="" aria-label="Qt6跨平台开发基础"><!--[--><!--]--> Qt6跨平台开发基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6SL/" class="" aria-label="Qt6实例"><!--[--><!--]--> Qt6实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Go"><span class="title">Go</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Go"><span class="title">Go</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoYFJC/" class="" aria-label="Go语法基础"><!--[--><!--]--> Go语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoGJYF/" class="" aria-label="Go高级语法"><!--[--><!--]--> Go高级语法 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK1/" class="" aria-label="数据库一"><!--[--><!--]--> 数据库一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK2/" class="" aria-label="数据库二"><!--[--><!--]--> 数据库二 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC2.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label><!--[--><!--]-->  <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-类和对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.类和对象"><!--[--><!--]--> 4.类和对象 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-1-类和对象的基本概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.1  类和对象的基本概念"><!--[--><!--]--> 4.1  类和对象的基本概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-2-面向对象程序设计案例" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2 面向对象程序设计案例"><!--[--><!--]--> 4.2 面向对象程序设计案例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-3-对象的构造和析构" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.3 对象的构造和析构"><!--[--><!--]--> 4.3 对象的构造和析构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-4-c-面向对象模型初探" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.4 c++面向对象模型初探"><!--[--><!--]--> 4.4 c++面向对象模型初探 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-5-友元" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.5 友元"><!--[--><!--]--> 4.5 友元 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC2.html#_4-6-运算符重载" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.6 运算符重载"><!--[--><!--]--> 4.6 运算符重载 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="_4-类和对象" tabindex="-1"><a class="header-anchor" href="#_4-类和对象" aria-hidden="true">#</a> 4.类和对象</h2><h3 id="_4-1-类和对象的基本概念" tabindex="-1"><a class="header-anchor" href="#_4-1-类和对象的基本概念" aria-hidden="true">#</a> 4.1 类和对象的基本概念</h3><h4 id="_4-1-1-c和c-中struct的区别" tabindex="-1"><a class="header-anchor" href="#_4-1-1-c和c-中struct的区别" aria-hidden="true">#</a> 4.1.1 C和C++中struct的区别</h4><ul><li><p>c语言struct只有变量</p></li><li><p>c++语言struct 既有变量，也有函数</p></li></ul><h4 id="_4-1-2-类的封装" tabindex="-1"><a class="header-anchor" href="#_4-1-2-类的封装" aria-hidden="true">#</a> 4.1.2 类的封装</h4><p>我们编写程序的目的是为了解决现实中的问题，而这些问题的构成都是由各种事物组成，我们在计算机中要解决这种问题，首先要做就是要将这个问题的参与者：事和物抽象到计算机程序中，也就是用程序语言表示现实的事物。</p><p>那么现在问题是如何用程序语言来表示现实事物？现实世界的事物所具有的共性就是每个事物都具有自身的属性，一些自身具有的行为，所以如果我们能把事物的属性和行为表示出来，那么就可以抽象出来这个事物。</p><p>比如我们要表示人这个对象，在c语言中，我们可以这么表示:</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_Person</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Person<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_Aninal</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> age<span class="token punctuation">;</span>
	<span class="token keyword">int</span> type<span class="token punctuation">;</span> <span class="token comment">//动物种类</span>
<span class="token punctuation">}</span>Ainmal<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">PersonEat</span><span class="token punctuation">(</span>Person<span class="token operator">*</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s在吃人吃的饭!\n&quot;</span><span class="token punctuation">,</span>person<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">AnimalEat</span><span class="token punctuation">(</span>Ainmal<span class="token operator">*</span> animal<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s在吃动物吃的饭!\n&quot;</span><span class="token punctuation">,</span> animal<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person person<span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">&quot;小明&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
	<span class="token function">AnimalEat</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>定义一个结构体用来表示一个对象所包含的属性，函数用来表示一个对象所具有的行为，这样我们就表示出来一个事物，在c语言中，行为和属性是分开的，也就是说吃饭这个属性不属于某类对象，而属于所有的共同的数据，所以不单单是PeopleEat可以调用Person数据，AnimalEat也可以调用Person数据，那么万一调用错误，将会导致问题发生。</p><p>从这个案例我们应该可以体会到，属性和行为应该放在一起，一起表示一个具有属性和行为的对象。</p><p>假如某对象的某项属性不想被外界获知，比如说漂亮女孩的年龄不想被其他人知道，那么年龄这条属性应该作为女孩自己知道的属性；或者女孩的某些行为不想让外界知道，只需要自己知道就可以。那么这种情况下，封装应该再提供一种机制能够给属性和行为的访问权限控制住。</p><p>所以说封装特性包含两个方面，一个是属性和变量合成一个整体，一个是给属性和函数增加访问权限。</p><ul><li>封装</li></ul><ol><li><p>把变量（属性）和函数（操作）合成一个整体，封装在一个类中</p></li><li><p>对变量和函数进行访问控制</p></li></ol><ul><li>访问权限</li></ul><ol><li><p>在类的内部(作用域范围内)，没有访问权限之分，所有成员可以相互访问</p></li><li><p>在类的外部(作用域范围外)，访问权限才有意义：public，private，protected</p></li><li><p>在类的外部，只有public修饰的成员才能被访问，在没有涉及继承与派生时，private和protected是同等级的，外部不允许访问</p></li></ol><table><thead><tr><th>访问属性</th><th>属性</th><th>对象内部</th><th>对象外部</th></tr></thead><tbody><tr><td>public</td><td>公有</td><td>可访问</td><td>可访问</td></tr><tr><td>protected</td><td>保护</td><td>可访问</td><td>不可访问</td></tr><tr><td>private</td><td>私有</td><td>可访问</td><td>不可访问</td></tr></tbody></table><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//封装两层含义</span>
<span class="token comment">//1. 属性和行为合成一个整体</span>
<span class="token comment">//2. 访问控制，现实事物本身有些属性和行为是不对外开放</span>
class Person<span class="token punctuation">{</span>
<span class="token comment">//人具有的行为(函数)</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Dese</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;我有钱，年轻，个子又高，就爱嘚瑟!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">//人的属性(变量)</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mTall<span class="token punctuation">;</span> <span class="token comment">//多高，可以让外人知道</span>
protected<span class="token operator">:</span>
	<span class="token keyword">int</span> mMoney<span class="token punctuation">;</span> <span class="token comment">// 有多少钱,只能儿子孙子知道</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span> <span class="token comment">//年龄，不想让外人知道</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person p<span class="token punctuation">;</span>
	p<span class="token punctuation">.</span>mTall <span class="token operator">=</span> <span class="token number">220</span><span class="token punctuation">;</span>
	<span class="token comment">//p.mMoney 保护成员外部无法访问</span>
	<span class="token comment">//p.mAge 私有成员外部无法访问</span>
	p<span class="token punctuation">.</span><span class="token function">Dese</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>[struct和class的区别?]</strong></p><p>class默认访问权限为private,struct默认访问权限为public.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class A<span class="token punctuation">{</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">B</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	A a<span class="token punctuation">;</span>
	B b<span class="token punctuation">;</span>
	<span class="token comment">//a.mAge; //无法访问私有成员</span>
	b<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span> <span class="token comment">//可正常外部访问</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_4-1-3-将成员变量设置为private" tabindex="-1"><a class="header-anchor" href="#_4-1-3-将成员变量设置为private" aria-hidden="true">#</a> 4.1.3 将成员变量设置为private</h4><ol><li>可赋予客户端访问数据的一致性。</li></ol><p>如果成员变量不是public，客户端唯一能够访问对象的方法就是通过成员函数。如果类中所有public权限的成员都是函数，客户在访问类成员时只会默认访问函数，不需要考虑访问的成员需不需要添加(),这就省下了许多搔首弄耳的时间。</p><ol start="2"><li>可细微划分访问控制。</li></ol><p>使用成员函数可使得我们对变量的控制处理更加精细。如果我们让所有的成员变量为public，每个人都可以读写它。如果我们设置为private，我们可以实现“不准访问”、“只读访问”、“读写访问”，甚至你可以写出“只写访问”。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class AccessLevels<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//对只读属性进行只读访问</span>
	<span class="token keyword">int</span> <span class="token function">getReadOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> readOnly<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token comment">//对读写属性进行读写访问</span>
	<span class="token keyword">void</span> <span class="token function">setReadWrite</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span> readWrite <span class="token operator">=</span> val<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getReadWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> readWrite<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token comment">//对只写属性进行只写访问</span>
	<span class="token keyword">void</span> <span class="token function">setWriteOnly</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span> writeOnly <span class="token operator">=</span> val<span class="token punctuation">;</span> <span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> readOnly<span class="token punctuation">;</span> <span class="token comment">//对外只读访问</span>
	<span class="token keyword">int</span> noAccess<span class="token punctuation">;</span> <span class="token comment">//外部不可访问</span>
	<span class="token keyword">int</span> readWrite<span class="token punctuation">;</span> <span class="token comment">//读写访问</span>
	<span class="token keyword">int</span> writeOnly<span class="token punctuation">;</span> <span class="token comment">//只写访问</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_4-1-4-练习" tabindex="-1"><a class="header-anchor" href="#_4-1-4-练习" aria-hidden="true">#</a> 4.1.4 练习</h4><p>请设计一个Person类，Person类具有name和age属性，提供初始化函数(Init)，并提供对name和age的读写函数(set，get)，但必须确保age的赋值在有效范围内(0-100),超出有效范围，则拒绝赋值，并提供方法输出姓名和年龄.(10分钟)</p><h3 id="_4-2-面向对象程序设计案例" tabindex="-1"><a class="header-anchor" href="#_4-2-面向对象程序设计案例" aria-hidden="true">#</a> 4.2 面向对象程序设计案例</h3><h4 id="_4-2-1-设计立方体类" tabindex="-1"><a class="header-anchor" href="#_4-2-1-设计立方体类" aria-hidden="true">#</a> 4.2.1 设计立方体类</h4><p>设计立方体类(Cube)，求出立方体的面积( 2<em>a</em>b + 2<em>a</em>c + 2<em>b</em>c )和体积( a * b * c)，分别用全局函数和成员函数判断两个立方体是否相等。</p><p><img src="/by-jj/C++/wpsB0B5.tmp.png" alt="wpsB0B5.tmp.png"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//立方体类</span>
class Cub<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">setL</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">)</span><span class="token punctuation">{</span> mL <span class="token operator">=</span> l<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">setW</span><span class="token punctuation">(</span><span class="token keyword">int</span> w<span class="token punctuation">)</span><span class="token punctuation">{</span> mW <span class="token operator">=</span> w<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">setH</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">{</span> mH <span class="token operator">=</span> h<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mL<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mW<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mH<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token comment">//立方体面积</span>
	<span class="token keyword">int</span> <span class="token function">caculateS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>mL<span class="token operator">*</span>mW <span class="token operator">+</span> mL<span class="token operator">*</span>mH <span class="token operator">+</span> mW<span class="token operator">*</span>mH<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token comment">//立方体体积</span>
	<span class="token keyword">int</span> <span class="token function">caculateV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mL <span class="token operator">*</span> mW <span class="token operator">*</span> mH<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token comment">//成员方法</span>
	bool <span class="token function">CubCompare</span><span class="token punctuation">(</span>Cub<span class="token operator">&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">.</span><span class="token function">getL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">.</span><span class="token function">getW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">.</span><span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mL<span class="token punctuation">;</span> <span class="token comment">//长</span>
	<span class="token keyword">int</span> mW<span class="token punctuation">;</span> <span class="token comment">//宽</span>
	<span class="token keyword">int</span> mH<span class="token punctuation">;</span> <span class="token comment">//高</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//比较两个立方体是否相等</span>
bool <span class="token function">CubCompare</span><span class="token punctuation">(</span>Cub<span class="token operator">&amp;</span> c1<span class="token punctuation">,</span> Cub<span class="token operator">&amp;</span> c2<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>c1<span class="token punctuation">.</span><span class="token function">getL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c2<span class="token punctuation">.</span><span class="token function">getL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> c1<span class="token punctuation">.</span><span class="token function">getW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c2<span class="token punctuation">.</span><span class="token function">getW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> c1<span class="token punctuation">.</span><span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> c2<span class="token punctuation">.</span><span class="token function">getH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Cub c1<span class="token punctuation">,</span> c2<span class="token punctuation">;</span>
	c1<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	c1<span class="token punctuation">.</span><span class="token function">setW</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	c1<span class="token punctuation">.</span><span class="token function">setH</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	c2<span class="token punctuation">.</span><span class="token function">setL</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	c2<span class="token punctuation">.</span><span class="token function">setW</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	c2<span class="token punctuation">.</span><span class="token function">setH</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1面积:&quot;</span> <span class="token operator">&lt;&lt;</span> c1<span class="token punctuation">.</span><span class="token function">caculateS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; 体积:&quot;</span> <span class="token operator">&lt;&lt;</span> c1<span class="token punctuation">.</span><span class="token function">caculateV</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c2面积:&quot;</span> <span class="token operator">&lt;&lt;</span> c2<span class="token punctuation">.</span><span class="token function">caculateS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; 体积:&quot;</span> <span class="token operator">&lt;&lt;</span> c2<span class="token punctuation">.</span><span class="token function">caculateV</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//比较两个立方体是否相等</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">CubCompare</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1和c2相等!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1和c2不相等!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>c1<span class="token punctuation">.</span><span class="token function">CubCompare</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1和c2相等!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1和c2不相等!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><h4 id="_4-2-2-点和圆的关系" tabindex="-1"><a class="header-anchor" href="#_4-2-2-点和圆的关系" aria-hidden="true">#</a> 4.2.2 点和圆的关系</h4><p>设计一个圆形类（AdvCircle），和一个点类（Point），计算点和圆的关系。</p><p>假如圆心坐标为x0, y0, 半径为r，点的坐标为x1, y1：</p><p>1）点在圆上：(x1-x0)(x1-x0) + (y1-y0)(y1-y0) == r*r</p><p>2）点在圆内：(x1-x0)(x1-x0) + (y1-y0)(y1-y0) &lt; r*r</p><p>3）点在圆外：(x1-x0)(x1-x0) + (y1-y0)(y1-y0) &gt; r*r</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//点类</span>
class Point<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">setX</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> mX <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">setY</span><span class="token punctuation">(</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span> mY <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mX<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mY<span class="token punctuation">;</span> <span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mX<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mY<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//圆类</span>
class Circle<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">setP</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mP<span class="token punctuation">.</span><span class="token function">setX</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mP<span class="token punctuation">.</span><span class="token function">setY</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">setR</span><span class="token punctuation">(</span><span class="token keyword">int</span> r<span class="token punctuation">)</span><span class="token punctuation">{</span> mR <span class="token operator">=</span> r<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	Point<span class="token operator">&amp;</span> <span class="token function">getP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mP<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> mR<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token comment">//判断点和圆的关系</span>
	<span class="token keyword">void</span> <span class="token function">IsPointInCircle</span><span class="token punctuation">(</span>Point<span class="token operator">&amp;</span> point<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> distance <span class="token operator">=</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> mP<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> mP<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> mP<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> mP<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> radius <span class="token operator">=</span> mR <span class="token operator">*</span> mR<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>distance <span class="token operator">&lt;</span> radius<span class="token punctuation">)</span><span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Point(&quot;</span> <span class="token operator">&lt;&lt;</span> point<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> point<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)在圆内!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>distance <span class="token operator">&gt;</span> radius<span class="token punctuation">)</span><span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Point(&quot;</span> <span class="token operator">&lt;&lt;</span> point<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> point<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)在圆外!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span><span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Point(&quot;</span> <span class="token operator">&lt;&lt;</span> point<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">&lt;&lt;</span> point<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;)在圆上!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	Point mP<span class="token punctuation">;</span> <span class="token comment">//圆心</span>
	<span class="token keyword">int</span> mR<span class="token punctuation">;</span> <span class="token comment">//半径</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//实例化圆对象</span>
	Circle circle<span class="token punctuation">;</span>
	circle<span class="token punctuation">.</span><span class="token function">setP</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	circle<span class="token punctuation">.</span><span class="token function">setR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//实例化点对象</span>
	Point point<span class="token punctuation">;</span>
	point<span class="token punctuation">.</span><span class="token function">setX</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	point<span class="token punctuation">.</span><span class="token function">setY</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	circle<span class="token punctuation">.</span><span class="token function">IsPointInCircle</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h3 id="_4-3-对象的构造和析构" tabindex="-1"><a class="header-anchor" href="#_4-3-对象的构造和析构" aria-hidden="true">#</a> 4.3 对象的构造和析构</h3><h4 id="_4-3-1初始化和清理" tabindex="-1"><a class="header-anchor" href="#_4-3-1初始化和清理" aria-hidden="true">#</a> 4.3.1初始化和清理</h4><p>我们大家在购买一台电脑或者手机，或者其他的产品，这些产品都有一个初始设置，也就是这些产品对被创建的时候会有一个基础属性值。那么随着我们使用手机和电脑的时间越来越久，那么电脑和手机会慢慢被我们手动创建很多文件数据，某一天我们不用手机或电脑了，那么我们应该将电脑或手机中我们增加的数据删除掉，保护自己的信息数据。</p><p>从这样的过程中，我们体会一下，所有的事物在起初的时候都应该有个初始状态，当这个事物完成其使命时，应该及时清除外界作用于上面的一些信息数据。</p><p>那么我们c++中OO思想也是来源于现实，是对现实事物的抽象模拟，具体来说，当我们创建对象的时候,这个对象应该有一个初始状态，当对象销毁之前应该销毁自己创建的一些数据。</p><p>对象的初始化和清理也是两个非常重要的安全问题，一个对象或者变量没有初始时，对其使用后果是未知，同样的使用完一个变量，没有及时清理，也会造成一定的安全问题。c++为了给我们提供这种问题的解决方案，<strong>构造函数</strong>和<strong>析构函数</strong>，这两个函数将会被编译器自动调用，完成对象初始化和对象清理工作。</p><p><strong>无论你是否喜欢，对象的初始化和清理工作是编译器强制我们要做的事情，即使你不提供初始化操作和清理操作，编译器也会给你增加默认的操作，只是这个默认初始化操作不会做任何事，所以编写类就应该顺便提供初始化函数。</strong></p><p>为什么初始化操作是自动调用而不是手动调用？既然是必须操作，那么自动调用会更好，如果靠程序员自觉，那么就会存在遗漏初始化的情况出现。</p><h4 id="_4-3-2-构造函数和析构函数" tabindex="-1"><a class="header-anchor" href="#_4-3-2-构造函数和析构函数" aria-hidden="true">#</a> 4.3.2 构造函数和析构函数</h4><p>构造函数主要作用在于创建对象时为对象的成员属性赋值，构造函数由编译器自动调用，无须手动调用。</p><p>析构函数主要用于对象<strong>销毁前</strong>系统自动调用，执行一些清理工作。</p><p><strong>构造函数语法：</strong></p><ul><li>构造函数函数名和类名相同，没有返回值，不能有void，但可以有参数。</li></ul><p>ClassName(){}</p><p><strong>析构函数语法：</strong></p><ul><li>析构函数函数名是在类名前面加”~”组成,没有返回值，不能有void,不能有参数，不能重载。</li></ul><p>~ClassName(){}</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造函数调用!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mTall <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>
		mMoney <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构函数调用!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">free</span><span class="token punctuation">(</span>pName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			pName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mTall<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mMoney<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person person<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>pName <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mTall <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mMoney <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="_4-3-3-构造函数的分类及调用" tabindex="-1"><a class="header-anchor" href="#_4-3-3-构造函数的分类及调用" aria-hidden="true">#</a> 4.3.3 构造函数的分类及调用</h4><ul><li><p>按参数类型：分为无参构造函数和有参构造函数</p></li><li><p>按类型分类：普通构造函数和拷贝构造函数(复制构造函数)</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;no param constructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//有参构造函数</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;1 param constructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//拷贝构造函数(复制构造函数) 使用另一个对象初始化本对象</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;copy constructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> person<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//打印年龄</span>
	<span class="token keyword">void</span> <span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Age:&quot;</span> <span class="token operator">&lt;&lt;</span> mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//1. 无参构造调用方式</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token comment">//调用无参构造函数</span>
	Person person1<span class="token punctuation">;</span> 
	person1<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//无参构造函数错误调用方式</span>
	<span class="token comment">//Person person2();</span>
	<span class="token comment">//person2.PrintPerson();</span>
<span class="token punctuation">}</span>
<span class="token comment">//2. 调用有参构造函数</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token comment">//第一种 括号法，最常用</span>
	Person <span class="token function">person01</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person01<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//调用拷贝构造函数</span>
	Person <span class="token function">person02</span><span class="token punctuation">(</span>person01<span class="token punctuation">)</span><span class="token punctuation">;</span>
	person02<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//第二种 匿名对象(显示调用构造函数)</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//匿名对象，没有名字的对象</span>

	Person person03 <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person03<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//注意: 使用匿名对象初始化判断调用哪一个构造函数，要看匿名对象的参数类型</span>
	Person <span class="token function">person06</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//等价于 Person person06 = Person(400);</span>
	person06<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//第三种 =号法 隐式转换</span>
	Person person04 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//Person person04 =  Person(100)</span>
	person04<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//调用拷贝构造</span>
	Person person05 <span class="token operator">=</span> person04<span class="token punctuation">;</span> <span class="token comment">//Person person05 =  Person(person04)</span>
	person05<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p><strong>b为A的实例化对象,A a = A(b) 和 A(b)的区别？</strong></p><p>当A(b) 有变量来接的时候，那么编译器认为他是一个匿名对象，当没有变量来接的时候，编译器认为你A(b) 等价于 A b.</p><p>**注意:**不能调用拷贝构造函数去初始化匿名对象,也就是说以下代码不正确:</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Teacher<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;默认构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token keyword">const</span> Teacher<span class="token operator">&amp;</span> teacher<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;拷贝构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	Teacher t1<span class="token punctuation">;</span>
	<span class="token comment">//error C2086:“Teacher t1”: 重定义</span>
	<span class="token function">Teacher</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//此时等价于 Teacher t1;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="_4-3-4-拷贝构造函数的调用时机" tabindex="-1"><a class="header-anchor" href="#_4-3-4-拷贝构造函数的调用时机" aria-hidden="true">#</a> 4.3.4 拷贝构造函数的调用时机</h4><ul><li><p>对象以值传递的方式传给函数参数</p></li><li><p>函数局部对象以值传递的方式从函数返回(vs debug模式下调用一次拷贝构造，qt不调用任何构造)</p></li><li><p>用一个对象初始化另一个对象</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;no param contructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;param constructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;copy constructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> person<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;destructor!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//1. 旧对象初始化新对象</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p1</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person p2 <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person p3 <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token comment">// 相当于Person p2 = Person(p);</span>
<span class="token punctuation">}</span>

<span class="token comment">//2. 传递的参数是普通对象，函数参数也是普通对象，传递将会调用拷贝构造</span>
<span class="token keyword">void</span> <span class="token function">doBussiness</span><span class="token punctuation">(</span>Person p<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">doBussiness</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 函数返回局部对象</span>
Person <span class="token function">MyBusiness</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;局部p:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//vs release、qt下没有调用拷贝构造函数</span>
	<span class="token comment">//vs debug下调用一次拷贝构造函数</span>
	Person p <span class="token operator">=</span> <span class="token function">MyBusiness</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;局部p:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p><strong>[Test03结果说明:]</strong></p><p>编译器存在一种对返回值的优化技术,RVO(Return Value Optimization).在vs debug模式下并没有进行这种优化，所以函数MyBusiness中创建p对象，调用了一次构造函数，当编译器发现你要返回这个局部的对象时，编译器通过调用拷贝构造生成一个临时Person对象返回，然后调用p的析构函数。</p><p>我们从常理来分析的话，这个匿名对象和这个局部的p对象是相同的两个对象，那么如果能直接返回p对象，就会省去一个拷贝构造和一个析构函数的开销，在程序中一个对象的拷贝也是非常耗时的，如果减少这种拷贝和析构的次数，那么从另一个角度来说，也是编译器对程序执行效率上进行了优化。</p><p>所以在这里，编译器偷偷帮我们做了一层优化：</p><p>当我们这样去调用: Person p = MyBusiness();</p><p>编译器偷偷将我们的代码更改为:</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">MyBussiness</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> _result<span class="token punctuation">)</span><span class="token punctuation">{</span>
       _result<span class="token punctuation">.</span>X<span class="token operator">:</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用Person默认拷贝构造函数</span>
       <span class="token comment">//.....对_result进行处理</span>
       <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   Person p<span class="token punctuation">;</span> <span class="token comment">//这里只分配空间，不初始化</span>
   <span class="token function">MyBussiness</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_4-3-5-构造函数调用规则" tabindex="-1"><a class="header-anchor" href="#_4-3-5-构造函数调用规则" aria-hidden="true">#</a> 4.3.5 构造函数调用规则</h4><ul><li>默认情况下，c++编译器至少为我们写的类增加3个函数</li></ul><ol><li><p>默认构造函数(无参，函数体为空)</p></li><li><p>默认析构函数(无参，函数体为空)</p></li><li><p>默认拷贝构造函数，对类中非静态成员属性简单值拷贝</p></li></ol><ul><li><p>如果用户定义拷贝构造函数，c++不会再提供任何默认构造函数</p></li><li><p>如果用户定义了普通构造(非拷贝)，c++不在提供默认无参构造，但是会提供默认拷贝构造</p></li></ul><h4 id="_4-3-6-深拷贝和浅拷贝" tabindex="-1"><a class="header-anchor" href="#_4-3-6-深拷贝和浅拷贝" aria-hidden="true">#</a> 4.3.6 深拷贝和浅拷贝</h4><h5 id="_4-3-6-1-浅拷贝" tabindex="-1"><a class="header-anchor" href="#_4-3-6-1-浅拷贝" aria-hidden="true">#</a> 4.3.6.1 浅拷贝</h5><p>同一类型的对象之间可以赋值，使得两个对象的成员变量的值相同，两个对象仍然是独立的两个对象，这种情况被称为<strong>浅拷贝</strong></p><p>一般情况下，浅拷贝没有任何副作用，但是当类中有指针，并且指针指向动态分配的内存空间，析构函数做了动态内存释放的处理，会导致内存问题。</p><p><img src="/by-jj/C++/wps7984.tmp.jpg" alt="wps7984.tmp.jpg"></p><h5 id="_4-3-6-2-深拷贝" tabindex="-1"><a class="header-anchor" href="#_4-3-6-2-深拷贝" aria-hidden="true">#</a> 4.3.6.2 深拷贝</h5><p>当类中有指针，并且此指针有动态分配空间，析构函数做了释放处理，往往需要自定义拷贝构造函数，自行给指针动态分配空间，深拷贝。</p><p><img src="/by-jj/C++/wpsB19D.tmp.jpg" alt="wpsB19D.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//增加拷贝构造函数</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>pName<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> person<span class="token punctuation">.</span>pName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> person<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">free</span><span class="token punctuation">(</span>pName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token string">&quot;Edward&quot;</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//用对象p1初始化对象p2,调用c++提供的默认拷贝构造函数</span>
	Person p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="_4-3-7-多个对象构造和析构" tabindex="-1"><a class="header-anchor" href="#_4-3-7-多个对象构造和析构" aria-hidden="true">#</a> 4.3.7 多个对象构造和析构</h4><h5 id="_4-3-7-1-初始化列表" tabindex="-1"><a class="header-anchor" href="#_4-3-7-1-初始化列表" aria-hidden="true">#</a> 4.3.7.1 初始化列表</h5><p>构造函数和其他函数不同，除了有名字，参数列表，函数体之外还有初始化列表。</p><p>初始化列表简单使用:</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
	<span class="token comment">//传统方式初始化</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mA <span class="token operator">=</span> a<span class="token punctuation">;</span>
		mB <span class="token operator">=</span> b<span class="token punctuation">;</span>
		mC <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
	<span class="token comment">//初始化列表方式初始化</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">mA</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">mB</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">mC</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;mA:&quot;</span> <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;mB:&quot;</span> <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;mC:&quot;</span> <span class="token operator">&lt;&lt;</span> mC <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mC<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>**注意：**初始化成员列表(参数列表)只能在构造函数使用。</p><h5 id="_4-3-7-2-类对象作为成员" tabindex="-1"><a class="header-anchor" href="#_4-3-7-2-类对象作为成员" aria-hidden="true">#</a> 4.3.7.2 类对象作为成员</h5><p>在类中定义的数据成员一般都是基本的数据类型。但是类中的成员也可以是对象，叫做<strong>对象成员</strong>。</p><p>C++中对对象的初始化是非常重要的操作，当创建一个对象的时候，c++编译器必须确保调用了所有子对象的构造函数。如果所有的子对象有默认构造函数，编译器可以自动调用他们。但是如果子对象没有默认的构造函数，或者想指定调用某个构造函数怎么办？</p><p>那么是否可以在类的构造函数直接调用子类的属性完成初始化呢？但是如果子类的成员属性是私有的，我们是没有办法访问并完成初始化的。</p><p>解决办法非常简单：对于子类调用构造函数，c++为此提供了专门的语法，即构造函数初始化列表。</p><p>当调用构造函数时，首先按各对象成员在类定义中的顺序（和参数列表的顺序无关）依次调用它们的构造函数，对这些对象初始化，最后再调用本身的函数体。也就是说，先调用对象成员的构造函数，再调用本身的构造函数。</p><p>析构函数和构造函数调用顺序相反，先构造，后析构。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//汽车类</span>
class Car<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car 默认构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mName <span class="token operator">=</span> <span class="token string">&quot;大众汽车&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Car</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car 带参数构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Car 析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	string mName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//拖拉机</span>
class Tractor<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Tractor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Tractor 默认构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mName <span class="token operator">=</span> <span class="token string">&quot;爬土坡专用拖拉机&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Tractor</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Tractor 带参数构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Tractor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Tractor 析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	string mName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//人类</span>
class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span></span></span>
	<span class="token comment">//类mCar不存在合适的构造函数</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
	<span class="token comment">//初始化列表可以指定调用构造函数</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>string carName<span class="token punctuation">,</span> string tracName<span class="token punctuation">,</span> string name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">mTractor</span><span class="token punctuation">(</span>tracName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mCar</span><span class="token punctuation">(</span>carName<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person 构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
	
	<span class="token keyword">void</span> <span class="token function">GoWorkByCar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;开着&quot;</span> <span class="token operator">&lt;&lt;</span> mCar<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;去上班!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">GoWorkByTractor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;开着&quot;</span> <span class="token operator">&lt;&lt;</span> mTractor<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;去上班!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person 析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	string mName<span class="token punctuation">;</span>
	Car mCar<span class="token punctuation">;</span>
	Tractor mTractor<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//Person person(&quot;宝马&quot;, &quot;东风拖拉机&quot;, &quot;赵四&quot;);</span>
	Person <span class="token function">person</span><span class="token punctuation">(</span><span class="token string">&quot;刘能&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span><span class="token function">GoWorkByCar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span><span class="token function">GoWorkByTractor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><h4 id="_4-3-8-explicit-关键字" tabindex="-1"><a class="header-anchor" href="#_4-3-8-explicit-关键字" aria-hidden="true">#</a> 4.3.8 explicit 关键字</h4><p>c++提供了关键字，禁止通过构造函数进行的隐式转换。声明为explicit的构造函数不能在隐式转换中使用。</p><p><strong>[explicit注意]</strong></p><ul><li><p>explicit用于修饰构造函数,防止隐式转化。</p></li><li><p>是针对单参数的构造函数(或者除了第一个参数外其余参数都有默认值的多参构造)而言。</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class MyString<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	explicit <span class="token function">MyString</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyString(int n)!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">MyString</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyString(const char* str)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token comment">//给字符串赋值？还是初始化？</span>
	<span class="token comment">//MyString str1 = 1; </span>
	MyString <span class="token function">str2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//寓意非常明确，给字符串赋值</span>
	MyString str3 <span class="token operator">=</span> <span class="token string">&quot;abcd&quot;</span><span class="token punctuation">;</span>
	MyString <span class="token function">str4</span><span class="token punctuation">(</span><span class="token string">&quot;abcd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="_4-3-9-动态对象创建" tabindex="-1"><a class="header-anchor" href="#_4-3-9-动态对象创建" aria-hidden="true">#</a> 4.3.9 动态对象创建</h4><p>当我们创建数组的时候，总是需要提前预定数组的长度，然后编译器分配预定长度的数组空间，在使用数组的时，会有这样的问题，数组也许空间太大了，浪费空间，也许空间不足，所以对于数组来讲，如果能根据需要来分配空间大小再好不过。</p><p>所以动态的意思意味着不确定性。</p><p>为了解决这个普遍的编程问题，在运行中可以创建和销毁对象是最基本的要求。当然c早就提供了动态内存分配（dynamic memory allocation）,函数malloc和free可以在运行时从堆中分配存储单元。</p><p>然而这些函数在c++中不能很好的运行，因为它不能帮我们完成对象的初始化工作。</p><h5 id="_4-3-9-1-对象创建" tabindex="-1"><a class="header-anchor" href="#_4-3-9-1-对象创建" aria-hidden="true">#</a> 4.3.9.1 对象创建</h5><p>当创建一个c++对象时会发生两件事:</p><ol><li><p>为对象分配内存</p></li><li><p>调用构造函数来初始化那块内存</p></li></ol><p>第一步我们能保证实现，需要我们确保第二步一定能发生。c++强迫我们这么做是因为使用未初始化的对象是程序出错的一个重要原因。</p><h5 id="_4-3-9-2-c动态分配内存方法" tabindex="-1"><a class="header-anchor" href="#_4-3-9-2-c动态分配内存方法" aria-hidden="true">#</a> 4.3.9.2 C动态分配内存方法</h5><p>为了在运行时动态分配内存，c在他的标准库中提供了一些函数,malloc以及它的变种calloc和realloc,释放内存的free,这些函数是有效的、但是原始的，需要程序员理解和小心使用。为了使用c的动态内存分配函数在堆上创建一个类的实例，我们必须这样做:</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mAge <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">&quot;john&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> <span class="token string">&quot;john&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mAge <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">&quot;john&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> <span class="token string">&quot;john&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">free</span><span class="token punctuation">(</span>pName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token comment">//分配内存</span>
	Person<span class="token operator">*</span> person <span class="token operator">=</span> <span class="token punctuation">(</span>Person<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>person <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//调用初始化函数</span>
	person<span class="token operator">-&gt;</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//清理对象</span>
	person<span class="token operator">-&gt;</span><span class="token function">Clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//释放person对象</span>
	<span class="token function">free</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p><strong>问题：</strong></p><ol><li><p>程序员必须确定对象的长度。</p></li><li><p>malloc返回一个void* 指针，c++不允许将void* 赋值给其他任何指针，必须强转。</p></li><li><p>malloc可能申请内存失败，所以必须判断返回值来确保内存分配成功。</p></li></ol><p>4)用户在使用对象之前必须记住对他初始化，构造函数不能显示调用初始化(构造函数是由编译器调用)，用户有可能忘记调用初始化函数。</p><p>c的动态内存分配函数太复杂，容易令人混淆，是不可接受的，c++中我们推荐使用运算符new 和 delete.</p><h5 id="_4-3-9-3-new-operator" tabindex="-1"><a class="header-anchor" href="#_4-3-9-3-new-operator" aria-hidden="true">#</a> 4.3.9.3 new operator</h5><p>C++中解决动态内存分配的方案是把创建一个对象所需要的操作都结合在一个称为new的运算符里。当用new创建一个对象时，它就在堆里为对象分配内存并调用构造函数完成初始化。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>Person<span class="token operator">*</span> person <span class="token operator">=</span> new Person<span class="token punctuation">;</span>
相当于<span class="token operator">:</span>
Person<span class="token operator">*</span> person <span class="token operator">=</span> <span class="token punctuation">(</span>Person<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>person <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
person<span class="token operator">-&gt;</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 构造函数
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>New操作符能确定在调用构造函数初始化之前内存分配是成功的，所有不用显式确定调用是否成功。</p><p>现在我们发现在堆里创建对象的过程变得简单了，只需要一个简单的表达式，它带有内置的长度计算、类型转换和安全检查。这样在堆创建一个对象和在栈里创建对象一样简单。</p><h5 id="_4-3-9-4-delete-operator" tabindex="-1"><a class="header-anchor" href="#_4-3-9-4-delete-operator" aria-hidden="true">#</a> 4.3.9.4 delete operator</h5><p>new表达式的反面是delete表达式。delete表达式先调用析构函数，然后释放内存。正如new表达式返回一个指向对象的指针一样，delete需要一个对象的地址。</p><p>delete只适用于由new创建的对象。</p><p>如果使用一个由malloc或者calloc或者realloc创建的对象使用delete,这个行为是未定义的。因为大多数new和delete的实现机制都使用了malloc和free,所以很可能没有调用析构函数就释放了内存。</p><p>如果正在删除的对象的指针是NULL,将不发生任何事，因此建议在删除指针后，立即把指针赋值为NULL，以免对它删除两次，对一些对象删除两次可能会产生某些问题。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;无参构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;有参构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> pName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete pName<span class="token punctuation">;</span>
			pName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person<span class="token operator">*</span> person1 <span class="token operator">=</span> new Person<span class="token punctuation">;</span>
	Person<span class="token operator">*</span> person2 <span class="token operator">=</span> new <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	person1<span class="token operator">-&gt;</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person2<span class="token operator">-&gt;</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	delete person1<span class="token punctuation">;</span>
	delete person2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h5 id="_4-3-9-5-用于数组的new和delete" tabindex="-1"><a class="header-anchor" href="#_4-3-9-5-用于数组的new和delete" aria-hidden="true">#</a> 4.3.9.5 用于数组的new和delete</h5><p>使用new和delete在堆上创建数组非常容易。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//创建字符数组</span>
<span class="token keyword">char</span><span class="token operator">*</span> pStr <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//创建整型数组</span>
<span class="token keyword">int</span><span class="token operator">*</span> pArr1 <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token comment">//创建整型数组并初始化</span>
<span class="token keyword">int</span><span class="token operator">*</span> pArr2 <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//释放数组内存</span>
delete<span class="token punctuation">[</span><span class="token punctuation">]</span> pStr<span class="token punctuation">;</span>
delete<span class="token punctuation">[</span><span class="token punctuation">]</span> pArr1<span class="token punctuation">;</span>
delete<span class="token punctuation">[</span><span class="token punctuation">]</span> pArr2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>当创建一个对象数组的时候，必须对数组中的每一个对象调用构造函数，除了在栈上可以聚合初始化，必须提供一个默认的构造函数。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete pName<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//栈聚合初始化</span>
	Person person<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">&quot;john&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pName <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token comment">//创建堆上对象数组必须提供构造函数</span>
	Person<span class="token operator">*</span> workers <span class="token operator">=</span> new Person<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h5 id="_4-3-9-6-delete-void-可能会出错" tabindex="-1"><a class="header-anchor" href="#_4-3-9-6-delete-void-可能会出错" aria-hidden="true">#</a> 4.3.9.6 delete void*可能会出错</h5><p>如果对一个void* 指针执行delete操作，这将可能成为一个程序错误，除非指针指向的内容是非常简单的，因为它将不执行析构函数.以下代码未调用析构函数，导致可用内存减少。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		pName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>pName<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete pName<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">void</span><span class="token operator">*</span> person <span class="token operator">=</span> new <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">&quot;john&quot;</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	delete person<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>**问题：**malloc、free和new、delete可以混搭使用吗？也就是说malloc分配的内存，可以调用delete吗？通过new创建的对象，可以调用free来释放吗？</p><h5 id="_4-3-9-7-使用new和delete采用相同形式" tabindex="-1"><a class="header-anchor" href="#_4-3-9-7-使用new和delete采用相同形式" aria-hidden="true">#</a> 4.3.9.7 使用new和delete采用相同形式</h5><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>Person<span class="token operator">*</span> person <span class="token operator">=</span> new Person<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
delete person<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>以上代码有什么问题吗？(vs下直接中断、qt下析构函数调用一次)</p><p>使用了new也搭配使用了delete，问题在于Person有10个对象，那么其他9个对象可能没有调用析构函数，也就是说其他9个对象可能删除不完全，因为它们的析构函数没有被调用。</p><p>我们现在清楚使用new的时候发生了两件事: 一、分配内存；二、调用构造函数，那么调用delete的时候也有两件事：一、析构函数；二、释放内存。</p><p>那么刚才我们那段代码最大的问题在于：person指针指向的内存中到底有多少个对象，因为这个决定应该有多少个析构函数应该被调用。换句话说，person指针指向的是一个单一的对象还是一个数组对象，由于单一对象和数组对象的内存布局是不同的。更明确的说，数组所用的内存通常还包括“数组大小记录”，使得delete的时候知道应该调用几次析构函数。单一对象的话就没有这个记录。单一对象和数组对象的内存布局可理解为下图:</p><p><img src="/by-jj/C++/wps1FE8.tmp.jpg" alt="wps1FE8.tmp.jpg"></p><p>本图只是为了说明，编译器不一定如此实现，但是很多编译器是这样做的。</p><p>当我们使用一个delete的时候，我们必须让delete知道指针指向的内存空间中是否存在一个“数组大小记录”的办法就是我们告诉它。当我们使用delete[]，那么delete就知道是一个对象数组，从而清楚应该调用几次析构函数。</p><p><strong>结论:</strong></p><p>如果在new表达式中使用[]，必须在相应的delete表达式中也使用[].如果在new表达式中不使用[], 一定不要在相应的delete表达式中使用[].</p><h4 id="_4-3-10-静态成员" tabindex="-1"><a class="header-anchor" href="#_4-3-10-静态成员" aria-hidden="true">#</a> 4.3.10 静态成员</h4><p>在类定义中，它的成员（包括成员变量和成员函数），这些成员可以用关键字static声明为静态的，称为静态成员。</p><p>不管这个类创建了多少个对象，静态成员只有一个拷贝，这个拷贝被所有属于这个类的对象共享。</p><h5 id="_4-3-10-1-静态成员变量" tabindex="-1"><a class="header-anchor" href="#_4-3-10-1-静态成员变量" aria-hidden="true">#</a> 4.3.10.1 静态成员变量</h5><p>在一个类中，若将一个成员变量声明为static，这种成员称为静态成员变量。与一般的数据成员不同，无论建立了多少个对象，都只有一个静态数据的拷贝。静态成员变量，属于某个类，所有对象共享。</p><p>静态变量，是在编译阶段就分配空间，对象还没有创建时，就已经分配空间。</p><ul><li><p><strong>静态成员变量必须在类中声明，在类外定义。</strong></p></li><li><p><strong>静态数据成员不属于某个对象，在为对象分配空间中不包括静态成员所占空间。</strong></p></li><li><p><strong>静态数据成员可以通过类名或者对象名来引用。</strong></p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//类的静态成员属性</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> sNum<span class="token punctuation">;</span>
private<span class="token operator">:</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> sOther<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//类外初始化，初始化时不加static</span>
<span class="token keyword">int</span> Person<span class="token operator">::</span>sNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Person<span class="token operator">::</span>sOther <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>


	<span class="token comment">//1. 通过类名直接访问</span>
	Person<span class="token operator">::</span>sNum <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::sNum:&quot;</span> <span class="token operator">&lt;&lt;</span> Person<span class="token operator">::</span>sNum <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//2. 通过对象访问</span>
	Person p1<span class="token punctuation">,</span> p2<span class="token punctuation">;</span>
	p1<span class="token punctuation">.</span>sNum <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1.sNum:&quot;</span> <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span>sNum <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2.sNum:&quot;</span> <span class="token operator">&lt;&lt;</span> p2<span class="token punctuation">.</span>sNum <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//3. 静态成员也有访问权限，类外不能访问私有成员</span>
	<span class="token comment">//cout &lt;&lt; &quot;Person::sOther:&quot; &lt;&lt; Person::sOther &lt;&lt; endl;</span>
	Person p3<span class="token punctuation">;</span>
	<span class="token comment">//cout &lt;&lt; &quot;p3.sOther:&quot; &lt;&lt; p3.sOther &lt;&lt; endl;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h5 id="_4-3-10-2-静态成员函数" tabindex="-1"><a class="header-anchor" href="#_4-3-10-2-静态成员函数" aria-hidden="true">#</a> 4.3.10.2 静态成员函数</h5><p>在类定义中，前面有static说明的成员函数称为静态成员函数。静态成员函数使用方式和静态变量一样，同样在对象没有创建前，即可通过类名调用。静态成员函数主要为了访问静态变量，但是，<strong>不能访问普通成员变量。</strong></p><p>静态成员函数的意义，不在于信息共享，数据沟通，而在于管理静态数据成员，完成对静态数据成员的封装。</p><ul><li><p>静态成员函数只能访问静态变量，不能访问普通成员变量</p></li><li><p>静态成员函数的使用和静态成员变量一样</p></li><li><p>静态成员函数也有访问权限</p></li><li><p>普通成员函数可访问静态成员变量、也可以访问非经常成员变量</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//普通成员函数可以访问static和non-static成员属性</span>
	<span class="token keyword">void</span> <span class="token function">changeParam1</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mParam <span class="token operator">=</span> param<span class="token punctuation">;</span>
		sNum <span class="token operator">=</span> param<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//静态成员函数只能访问static成员属性</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">changeParam2</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//mParam = param; //无法访问</span>
		sNum <span class="token operator">=</span> param<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">changeParam3</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//mParam = param; //无法访问</span>
		sNum <span class="token operator">=</span> param<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> sNum<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//静态成员属性类外初始化</span>
<span class="token keyword">int</span> Person<span class="token operator">::</span>sNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token comment">//1. 类名直接调用</span>
	Person<span class="token operator">::</span><span class="token function">changeParam2</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//2. 通过对象调用</span>
	Person p<span class="token punctuation">;</span>
	p<span class="token punctuation">.</span><span class="token function">changeParam2</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//3. 静态成员函数也有访问权限</span>
	<span class="token comment">//Person::changeParam3(100); //类外无法访问私有静态成员函数</span>
	<span class="token comment">//Person p1;</span>
	<span class="token comment">//p1.changeParam3(200);</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h5 id="_4-3-10-3-const静态成员属性" tabindex="-1"><a class="header-anchor" href="#_4-3-10-3-const静态成员属性" aria-hidden="true">#</a> 4.3.10.3 const静态成员属性</h5><p>如果一个类的成员，既要实现共享，又要实现不可改变，那就用 static const 修饰。<strong>定义静态const数据成员时，最好在类内部初始化</strong>。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//static const int mShare = 10;</span>
	<span class="token keyword">const</span> <span class="token keyword">static</span> <span class="token keyword">int</span> mShare <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//只读区，不可修改</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	cout <span class="token operator">&lt;&lt;</span> Person<span class="token operator">::</span>mShare <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//Person::mShare = 20;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="_4-3-10-4-静态成员实现单例模式" tabindex="-1"><a class="header-anchor" href="#_4-3-10-4-静态成员实现单例模式" aria-hidden="true">#</a> 4.3.10.4 静态成员实现单例模式</h5><p>单例模式是一种常用的软件设计模式。在它的核心结构中只包含一个被称为单例的特殊类。<strong>通过单例模式可以保证系统中一个类只有一个实例而且该实例易于外界访问</strong>，从而方便对实例个数的控制并节约系统资源。如果希望在系统中某个类的对象只能存在一个，单例模式是最好的解决方案。</p><p><img src="/by-jj/C++/wpsA66F.tmp.png" alt="wpsA66F.tmp.png"></p><p>Singleton（单例）：在单例类的内部实现只生成一个实例，同时它提供一个静态的getInstance()工厂方法，让客户可以访问它的唯一实例；为了防止在外部对其实例化，将其默认构造函数和拷贝构造函数设计为私有；在单例类内部定义了一个Singleton类型的静态对象，作为外部共享的唯一实例。</p><p><strong>用单例模式，模拟公司员工使用打印机场景，打印机可以打印员工要输出的内容，并且可以累积打印机使用次数。</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Printer<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">static</span> Printer<span class="token operator">*</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> pPrinter<span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">PrintText</span><span class="token punctuation">(</span>string text<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印内容:&quot;</span> <span class="token operator">&lt;&lt;</span> text <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;已打印次数:&quot;</span> <span class="token operator">&lt;&lt;</span> mTimes <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;--------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		mTimes<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token function">Printer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> mTimes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token function">Printer</span><span class="token punctuation">(</span><span class="token keyword">const</span> Printer<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">static</span> Printer<span class="token operator">*</span> pPrinter<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mTimes<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Printer<span class="token operator">*</span> Printer<span class="token operator">::</span>pPrinter <span class="token operator">=</span> new Printer<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Printer<span class="token operator">*</span> printer <span class="token operator">=</span> Printer<span class="token operator">::</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	printer<span class="token operator">-&gt;</span><span class="token function">PrintText</span><span class="token punctuation">(</span><span class="token string">&quot;离职报告!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	printer<span class="token operator">-&gt;</span><span class="token function">PrintText</span><span class="token punctuation">(</span><span class="token string">&quot;入职合同!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	printer<span class="token operator">-&gt;</span><span class="token function">PrintText</span><span class="token punctuation">(</span><span class="token string">&quot;提交代码!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="_4-4-c-面向对象模型初探" tabindex="-1"><a class="header-anchor" href="#_4-4-c-面向对象模型初探" aria-hidden="true">#</a> 4.4 c++面向对象模型初探</h3><h4 id="_4-4-1-成员变量和函数的存储" tabindex="-1"><a class="header-anchor" href="#_4-4-1-成员变量和函数的存储" aria-hidden="true">#</a> 4.4.1 成员变量和函数的存储</h4><p>在c语言中，“分开来声明的，也就是说，语言本身并没有支持“数据”和“函数”之间的关联性我们把这种程序方法称为“程序性的”，由一组“分布在各个以功能为导航的函数中”的算法驱动，它们处理的是共同的外部数据。</p><p>c++实现了“封装”，那么数据(成员属性)和操作(成员函数)是什么样的呢？</p><p>“数据”和“处理数据的操作(函数)”是分开存储的。</p><ul><li><p>c++中的****非静态数据成员****直接内含在类对象中，就像c struct一样。</p></li><li><p>成员函数(member function)虽然内含在class声明之内，却不出现在对象中。</p></li><li><p>每一个非内联成员函数(non-inline member function)只会诞生一份函数实例.</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class MyClass01<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class MyClass02<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> sB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class MyClass03<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">printMyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;hello world!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> sB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class MyClass04<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">printMyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;hello world!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">ShowMyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;hello world！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> sB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	MyClass01 mclass01<span class="token punctuation">;</span>
	MyClass02 mclass02<span class="token punctuation">;</span>
	MyClass03 mclass03<span class="token punctuation">;</span>
	MyClass04 mclass04<span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyClass01:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>mclass01<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//4</span>
	<span class="token comment">//静态数据成员并不保存在类对象中</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyClass02:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>mclass02<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//4</span>
	<span class="token comment">//非静态成员函数不保存在类对象中</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyClass03:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>mclass03<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//4</span>
	<span class="token comment">//静态成员函数也不保存在类对象中</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyClass04:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>mclass04<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//4</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p><strong>通过上面的案例，我们可以的得出：C++类对象中的变量和函数是分开存储。</strong></p><h4 id="_4-4-2-this指针" tabindex="-1"><a class="header-anchor" href="#_4-4-2-this指针" aria-hidden="true">#</a> 4.4.2 this指针</h4><h5 id="_4-4-2-1-this指针工作原理" tabindex="-1"><a class="header-anchor" href="#_4-4-2-1-this指针工作原理" aria-hidden="true">#</a> 4.4.2.1 this指针工作原理</h5><p>通过上例我们知道，c++的数据和操作也是分开存储，并且每一个非内联成员函数(non-inline member function)只会诞生一份函数实例，也就是说多个同类型的对象会共用一块代码</p><p>那么问题是：这一块代码是如何区分那个对象调用自己的呢？</p><p><img src="/by-jj/C++/wpsA89.tmp.jpg" alt="wpsA89.tmp.jpg"></p><p>c++通过提供特殊的对象指针，this指针，解决上述问题。this指针指向被调用的成员函数所属的对象。</p><p>c++规定，this指针是隐含在对象成员函数内的一种指针。当一个对象被创建后，它的每一个成员函数都含有一个系统自动生成的隐含指针this，用以保存这个对象的地址，也就是说虽然我们没有写上this指针，编译器在编译的时候也是会加上的。因此this也称为“指向本对象的指针”，this指针并不是对象的一部分，不会影响sizeof(对象)的结果。</p><p>this指针是C++实现封装的一种机制，它将对象和该对象调用的成员函数连接在一起，在外部看来，每一个对象都拥有自己的函数成员。一般情况下，并不写this，而是让系统进行默认设置。</p><p><strong>this指针永远指向当前对象。</strong></p><p>成员函数通过this指针即可知道操作的是那个对象的数据。This指针是一种隐含指针，它隐含于每个类的非静态成员函数中。This指针无需定义，直接使用即可。</p><p>**注意：**静态成员函数内部没有this指针，静态成员函数不能操作非静态成员变量。</p><p><strong>c++编译器对普通成员函数的内部处理</strong></p><p><img src="/by-jj/C++/wps6358.tmp.jpg" alt="wps6358.tmp.jpg"></p><h5 id="_4-4-2-2-this-指针的使用" tabindex="-1"><a class="header-anchor" href="#_4-4-2-2-this-指针的使用" aria-hidden="true">#</a> 4.4.2.2 this 指针的使用</h5><ul><li><p>当形参和成员变量同名时，可用this指针来区分</p></li><li><p>在类的非静态成员函数中返回对象本身，可使用return *this.</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//1. 当形参名和成员变量名一样时，this指针可用来区分</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//name = name;</span>
		<span class="token comment">//age = age; //输出错误</span>
		this<span class="token operator">-&gt;</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//2. 返回对象本身的引用</span>
	<span class="token comment">//重载赋值操作符</span>
	<span class="token comment">//其实也是两个参数，其中隐藏了一个this指针</span>
	Person <span class="token function">PersonPlusPerson</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		string newname <span class="token operator">=</span> this<span class="token operator">-&gt;</span>name <span class="token operator">+</span> person<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
		<span class="token keyword">int</span> newage <span class="token operator">=</span> this<span class="token operator">-&gt;</span>age <span class="token operator">+</span> person<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
		Person <span class="token function">newperson</span><span class="token punctuation">(</span>newname<span class="token punctuation">,</span> newage<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> newperson<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	string name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//3. 成员函数和全局函数(Perosn对象相加)</span>
Person <span class="token function">PersonPlusPerson</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> p1<span class="token punctuation">,</span>Person<span class="token operator">&amp;</span> p2<span class="token punctuation">)</span><span class="token punctuation">{</span>
	string newname <span class="token operator">=</span> p1<span class="token punctuation">.</span>name <span class="token operator">+</span> p2<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
	<span class="token keyword">int</span> newage <span class="token operator">=</span> p1<span class="token punctuation">.</span>age <span class="token operator">+</span> p2<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
	Person <span class="token function">newperson</span><span class="token punctuation">(</span>newname<span class="token punctuation">,</span>newage<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> newperson<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person <span class="token function">person</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;---------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Person <span class="token function">person1</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">person2</span><span class="token punctuation">(</span><span class="token string">&quot;001&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//1.全局函数实现两个对象相加</span>
	Person person3 <span class="token operator">=</span> <span class="token function">PersonPlusPerson</span><span class="token punctuation">(</span>person1<span class="token punctuation">,</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	person1<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person2<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person3<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//2. 成员函数实现两个对象相加</span>
	Person person4 <span class="token operator">=</span> person1<span class="token punctuation">.</span><span class="token function">PersonPlusPerson</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	person4<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h5 id="_4-4-2-3-const-修饰成员函数" tabindex="-1"><a class="header-anchor" href="#_4-4-2-3-const-修饰成员函数" aria-hidden="true">#</a> 4.4.2.3 const 修饰成员函数</h5><ul><li><p>用const修饰的成员函数时，const修饰this指针指向的内存区域，成员函数体内不可以修改本类中的任何普通成员变量，</p></li><li><p>当成员变量类型符前用mutable修饰时例外。</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//const修饰成员函数</span>
class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//在函数括号后面加上const,修饰成员变量不可修改,除了mutable变量</span>
	<span class="token keyword">void</span> <span class="token function">sonmeOperate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
		<span class="token comment">//this-&gt;mAge = 200; //mAge不可修改</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ID:&quot;</span> <span class="token operator">&lt;&lt;</span> mID <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; mAge:&quot;</span> <span class="token operator">&lt;&lt;</span> mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
	mutable <span class="token keyword">int</span> mID<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person person<span class="token punctuation">;</span>
	person<span class="token punctuation">.</span><span class="token function">sonmeOperate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	person<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h5 id="_4-4-2-4-const修饰对象-常对象" tabindex="-1"><a class="header-anchor" href="#_4-4-2-4-const修饰对象-常对象" aria-hidden="true">#</a> 4.4.2.4 const修饰对象（常对象）</h5><ul><li><p>常对象只能调用const的成员函数</p></li><li><p>常对象可访问 const 或非 const 数据成员，不能修改，除非成员用mutable修饰</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ChangePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
		mAge <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
		mID <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ID:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mID <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

public<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
	mutable <span class="token keyword">int</span> mID<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>	
	<span class="token keyword">const</span> Person person<span class="token punctuation">;</span>
	<span class="token comment">//1. 可访问数据成员</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Age:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//person.mAge = 300; //不可修改</span>
	person<span class="token punctuation">.</span>mID <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span> <span class="token comment">//但是可以修改mutable修饰的成员变量</span>
	<span class="token comment">//2. 只能访问const修饰的函数</span>
	<span class="token comment">//person.ShowPerson();</span>
	person<span class="token punctuation">.</span><span class="token function">ChangePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_4-5-友元" tabindex="-1"><a class="header-anchor" href="#_4-5-友元" aria-hidden="true">#</a> 4.5 友元</h3><p>类的主要特点之一是数据隐藏，即类的私有成员无法在类的外部(作用域之外)访问。但是，有时候需要在类的外部访问类的私有成员，怎么办？</p><p>解决方法是使用友元函数，友元函数是一种特权函数，c++允许这个特权函数访问私有成员。这一点从现实生活中也可以很好的理解：</p><p>比如你的家，有客厅，有你的卧室，那么你的客厅是Public的，所有来的客人都可以进去，但是你的卧室是私有的，也就是说只有你能进去，但是呢，你也可以允许你的闺蜜好基友进去。</p><p>程序员可以把一个全局函数、某个类中的成员函数、甚至整个类声明为友元。</p><h4 id="_4-5-1-友元语法" tabindex="-1"><a class="header-anchor" href="#_4-5-1-友元语法" aria-hidden="true">#</a> 4.5.1 友元语法</h4><ul><li><p>friend关键字只出现在声明处</p></li><li><p>其他类、类成员函数、全局函数都可声明为友元</p></li><li><p>友元函数不是类的成员，不带this指针</p></li><li><p>友元函数可访问对象任意成员属性，包括私有属性</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Building<span class="token punctuation">;</span>
<span class="token comment">//友元类</span>
class MyFriend<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//友元成员函数</span>
	<span class="token keyword">void</span> <span class="token function">LookAtBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">PlayInBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Building<span class="token punctuation">{</span>
	<span class="token comment">//全局函数做友元函数</span>
	friend <span class="token keyword">void</span> <span class="token function">CleanBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
	<span class="token comment">//成员函数做友元函数</span>
	friend <span class="token keyword">void</span> MyFriend<span class="token operator">::</span><span class="token function">LookAtBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">;</span>
	friend <span class="token keyword">void</span> MyFriend<span class="token operator">::</span><span class="token function">PlayInBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span>	</span>
	<span class="token comment">//友元类</span>
	friend class MyFriend<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
public<span class="token operator">:</span>
	<span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
public<span class="token operator">:</span>
	string mSittingRoom<span class="token punctuation">;</span>
private<span class="token operator">:</span>
	string mBedroom<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> MyFriend<span class="token operator">::</span><span class="token function">LookAtBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;我的朋友参观&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token punctuation">.</span>mBedroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> MyFriend<span class="token operator">::</span><span class="token function">PlayInBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;我的朋友玩耍在&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token punctuation">.</span>mBedroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//友元全局函数</span>
<span class="token keyword">void</span> <span class="token function">CleanBedRoom</span><span class="token punctuation">(</span>Building<span class="token operator">&amp;</span> building<span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;友元全局函数访问&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token punctuation">.</span>mBedroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Building<span class="token operator">::</span><span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>mSittingRoom <span class="token operator">=</span> <span class="token string">&quot;客厅&quot;</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>mBedroom <span class="token operator">=</span> <span class="token string">&quot;卧室&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Building building<span class="token punctuation">;</span>
	MyFriend myfriend<span class="token punctuation">;</span>

	<span class="token function">CleanBedRoom</span><span class="token punctuation">(</span>building<span class="token punctuation">)</span><span class="token punctuation">;</span>
	myfriend<span class="token punctuation">.</span><span class="token function">LookAtBedRoom</span><span class="token punctuation">(</span>building<span class="token punctuation">)</span><span class="token punctuation">;</span>
	myfriend<span class="token punctuation">.</span><span class="token function">PlayInBedRoom</span><span class="token punctuation">(</span>building<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p><strong>[友元类注意]</strong></p><ol><li><p>友元关系不能被继承。</p></li><li><p>友元关系是单向的，类A是类B的朋友，但类B不一定是类A的朋友。</p></li><li><p>友元关系不具有传递性。类B是类A的朋友，类C是类B的朋友，但类C不一定是类A的朋友。</p></li></ol><p><strong>思考: c++是纯面向对象的吗？</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>如果一个类被声明为friend,意味着它不是这个类的成员函数，却可以修改这个类的私有成员，而且必须列在类的定义中，因此他是一个特权函数。c++不是完全的面向对象语言，而只是一个混合产品。增加friend关键字只是用来解决一些实际问题，这也说明这种语言是不纯的。毕竟c++设计的目的是为了实用性，而不是追求理想的抽象。
                                                       --- Thinking in C++
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_4-5-2-练习" tabindex="-1"><a class="header-anchor" href="#_4-5-2-练习" aria-hidden="true">#</a> 4.5.2 练习</h4><p>请编写电视机类，电视机有开机和关机状态，有音量，有频道，提供音量操作的方法，频道操作的方法。由于电视机只能逐一调整频道，不能指定频道，增加遥控类，遥控类除了拥有电视机已有的功能，再增加根据输入调台功能。</p><p>**提示：**遥控器可作为电视机类的友元类。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Remote<span class="token punctuation">;</span>

class Television<span class="token punctuation">{</span>
	friend class Remote<span class="token punctuation">;</span>
public<span class="token operator">:</span>
	<span class="token keyword">enum</span><span class="token punctuation">{</span> On<span class="token punctuation">,</span>Off <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//电视状态</span>
	<span class="token keyword">enum</span><span class="token punctuation">{</span> minVol<span class="token punctuation">,</span>maxVol <span class="token operator">=</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//音量从0到100</span>
	<span class="token keyword">enum</span><span class="token punctuation">{</span> minChannel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>maxChannel <span class="token operator">=</span> <span class="token number">255</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//频道从1到255</span>
	<span class="token function">Television</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mState <span class="token operator">=</span> Off<span class="token punctuation">;</span>
		mVolume <span class="token operator">=</span> minVol<span class="token punctuation">;</span>
		mChannel <span class="token operator">=</span> minChannel<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//打开电视机</span>
	<span class="token keyword">void</span> <span class="token function">OnOrOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mState <span class="token operator">=</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mState <span class="token operator">==</span> On <span class="token operator">?</span> Off <span class="token operator">:</span> On<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//调高音量</span>
	<span class="token keyword">void</span> <span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mVolume <span class="token operator">&gt;=</span> maxVol<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		this<span class="token operator">-&gt;</span>mVolume<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//调低音量</span>
	<span class="token keyword">void</span> <span class="token function">VolumeDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mVolume <span class="token operator">&lt;=</span> minVol<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		this<span class="token operator">-&gt;</span>mVolume<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//更换电视频道</span>
	<span class="token keyword">void</span> <span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mChannel <span class="token operator">&gt;=</span> maxChannel<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		this<span class="token operator">-&gt;</span>mChannel<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ChannelDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mChannel <span class="token operator">&lt;=</span> minChannel<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		this<span class="token operator">-&gt;</span>mChannel<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//展示当前电视状态信息</span>
	<span class="token keyword">void</span> <span class="token function">ShowTeleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;开机状态:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>mState <span class="token operator">==</span> On <span class="token operator">?</span> <span class="token string">&quot;已开机&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;已关机&quot;</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>mState <span class="token operator">==</span> On<span class="token punctuation">)</span><span class="token punctuation">{</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;当前音量:&quot;</span> <span class="token operator">&lt;&lt;</span> mVolume <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
			cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;当前频道:&quot;</span> <span class="token operator">&lt;&lt;</span> mChannel <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mState<span class="token punctuation">;</span> <span class="token comment">//电视状态，开机，还是关机</span>
	<span class="token keyword">int</span> mVolume<span class="token punctuation">;</span> <span class="token comment">//电视机音量</span>
	<span class="token keyword">int</span> mChannel<span class="token punctuation">;</span> <span class="token comment">//电视频道</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//电视机调台只能一个一个的调，遥控可以指定频道</span>
<span class="token comment">//电视遥控器</span>
class Remote<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Remote</span><span class="token punctuation">(</span>Television<span class="token operator">*</span> television<span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision <span class="token operator">=</span> television<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">OnOrOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision<span class="token operator">-&gt;</span><span class="token function">OnOrOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//调高音量</span>
	<span class="token keyword">void</span> <span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision<span class="token operator">-&gt;</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//调低音量</span>
	<span class="token keyword">void</span> <span class="token function">VolumeDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision<span class="token operator">-&gt;</span><span class="token function">VolumeDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//更换电视频道</span>
	<span class="token keyword">void</span> <span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision<span class="token operator">-&gt;</span><span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ChannelDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision<span class="token operator">-&gt;</span><span class="token function">ChannelDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//设置频道 遥控新增功能</span>
	<span class="token keyword">void</span> <span class="token function">SetChannel</span><span class="token punctuation">(</span><span class="token keyword">int</span> channel<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>channel <span class="token operator">&lt;</span> Television<span class="token operator">::</span>minChannel <span class="token operator">||</span> channel <span class="token operator">&gt;</span> Television<span class="token operator">::</span>maxChannel<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		pTelevision<span class="token operator">-&gt;</span>mChannel <span class="token operator">=</span> channel<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//显示电视当前信息</span>
	<span class="token keyword">void</span> <span class="token function">ShowTeleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		pTelevision<span class="token operator">-&gt;</span><span class="token function">ShowTeleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	Television<span class="token operator">*</span> pTelevision<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//直接操作电视</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Television television<span class="token punctuation">;</span>
	television<span class="token punctuation">.</span><span class="token function">ShowTeleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	television<span class="token punctuation">.</span><span class="token function">OnOrOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//开机</span>
	television<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//增加音量+1</span>
	television<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//增加音量+1</span>
	television<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//增加音量+1</span>
	television<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//增加音量+1</span>
	television<span class="token punctuation">.</span><span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//频道+1</span>
	television<span class="token punctuation">.</span><span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//频道+1</span>
	television<span class="token punctuation">.</span><span class="token function">ShowTeleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//通过遥控操作电视</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//创建电视</span>
	Television television<span class="token punctuation">;</span>
	<span class="token comment">//创建遥控</span>
	Remote <span class="token function">remote</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>television<span class="token punctuation">)</span><span class="token punctuation">;</span>
	remote<span class="token punctuation">.</span><span class="token function">OnOrOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	remote<span class="token punctuation">.</span><span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//频道+1</span>
	remote<span class="token punctuation">.</span><span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//频道+1</span>
	remote<span class="token punctuation">.</span><span class="token function">ChannelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//频道+1</span>
	remote<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//音量+1</span>
	remote<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//音量+1</span>
	remote<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//音量+1</span>
	remote<span class="token punctuation">.</span><span class="token function">VolumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//音量+1</span>
	remote<span class="token punctuation">.</span><span class="token function">ShowTeleState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br></div></div><h4 id="_4-5-3-强化训练-数组类封装" tabindex="-1"><a class="header-anchor" href="#_4-5-3-强化训练-数组类封装" aria-hidden="true">#</a> 4.5.3 强化训练（数组类封装）</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//MyArray.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span>  <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
using namespace std<span class="token punctuation">;</span>

class MyArray
<span class="token punctuation">{</span>
public<span class="token operator">:</span>

	<span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//默认构造  初始容量为100</span>
	<span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//有参构造  参数为初始容量</span>
	<span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyArray<span class="token operator">&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//拷贝构造</span>

	<span class="token keyword">void</span> <span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//尾插</span>
	<span class="token keyword">void</span> <span class="token function">setData</span><span class="token punctuation">(</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//根据位置设置数据</span>
	<span class="token keyword">int</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token keyword">int</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//根据位置获取数据</span>
	<span class="token keyword">int</span> <span class="token function">getCapacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取容量</span>
	<span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取大小</span>
	<span class="token operator">~</span><span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//析构函数</span>

private<span class="token operator">:</span>

	<span class="token keyword">int</span> m_Capacity<span class="token punctuation">;</span> <span class="token comment">//数组的容量</span>
	<span class="token keyword">int</span> m_Size<span class="token punctuation">;</span>     <span class="token comment">//数组的大小</span>
	<span class="token keyword">int</span> <span class="token operator">*</span> pAddress<span class="token punctuation">;</span>  <span class="token comment">//维护在堆区开辟的数组的指针</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//MyArray.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;myArray.h&quot;</span></span>

MyArray<span class="token operator">::</span><span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;默认构造调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>pAddress <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span>this<span class="token operator">-&gt;</span>m_Capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
MyArray<span class="token operator">::</span><span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;有参构造调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>pAddress <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span>this<span class="token operator">-&gt;</span>m_Capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
MyArray<span class="token operator">::</span><span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyArray<span class="token operator">&amp;</span> arr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;拷贝构造调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">=</span> arr<span class="token punctuation">.</span>m_Capacity<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> arr<span class="token punctuation">.</span>m_Size<span class="token punctuation">;</span>
	<span class="token comment">//this-&gt;pAddress = arr.pAddress;</span>

	this<span class="token operator">-&gt;</span>pAddress <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span>arr<span class="token punctuation">.</span>m_Capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">//for (int i = 0; i &lt; arr.m_Size;i++)</span>
	<span class="token comment">//{</span>
	<span class="token comment">//	this-&gt;pAddress[i] = arr.pAddress[i];</span>
	<span class="token comment">//}</span>

	<span class="token function">memcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">,</span> arr<span class="token punctuation">.</span>pAddress<span class="token punctuation">,</span> arr<span class="token punctuation">.</span>m_Size<span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> MyArray<span class="token operator">::</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">[</span>this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> MyArray<span class="token operator">::</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> MyArray<span class="token operator">::</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token keyword">int</span> pos<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> MyArray<span class="token operator">::</span><span class="token function">getCapacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>m_Capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> MyArray<span class="token operator">::</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
MyArray<span class="token operator">::</span><span class="token operator">~</span><span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pAddress <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		delete <span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>pAddress <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//TestMyArray.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;myArray.h&quot;</span></span>

<span class="token comment">//测试构造和析构</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	MyArray arr<span class="token punctuation">;</span>
	MyArray <span class="token function">arr2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	MyArray <span class="token function">arr3</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//测试其他接口</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	MyArray <span class="token function">arr</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;数组的容量： &quot;</span> <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">.</span><span class="token function">getCapacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;数组的大小 ： &quot;</span> <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	arr<span class="token punctuation">.</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	arr<span class="token punctuation">.</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	arr<span class="token punctuation">.</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	arr<span class="token punctuation">.</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	arr<span class="token punctuation">.</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-----------------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;数组的容量： &quot;</span> <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">.</span><span class="token function">getCapacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;数组的大小 ： &quot;</span> <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	arr<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;数组中第0个数据位：&quot;</span> <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	MyArray <span class="token function">arr2</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr2<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> arr2<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="_4-6-运算符重载" tabindex="-1"><a class="header-anchor" href="#_4-6-运算符重载" aria-hidden="true">#</a> 4.6 运算符重载</h3><h4 id="_4-6-1-运算符重载基本概念" tabindex="-1"><a class="header-anchor" href="#_4-6-1-运算符重载基本概念" aria-hidden="true">#</a> 4.6.1 运算符重载基本概念</h4><p>运算符重载，就是对已有的运算符重新进行定义，赋予其另一种功能，以适应不同的数据类型。</p><p><strong>运算符重载(operator overloading)只是一种,也就是它只是另一种函数调用的方式。</strong></p><p>在c++中，可以定义一个处理类的新运算符。这种定义很像一个普通的函数定义，只是函数的名字由关键字operator及其紧跟的运算符组成。差别仅此而已。它像任何其他函数一样也是一个函数，当编译器遇到适当的模式时，就会调用这个函数。</p><p><strong>语法：</strong></p><p>定义重载的运算符就像定义函数，只是该函数的名字是operator@,这里的@代表了被重载的运算符。函数的参数中参数个数取决于两个因素。</p><ul><li><p>运算符是一元(一个参数)的还是二元(两个参数)；</p></li><li><p>运算符被定义为全局函数(对于一元是一个参数，对于二元是两个参数)还是成员函数(对于一元没有参数，对于二元是一个参数-此时该类的对象用作左参数)</p></li></ul><p><strong>[两个极端]</strong></p><p>有些人很容易滥用运算符重载。它确实是一个有趣的工具。但是应该注意，它仅仅是一种语法上的方便而已，是另外一种函数调用的方式。从这个角度来看，只有在能使涉及类的代码更易写，尤其是更易读时**(请记住，读代码的机会比我们写代码多多了)**才有理由重载运算符。如果不是这样，就改用其他更易用，更易读的方式。</p><p>对于运算符重载，另外一个常见的反应是恐慌：突然之间，C运算符的含义变得不同寻常了，一切都变了，所有C代码的功能都要改变！并非如此，对于内置的数据类型的表达式的的运算符是不可能改变的。（例如想重载int类型数据的+号）</p><h4 id="_4-6-2-运算符重载碰上友元函数" tabindex="-1"><a class="header-anchor" href="#_4-6-2-运算符重载碰上友元函数" aria-hidden="true">#</a> 4.6.2 运算符重载碰上友元函数</h4><p>友元函数是一个全局函数，和我们上例写的全局函数类似，只是友元函数可以访问某个类私有数据。</p><p><strong>案例: 重载左移操作符(&lt;&lt;),使得cout可以输出对象。</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
	friend ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">;</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mID <span class="token operator">=</span> id<span class="token punctuation">;</span>
		mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mID<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
	os <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ID:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mID <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
	<span class="token keyword">return</span> os<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person <span class="token function">person</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//cout &lt;&lt; person; //cout.operator+(person)</span>
	cout <span class="token operator">&lt;&lt;</span> person <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; | &quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="_4-6-3-可重载的运算符" tabindex="-1"><a class="header-anchor" href="#_4-6-3-可重载的运算符" aria-hidden="true">#</a> 4.6.3 可重载的运算符</h4><p>几乎C中所有的运算符都可以重载，但运算符重载的使用时相当受限制的。特别是不能使用C中当前没有意义的运算符(例如用**求幂)不能改变运算符优先级，不能改变运算符的参数个数。这样的限制有意义，否则，所有这些行为产生的运算符只会混淆而不是澄清寓语意。</p><p><img src="/by-jj/C++/wps111D.tmp.jpg" alt="wps111D.tmp.jpg"></p><h4 id="_4-6-4-自增自减-运算符重载" tabindex="-1"><a class="header-anchor" href="#_4-6-4-自增自减-运算符重载" aria-hidden="true">#</a> 4.6.4 自增自减（++/--）运算符重载</h4><p>重载的++和--运算符有点让人不知所措，因为我们总是希望能根据它们出现在所作用对象的前面还是后面来调用不同的函数。解决办法很简单，例如当编译器看到++a(前置++)，它就调用operator++(a),当编译器看到a++（后置++），它就会去调用operator++(a,int).</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Complex<span class="token punctuation">{</span>
	friend ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span>Complex<span class="token operator">&amp;</span> complex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		os <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A:&quot;</span> <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">.</span>mA <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; B:&quot;</span> <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">.</span>mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> os<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token function">Complex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		mB <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//重载前置++</span>
	Complex<span class="token operator">&amp;</span> operator<span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mA<span class="token operator">++</span><span class="token punctuation">;</span>
		mB<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//重载后置++</span>
	Complex operator<span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>	
		Complex temp<span class="token punctuation">;</span>
		temp<span class="token punctuation">.</span>mA <span class="token operator">=</span> this<span class="token operator">-&gt;</span>mA<span class="token punctuation">;</span>
		temp<span class="token punctuation">.</span>mB <span class="token operator">=</span> this<span class="token operator">-&gt;</span>mB<span class="token punctuation">;</span>
		mA<span class="token operator">++</span><span class="token punctuation">;</span>
		mB<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> temp<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//前置--</span>
	Complex<span class="token operator">&amp;</span> operator<span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		mA<span class="token operator">--</span><span class="token punctuation">;</span>
		mB<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//后置--</span>
	Complex operator<span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		Complex temp<span class="token punctuation">;</span>
		temp<span class="token punctuation">.</span>mA <span class="token operator">=</span> mA<span class="token punctuation">;</span>
		temp<span class="token punctuation">.</span>mB <span class="token operator">=</span> mB<span class="token punctuation">;</span>
		mA<span class="token operator">--</span><span class="token punctuation">;</span>
		mB<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> temp<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">ShowComplex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A:&quot;</span> <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; B:&quot;</span> <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Complex complex<span class="token punctuation">;</span>
	complex<span class="token operator">++</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">;</span>
	<span class="token operator">++</span>complex<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">;</span>

	Complex ret <span class="token operator">=</span> complex<span class="token operator">++</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> ret<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	ret<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token operator">--</span>ret<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ret:&quot;</span> <span class="token operator">&lt;&lt;</span> ret<span class="token punctuation">;</span>
	complex<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token operator">--</span>complex<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;complex:&quot;</span> <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><p><strong>优先使用++和--的标准形式，优先调用前置++。</strong></p><p>如果定义了++c，也要定义c++，递增操作符比较麻烦，因为他们都有前缀和后缀形式，而两种语义略有不同。重载operator++和operator--时应该模仿他们对应的内置操作符。</p><p>对于++和--而言，后置形式是先返回，然后对象++或者--，返回的是对象的原值。前置形式，对象先++或--，返回当前对象，返回的是新对象。其标准形式为:</p><p><img src="/by-jj/C++/wps798D.tmp.jpg" alt="wps798D.tmp.jpg"></p><p>调用代码时候，要优先使用前缀形式，除非确实需要后缀形式返回的原值，前缀和后缀形式语义上是等价的，输入工作量也相当，只是效率经常会略高一些，由于前缀形式少创建了一个临时对象。</p><h4 id="_4-6-5-指针运算符-重载" tabindex="-1"><a class="header-anchor" href="#_4-6-5-指针运算符-重载" aria-hidden="true">#</a> 4.6.5 指针运算符（*，-&gt;）重载</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mParam <span class="token operator">=</span> param<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Param:&quot;</span> <span class="token operator">&lt;&lt;</span> mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class SmartPointer<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">SmartPointer</span><span class="token punctuation">(</span>Person<span class="token operator">*</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>pPerson <span class="token operator">=</span> person<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//重载指针的-&gt;、*操作符</span>
	Person<span class="token operator">*</span> operator<span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> pPerson<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	Person<span class="token operator">&amp;</span> operator<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>pPerson<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">SmartPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pPerson <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete pPerson<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	Person<span class="token operator">*</span> pPerson<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token comment">//Person* person = new Person(100);</span>
	<span class="token comment">//如果忘记释放，那么就会造成内存泄漏</span>

	SmartPointer <span class="token function">pointer</span><span class="token punctuation">(</span>new <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pointer<span class="token operator">-&gt;</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h4 id="_4-6-6-赋值-运算符重载" tabindex="-1"><a class="header-anchor" href="#_4-6-6-赋值-运算符重载" aria-hidden="true">#</a> 4.6.6 赋值（=）运算符重载</h4><p>赋值符常常初学者的混淆。这是毫无疑问的，因为’=’在编程中是最基本的运算符，可以进行赋值操作，也能引起拷贝构造函数的调用。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
	friend ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		os <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ID:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mID <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> os<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> id<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//重载赋值运算符</span>
	Person<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> person<span class="token punctuation">.</span>mID<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> person<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mID<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//1. =号混淆的地方</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person <span class="token function">person1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person person2 <span class="token operator">=</span> person1<span class="token punctuation">;</span> <span class="token comment">//调用拷贝构造</span>
	<span class="token comment">//如果一个对象还没有被创建，则必须初始化，也就是调用构造函数</span>
	<span class="token comment">//上述例子由于person2还没有初始化，所以会调用构造函数</span>
	<span class="token comment">//由于person2是从已有的person1来创建的，所以只有一个选择</span>
	<span class="token comment">//就是调用拷贝构造函数</span>
	person2 <span class="token operator">=</span> person1<span class="token punctuation">;</span> <span class="token comment">//调用operator=函数</span>
	<span class="token comment">//由于person2已经创建，不需要再调用构造函数，这时候调用的是重载的赋值运算符</span>
<span class="token punctuation">}</span>
<span class="token comment">//2. 赋值重载案例</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person <span class="token function">person1</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">person2</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;person1:&quot;</span> <span class="token operator">&lt;&lt;</span> person1<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;person2:&quot;</span> <span class="token operator">&lt;&lt;</span> person2<span class="token punctuation">;</span>
	person2 <span class="token operator">=</span> person1<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;person2:&quot;</span> <span class="token operator">&lt;&lt;</span> person2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//常见错误，当准备给两个相同对象赋值时，应该首先检查一下这个对象是否对自身赋值了</span>
<span class="token comment">//对于本例来讲，无论如何执行这些赋值运算都是无害的，但如果对类的实现进行修改，那么将会出现差异；</span>
<span class="token comment">//3. 类中指针</span>
class Person2<span class="token punctuation">{</span>
	friend ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Person2<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>
		os <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>pName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; ID:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mID <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> os<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token function">Person2</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>pName <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> id<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span></span></span>
	<span class="token comment">//重载赋值运算符</span>
	Person2<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person2<span class="token operator">&amp;</span> person<span class="token punctuation">)</span><span class="token punctuation">{</span>

		<span class="token comment">//注意:由于当前对象已经创建完毕，那么就有可能pName指向堆内存</span>
		<span class="token comment">//这个时候如果直接赋值，会导致内存没有及时释放</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete<span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pName<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		this<span class="token operator">-&gt;</span>pName <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>pName<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName<span class="token punctuation">,</span>person<span class="token punctuation">.</span>pName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> person<span class="token punctuation">.</span>mID<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> person<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
	<span class="token comment">//析构函数</span>
	<span class="token operator">~</span><span class="token function">Person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete<span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pName<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mID<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Person2 <span class="token function">person1</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person2 <span class="token function">person2</span><span class="token punctuation">(</span><span class="token string">&quot;Edward&quot;</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;person1:&quot;</span> <span class="token operator">&lt;&lt;</span> person1<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;person2:&quot;</span> <span class="token operator">&lt;&lt;</span> person2<span class="token punctuation">;</span>
	person2 <span class="token operator">=</span> person1<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;person2:&quot;</span> <span class="token operator">&lt;&lt;</span> person2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br></div></div><p>如果没有重载赋值运算符，编译器会自动创建默认的赋值运算符重载函数。行为类似默认拷贝构造，进行简单值拷贝。</p><h4 id="_4-6-7-等于和不等于-运算符重载" tabindex="-1"><a class="header-anchor" href="#_4-6-7-等于和不等于-运算符重载" aria-hidden="true">#</a> 4.6.7 等于和不等于（== ，！=）运算符重载</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Complex<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Complex</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> id<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>pName <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mID <span class="token operator">=</span> id<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//重载==号操作符</span>
	bool operator<span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Complex<span class="token operator">&amp;</span> complex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName<span class="token punctuation">,</span>complex<span class="token punctuation">.</span>pName<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> 
		    this<span class="token operator">-&gt;</span>mID <span class="token operator">==</span> complex<span class="token punctuation">.</span>mID <span class="token operator">&amp;&amp;</span> 
			this<span class="token operator">-&gt;</span>mAge <span class="token operator">==</span> complex<span class="token punctuation">.</span>mAge<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//重载!=操作符</span>
	bool operator<span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Complex<span class="token operator">&amp;</span> complex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName<span class="token punctuation">,</span> complex<span class="token punctuation">.</span>pName<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> 
		    this<span class="token operator">-&gt;</span>mID <span class="token operator">!=</span> complex<span class="token punctuation">.</span>mID <span class="token operator">||</span> 
			this<span class="token operator">-&gt;</span>mAge <span class="token operator">!=</span> complex<span class="token punctuation">.</span>mAge<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> true<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> false<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Complex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete<span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pName<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mID<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Complex <span class="token function">complex1</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Complex <span class="token function">complex2</span><span class="token punctuation">(</span><span class="token string">&quot;bbb&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>complex1 <span class="token operator">==</span> complex2<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;相等!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>complex1 <span class="token operator">!=</span> complex2<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;不相等!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h4 id="_4-6-8-函数调用符号-重载" tabindex="-1"><a class="header-anchor" href="#_4-6-8-函数调用符号-重载" aria-hidden="true">#</a> 4.6.8 函数调用符号（）重载</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Complex<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Complex complex<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> complex<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//对象当做函数来调用</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_4-6-9不要重载" tabindex="-1"><a class="header-anchor" href="#_4-6-9不要重载" aria-hidden="true">#</a> 4.6.9不要重载&amp;&amp;，||</h4><p>不能重载operator&amp;&amp; 和 operator|| 的原因是，无法在这两种情况下实现内置操作符的完整语义。说得更具体一些，内置版本版本特殊之处在于：内置版本的&amp;&amp;和||首先计算左边的表达式，如果这完全能够决定结果，就无需计算右边的表达式了--而且能够保证不需要。我们都已经习惯这种方便的特性了。</p><p>我们说操作符重载其实是另一种形式的函数调用而已，对于函数调用总是在函数执行之前对所有参数进行求值。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Complex<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Complex</span><span class="token punctuation">(</span><span class="token keyword">int</span> flag<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>flag <span class="token operator">=</span> flag<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	Complex<span class="token operator">&amp;</span> operator<span class="token operator">+=</span><span class="token punctuation">(</span>Complex<span class="token operator">&amp;</span> complex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>flag <span class="token operator">=</span> this<span class="token operator">-&gt;</span>flag <span class="token operator">+</span> complex<span class="token punctuation">.</span>flag<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	bool operator<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>Complex<span class="token operator">&amp;</span> complex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>flag <span class="token operator">&amp;&amp;</span> complex<span class="token punctuation">.</span>flag<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> flag<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Complex <span class="token function">complex1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//flag 0 </span>
	Complex <span class="token function">complex2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//flag 1</span>

	<span class="token comment">//原来情况，应该从左往右运算，左边为假，则退出运算，结果为假</span>
	<span class="token comment">//这边却是，先运算（complex1+complex2），导致，complex1的flag变为complex1+complex2的值， complex1.a = 1</span>
	<span class="token comment">// 1 &amp;&amp; 1</span>
	<span class="token comment">//complex1.operator&amp;&amp;(complex1.operator+=(complex2))</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>complex1 <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>complex1 <span class="token operator">+=</span> complex2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;真!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;假!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>根据内置&amp;&amp;的执行顺序，我们发现这个案例中执行顺序并不是从左向右，而是先右后左，这就是不满足我们习惯的特性了。由complex1 **+= ** complex2先执行，导致complex1 本身发生了变化，初始值是0，现在经过+=运算变成1,1 &amp;&amp; 1输出了真。</p><h4 id="_4-6-10-符号重载总结" tabindex="-1"><a class="header-anchor" href="#_4-6-10-符号重载总结" aria-hidden="true">#</a> 4.6.10 符号重载总结</h4><ul><li><p><strong>=</strong>, <strong>[]</strong>, <strong>()</strong> 和 <strong>-&gt;</strong> 操作符只能通过成员函数进行重载</p></li><li><p><strong>&lt;&lt;</strong> 和 **&gt;&gt;**只能通过全局函数配合友元函数进行重载</p></li><li><p>不要重载 <strong>&amp;&amp;</strong> 和 <strong>||</strong> 操作符，因为无法实现短路规则</p></li></ul><p>常规建议</p><table><thead><tr><th>运算符</th><th>建议使用</th></tr></thead><tbody><tr><td>所有的一元运算符</td><td>成员</td></tr><tr><td>= () [] -&gt; -&gt;*</td><td>必须是成员</td></tr><tr><td>+= -= /= *= ^= &amp;= != %= &gt;&gt;= &lt;&lt;=</td><td>成员</td></tr><tr><td>其他的二元运算符</td><td>非成员</td></tr></tbody></table><h4 id="_4-6-10-强化训练-字符串类封装" tabindex="-1"><a class="header-anchor" href="#_4-6-10-强化训练-字符串类封装" aria-hidden="true">#</a> 4.6.10 强化训练_字符串类封装</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//MyString.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
using namespace std<span class="token punctuation">;</span>

class MyString
<span class="token punctuation">{</span>
	friend ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>ostream  <span class="token operator">&amp;</span> out<span class="token punctuation">,</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	friend istream<span class="token operator">&amp;</span> operator<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

public<span class="token operator">:</span>
	<span class="token function">MyString</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MyString</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">MyString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">char</span><span class="token operator">&amp;</span> operator<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[]重载</span>

	<span class="token comment">//=号重载</span>
	MyString<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	MyString<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> 

	<span class="token comment">//字符串拼接 重载+号</span>
	MyString operator<span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str <span class="token punctuation">)</span><span class="token punctuation">;</span>
	MyString operator<span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//字符串比较</span>
	bool operator<span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	bool operator<span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token operator">:</span>
	<span class="token keyword">char</span> <span class="token operator">*</span> pString<span class="token punctuation">;</span> <span class="token comment">//指向堆区空间</span>
	<span class="token keyword">int</span> m_Size<span class="token punctuation">;</span> <span class="token comment">//字符串长度 不算&#39;\0&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//MyString.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;MyString.h&quot;</span></span>

<span class="token comment">//左移运算符</span>
ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span> out<span class="token punctuation">,</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	out <span class="token operator">&lt;&lt;</span> str<span class="token punctuation">.</span>pString<span class="token punctuation">;</span>
	<span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//右移运算符</span>
istream<span class="token operator">&amp;</span> operator<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//先将原有的数据释放</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>pString <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		delete<span class="token punctuation">[</span><span class="token punctuation">]</span> str<span class="token punctuation">.</span>pString<span class="token punctuation">;</span>
		str<span class="token punctuation">.</span>pString <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//开辟临时的字符数组，保存用户输入内容</span>
	in <span class="token operator">&gt;&gt;</span> buf<span class="token punctuation">;</span>

	str<span class="token punctuation">.</span>pString <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>pString<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	str<span class="token punctuation">.</span>m_Size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//构造函数</span>
MyString<span class="token operator">::</span><span class="token function">MyString</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//拷贝构造</span>
MyString<span class="token operator">::</span><span class="token function">MyString</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>pString<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">,</span> str<span class="token punctuation">.</span>pString<span class="token punctuation">)</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> str<span class="token punctuation">.</span>m_Size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//析构函数</span>
MyString<span class="token operator">::</span><span class="token operator">~</span><span class="token function">MyString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		delete<span class="token punctuation">[</span><span class="token punctuation">]</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">char</span><span class="token operator">&amp;</span> MyString<span class="token operator">::</span>operator<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>pString<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

MyString<span class="token operator">&amp;</span> MyString<span class="token operator">::</span>operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		delete<span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pString<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

MyString<span class="token operator">&amp;</span> MyString<span class="token operator">::</span>operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		delete<span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pString<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	this<span class="token operator">-&gt;</span>pString <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>pString<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">,</span> str<span class="token punctuation">.</span>pString<span class="token punctuation">)</span><span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> str<span class="token punctuation">.</span>m_Size<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
MyString MyString<span class="token operator">::</span>operator<span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> newsize <span class="token operator">=</span> this<span class="token operator">-&gt;</span>m_Size <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>temp <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>newsize<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> newsize<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">strcat</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> this<span class="token operator">-&gt;</span>pString<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">strcat</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

	MyString <span class="token function">newstring</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	delete<span class="token punctuation">[</span><span class="token punctuation">]</span> temp<span class="token punctuation">;</span>

	<span class="token keyword">return</span> newstring<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

MyString MyString<span class="token operator">::</span>operator<span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> newsize <span class="token operator">=</span> this<span class="token operator">-&gt;</span>m_Size <span class="token operator">+</span> str<span class="token punctuation">.</span>m_Size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>temp <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>newsize<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> newsize<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">strcat</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> this<span class="token operator">-&gt;</span>pString<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">strcat</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> str<span class="token punctuation">.</span>pString<span class="token punctuation">)</span><span class="token punctuation">;</span>

	MyString <span class="token function">newstring</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	delete<span class="token punctuation">[</span><span class="token punctuation">]</span> temp<span class="token punctuation">;</span>
	<span class="token keyword">return</span> newstring<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool MyString<span class="token operator">::</span>operator<span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">==</span> this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool MyString<span class="token operator">::</span>operator<span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyString<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pString<span class="token punctuation">,</span> str<span class="token punctuation">.</span>pString<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span>m_Size <span class="token operator">==</span> this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> true<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//TestMyString.cpp</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	MyString <span class="token function">str</span><span class="token punctuation">(</span><span class="token string">&quot;hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//cout &lt;&lt; &quot;请输入MyString类型字符串：&quot; &lt;&lt; endl;</span>
	<span class="token comment">//cin &gt;&gt; str;</span>

	<span class="token comment">//cout &lt;&lt; &quot;字符串为： &quot; &lt;&lt; str &lt;&lt; endl;</span>

	<span class="token comment">//测试[]</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyString的第一个字符为：&quot;</span> <span class="token operator">&lt;&lt;</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//测试 =</span>
	MyString str2 <span class="token operator">=</span> <span class="token string">&quot;^_^&quot;</span><span class="token punctuation">;</span>
	MyString str3 <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
	str3 <span class="token operator">=</span> <span class="token string">&quot;aaaa&quot;</span><span class="token punctuation">;</span>
	str3 <span class="token operator">=</span> str2<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;str2 = &quot;</span> <span class="token operator">&lt;&lt;</span> str2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;str3 = &quot;</span> <span class="token operator">&lt;&lt;</span> str3 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//测试 +</span>
	MyString str4 <span class="token operator">=</span> <span class="token string">&quot;我爱&quot;</span><span class="token punctuation">;</span>
	MyString str5 <span class="token operator">=</span> <span class="token string">&quot;北京&quot;</span><span class="token punctuation">;</span>
	MyString str6 <span class="token operator">=</span> str4 <span class="token operator">+</span> str5<span class="token punctuation">;</span>
	MyString str7 <span class="token operator">=</span> str6 <span class="token operator">+</span> <span class="token string">&quot;天安门&quot;</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> str7 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//测试 == </span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>str6 <span class="token operator">==</span> str7<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;s6 与 s7相等&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;s6 与 s7不相等&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h4 id="_4-6-11-附录-运算符和结合性" tabindex="-1"><a class="header-anchor" href="#_4-6-11-附录-运算符和结合性" aria-hidden="true">#</a> 4.6.11 附录：运算符和结合性</h4><table><thead><tr><th><strong>优先级</strong></th><th><strong>运算符</strong></th><th><strong>名称或含义</strong></th><th><strong>使用形式</strong></th><th><strong>结合方向</strong></th><th><strong>说明</strong></th><th></th></tr></thead><tbody><tr><td><strong>1</strong></td><td><strong>[]</strong></td><td>数组下标</td><td>数组名[常量表达式]</td><td>左到右</td><td>--</td><td></td></tr><tr><td><strong>()</strong></td><td>圆括号</td><td>(表达式）/函数名(形参表)</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>.</strong></td><td>成员选择（对象）</td><td>对象.成员名</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>-&gt;</strong></td><td>成员选择（指针）</td><td>对象指针-&gt;成员名</td><td>--</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>2</strong></td><td><strong>-</strong></td><td>负号运算符</td><td>-表达式</td><td>右到左</td><td>单目运算符</td><td></td></tr><tr><td><strong>~</strong></td><td>按位取反运算符</td><td>~表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>++</strong></td><td>自增运算符</td><td>++变量名/变量名++</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>--</strong></td><td>自减运算符</td><td>--变量名/变量名--</td><td></td><td></td><td></td><td></td></tr><tr><td>*****</td><td>取值运算符</td><td>*指针变量</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>&amp;</strong></td><td>取地址运算符</td><td>&amp;变量名</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>!</strong></td><td>逻辑非运算符</td><td>!表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>(类型)</strong></td><td>强制类型转换</td><td>(数据类型)表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>sizeof</strong></td><td>长度运算符</td><td>sizeof(表达式)</td><td>--</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>3</strong></td><td><strong>/</strong></td><td>除</td><td>表达式/表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td>*****</td><td>乘</td><td>表达式*表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>%</strong></td><td>余数（取模）</td><td>整型表达式%整型表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>4</strong></td><td><strong>+</strong></td><td>加</td><td>表达式+表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>-</strong></td><td>减</td><td>表达式-表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>5</strong></td><td><strong>&lt;&lt;</strong></td><td>左移</td><td>变量&lt;&lt;表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>&gt;&gt;</strong></td><td>右移</td><td>变量&gt;&gt;表达式</td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>6</strong></td><td><strong>&gt;</strong></td><td>大于</td><td>表达式&gt;表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>&gt;=</strong></td><td>大于等于</td><td>表达式&gt;=表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>&lt;</strong></td><td>小于</td><td>表达式&lt;表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>&lt;=</strong></td><td>小于等于</td><td>表达式&lt;=表达式</td><td></td><td></td><td></td><td></td></tr><tr><td><strong>7</strong></td><td><strong>==</strong></td><td>等于</td><td>表达式==表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>！=</strong></td><td>不等于</td><td>表达式!= 表达式</td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>8</strong></td><td><strong>&amp;</strong></td><td>按位与</td><td>表达式&amp;表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>9</strong></td><td><strong>^</strong></td><td>按位异或</td><td>表达式^表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>10</strong></td><td><strong>|</strong></td><td>按位或</td><td>表达式|表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>11</strong></td><td><strong>&amp;&amp;</strong></td><td>逻辑与</td><td>表达式&amp;&amp;表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td><strong>12</strong></td><td><strong>||</strong></td><td>逻辑或</td><td>表达式||表达式</td><td>左到右</td><td>双目运算符</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>13</strong></td><td><strong>?:</strong></td><td>条件运算符</td><td>表达式1?表达式2: 表达式3</td><td>右到左</td><td>三目运算符</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>14</strong></td><td><strong>=</strong></td><td>赋值运算符</td><td>变量=表达式</td><td>右到左</td><td>--</td><td></td></tr><tr><td><strong>/=</strong></td><td>除后赋值</td><td>变量/=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td>*<strong>=</strong></td><td>乘后赋值</td><td>变量*=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>%=</strong></td><td>取模后赋值</td><td>变量%=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>+=</strong></td><td>加后赋值</td><td>变量+=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>-=</strong></td><td>减后赋值</td><td>变量-=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>&lt;&lt;=</strong></td><td>左移后赋值</td><td>变量&lt;&lt;=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>&gt;&gt;=</strong></td><td>右移后赋值</td><td>变量&gt;&gt;=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>&amp;=</strong></td><td>按位与后赋值</td><td>变量&amp;=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>^=</strong></td><td>按位异或后赋值</td><td>变量^=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td><strong>|=</strong></td><td>按位或后赋值</td><td>变量|=表达式</td><td>--</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>15</strong></td><td><strong>，</strong></td><td>逗号运算符</td><td>表达式,表达式,…</td><td>左到右</td><td>--</td><td></td></tr></tbody></table><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/by-jj/assets/app.f5f78651.js" defer></script>
  </body>
</html>
