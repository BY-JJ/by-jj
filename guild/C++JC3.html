<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.36">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="h.ico"><title>LH的学习笔记</title><meta name="description" content="描述：学习笔记">
    <link rel="modulepreload" href="/by-jj/assets/app.f5f78651.js"><link rel="modulepreload" href="/by-jj/assets/C__JC3.html.280ce927.js"><link rel="modulepreload" href="/by-jj/assets/C__JC3.html.0166eeb6.js"><link rel="modulepreload" href="/by-jj/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/by-jj/assets/style.686345b1.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/by-jj/" class=""><img class="logo" src="/by-jj/laoshi.png" alt="LH的学习笔记"><span class="site-name can-hide">LH的学习笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/by-jj/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/by-jj/guild/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="汇编"><span class="title">汇编</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="汇编"><span class="title">汇编</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="计算机硬件基础"><!--[--><!--]--> 计算机硬件基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="汇编基础"><!--[--><!--]--> 汇编基础 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C语言"><span class="title">C语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C语言"><span class="title">C语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C/" class="" aria-label="C语法基础"><!--[--><!--]--> C语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG/" class="" aria-label="数据结构基础一"><!--[--><!--]--> 数据结构基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG2/" class="" aria-label="数据结构基础二"><!--[--><!--]--> 数据结构基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CTG/" class="" aria-label="C提高"><!--[--><!--]--> C提高 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CSL/" class="" aria-label="C实例"><!--[--><!--]--> C实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C++"><span class="title">C++</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C++"><span class="title">C++</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC1/" class="" aria-label="C++基础一"><!--[--><!--]--> C++基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC2/" class="" aria-label="C++基础二"><!--[--><!--]--> C++基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC3/" class="" aria-label="C++基础三"><!--[--><!--]--> C++基础三 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++KF/" class="" aria-label="C++开发"><!--[--><!--]--> C++开发 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="C#语法基础"><!--[--><!--]--> C#语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="坦克大战"><!--[--><!--]--> 坦克大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="飞机大战"><!--[--><!--]--> 飞机大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="噩梦射手"><!--[--><!--]--> 噩梦射手 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Qt"><span class="title">Qt</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Qt"><span class="title">Qt</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtBJ/" class="" aria-label="Qt笔记"><!--[--><!--]--> Qt笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtCoin/" class="" aria-label="Qt翻金币小游戏"><!--[--><!--]--> Qt翻金币小游戏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6/" class="" aria-label="Qt6基础"><!--[--><!--]--> Qt6基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qml/" class="" aria-label="Qml基础"><!--[--><!--]--> Qml基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpencv/" class="" aria-label="Qtopencv"><!--[--><!--]--> Qtopencv <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpenGL/" class="" aria-label="QtopenGL"><!--[--><!--]--> QtopenGL <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/3D/" class="" aria-label="Qtquick3D基础"><!--[--><!--]--> Qtquick3D基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6KFJC/" class="" aria-label="Qt6跨平台开发基础"><!--[--><!--]--> Qt6跨平台开发基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6SL/" class="" aria-label="Qt6实例"><!--[--><!--]--> Qt6实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Go"><span class="title">Go</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Go"><span class="title">Go</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoYFJC/" class="" aria-label="Go语法基础"><!--[--><!--]--> Go语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoGJYF/" class="" aria-label="Go高级语法"><!--[--><!--]--> Go高级语法 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK1/" class="" aria-label="数据库一"><!--[--><!--]--> 数据库一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK2/" class="" aria-label="数据库二"><!--[--><!--]--> 数据库二 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/by-jj/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/by-jj/guild/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="汇编"><span class="title">汇编</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="汇编"><span class="title">汇编</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="计算机硬件基础"><!--[--><!--]--> 计算机硬件基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/HB/" class="" aria-label="汇编基础"><!--[--><!--]--> 汇编基础 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C语言"><span class="title">C语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C语言"><span class="title">C语言</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C/" class="" aria-label="C语法基础"><!--[--><!--]--> C语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG/" class="" aria-label="数据结构基础一"><!--[--><!--]--> 数据结构基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJJG2/" class="" aria-label="数据结构基础二"><!--[--><!--]--> 数据结构基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CTG/" class="" aria-label="C提高"><!--[--><!--]--> C提高 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/CSL/" class="" aria-label="C实例"><!--[--><!--]--> C实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="C++"><span class="title">C++</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="C++"><span class="title">C++</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC1/" class="" aria-label="C++基础一"><!--[--><!--]--> C++基础一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC2/" class="" aria-label="C++基础二"><!--[--><!--]--> C++基础二 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++JC3/" class="" aria-label="C++基础三"><!--[--><!--]--> C++基础三 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/C++KF/" class="" aria-label="C++开发"><!--[--><!--]--> C++开发 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Unity3D"><span class="title">Unity3D</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="C#语法基础"><!--[--><!--]--> C#语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="坦克大战"><!--[--><!--]--> 坦克大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="飞机大战"><!--[--><!--]--> 飞机大战 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="噩梦射手"><!--[--><!--]--> 噩梦射手 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Qt"><span class="title">Qt</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Qt"><span class="title">Qt</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtBJ/" class="" aria-label="Qt笔记"><!--[--><!--]--> Qt笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtCoin/" class="" aria-label="Qt翻金币小游戏"><!--[--><!--]--> Qt翻金币小游戏 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6/" class="" aria-label="Qt6基础"><!--[--><!--]--> Qt6基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qml/" class="" aria-label="Qml基础"><!--[--><!--]--> Qml基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpencv/" class="" aria-label="Qtopencv"><!--[--><!--]--> Qtopencv <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/QtOpenGL/" class="" aria-label="QtopenGL"><!--[--><!--]--> QtopenGL <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/3D/" class="" aria-label="Qtquick3D基础"><!--[--><!--]--> Qtquick3D基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6KFJC/" class="" aria-label="Qt6跨平台开发基础"><!--[--><!--]--> Qt6跨平台开发基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/Qt6SL/" class="" aria-label="Qt6实例"><!--[--><!--]--> Qt6实例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Go"><span class="title">Go</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Go"><span class="title">Go</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoYFJC/" class="" aria-label="Go语法基础"><!--[--><!--]--> Go语法基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/GoGJYF/" class="" aria-label="Go高级语法"><!--[--><!--]--> Go高级语法 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Linux编程"><span class="title">Linux编程</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK1/" class="" aria-label="数据库一"><!--[--><!--]--> 数据库一 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/by-jj/guild/SJK2/" class="" aria-label="数据库二"><!--[--><!--]--> 数据库二 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机网络"><span class="title">计算机网络</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="网络攻防"><span class="title">网络攻防</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="web渗透"><span class="title">web渗透</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="第三方库与框架"><span class="title">第三方库与框架</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/by-jj/guide/ts/" class="" aria-label="笔记"><!--[--><!--]--> 笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://www.baidu.com/" rel="noopener noreferrer" target="_blank" aria-label="其它链接"><!--[--><!--]--> 其它链接 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC3.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label><!--[--><!--]-->  <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_4-7-继承和派生" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.7 继承和派生"><!--[--><!--]--> 4.7 继承和派生 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_4-8多态" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.8多态"><!--[--><!--]--> 4.8多态 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-c-模板" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.c++模板"><!--[--><!--]--> 5.c++模板 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-1-模板概论" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.1 模板概论"><!--[--><!--]--> 5.1 模板概论 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-2-函数模板" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.2 函数模板"><!--[--><!--]--> 5.2 函数模板 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-3函数模板和普通函数区别" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.3函数模板和普通函数区别"><!--[--><!--]--> 5.3函数模板和普通函数区别 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-4-函数模板和普通函数在一起调用规则" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.4 函数模板和普通函数在一起调用规则"><!--[--><!--]--> 5.4 函数模板和普通函数在一起调用规则 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-5-模板机制剖析" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.5 模板机制剖析"><!--[--><!--]--> 5.5 模板机制剖析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-6-模板的局限性" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.6 模板的局限性"><!--[--><!--]--> 5.6 模板的局限性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-7-类模板" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.7 类模板"><!--[--><!--]--> 5.7 类模板 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_5-8-类模板的应用" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.8 类模板的应用"><!--[--><!--]--> 5.8 类模板的应用 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_6-c-类型转换" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.c++类型转换"><!--[--><!--]--> 6.c++类型转换 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_6-1-静态转换-static-cast" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.1 静态转换（static_cast）"><!--[--><!--]--> 6.1 静态转换（static_cast） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_6-2-动态转换-dynamic-cast" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.2 动态转换（dynamic_cast）"><!--[--><!--]--> 6.2 动态转换（dynamic_cast） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_6-3-常量转换-const-cast" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3 常量转换（const_cast）"><!--[--><!--]--> 6.3 常量转换（const_cast） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_6-4-重新解释转换-reinterpret-cast" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4 重新解释转换(reinterpret_cast)"><!--[--><!--]--> 6.4 重新解释转换(reinterpret_cast) <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_7-c-异常" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.c++异常"><!--[--><!--]--> 7.c++异常 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_7-1-异常基本概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1 异常基本概念"><!--[--><!--]--> 7.1 异常基本概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_7-2-异常语法" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2 异常语法"><!--[--><!--]--> 7.2 异常语法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_7-3-c-标准库异常" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3 c++标准库异常"><!--[--><!--]--> 7.3 c++标准库异常 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_8-c-输入和输出流" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.c++输入和输出流"><!--[--><!--]--> 8.c++输入和输出流 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_8-1-流的概念和流类库的结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.1 流的概念和流类库的结构"><!--[--><!--]--> 8.1 流的概念和流类库的结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_8-2-标准输入流" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.2 标准输入流"><!--[--><!--]--> 8.2 标准输入流 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_8-3-标准输出流" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.3 标准输出流"><!--[--><!--]--> 8.3 标准输出流 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/by-jj/guild/C++JC3.html#_8-4-文件读写" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.4 文件读写"><!--[--><!--]--> 8.4 文件读写 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h3 id="_4-7-继承和派生" tabindex="-1"><a class="header-anchor" href="#_4-7-继承和派生" aria-hidden="true">#</a> 4.7 继承和派生</h3><h4 id="_4-7-1-继承概述" tabindex="-1"><a class="header-anchor" href="#_4-7-1-继承概述" aria-hidden="true">#</a> 4.7.1 继承概述</h4><h5 id="_4-7-1-1-为什么需要继承" tabindex="-1"><a class="header-anchor" href="#_4-7-1-1-为什么需要继承" aria-hidden="true">#</a> 4.7.1.1 为什么需要继承</h5><p><img src="/by-jj/C++/wps4D78.tmp.jpg" alt="wps4D78.tmp.jpg"></p><p><img src="/by-jj/C++/wps8830.tmp.jpg" alt="wps8830.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//网页类</span>
class IndexPage<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//网页头部</span>
	<span class="token keyword">void</span> <span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;网页头部!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//网页左侧菜单</span>
	<span class="token keyword">void</span> <span class="token function">LeftNavigation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;左侧导航菜单!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//网页主体部分</span>
	<span class="token keyword">void</span> <span class="token function">MainBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;首页网页主题内容!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//网页底部</span>
	<span class="token keyword">void</span> <span class="token function">Footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;网页底部!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	string mTitle<span class="token punctuation">;</span> <span class="token comment">//网页标题</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
<span class="token comment">//如果不使用继承，那么定义新闻页类，需要重新写一遍已经有的代码</span>
class NewsPage<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//网页头部</span>
	<span class="token keyword">void</span> <span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;网页头部!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//网页左侧菜单</span>
	<span class="token keyword">void</span> <span class="token function">LeftNavigation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;左侧导航菜单!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//网页主体部分</span>
	<span class="token keyword">void</span> <span class="token function">MainBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;新闻网页主体内容!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//网页底部</span>
	<span class="token keyword">void</span> <span class="token function">Footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;网页底部!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	string mTitle<span class="token punctuation">;</span> <span class="token comment">//网页标题</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	NewsPage<span class="token operator">*</span> newspage <span class="token operator">=</span> new NewsPage<span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">MainBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">LeftNavigation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">Footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
<span class="token comment">//使用继承，可以复用已有的代码，新闻业除了主体部分不一样，其他都是一样的</span>
class NewsPage <span class="token operator">:</span> public IndexPage<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//网页主体部分</span>
	<span class="token keyword">void</span> <span class="token function">MainBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;新闻网页主主体内容!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	NewsPage<span class="token operator">*</span> newspage <span class="token operator">=</span> new NewsPage<span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">MainBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">LeftNavigation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newspage<span class="token operator">-&gt;</span><span class="token function">Footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br></div></div><h5 id="_4-7-1-2-继承基本概念" tabindex="-1"><a class="header-anchor" href="#_4-7-1-2-继承基本概念" aria-hidden="true">#</a> 4.7.1.2 继承基本概念</h5><p>c++最重要的特征是代码重用，通过继承机制可以利用已有的数据类型来定义新的数据类型，新的类不仅拥有旧类的成员，还拥有新定义的成员。</p><p>一个B类继承于A类，或称从类A派生类B。这样的话，类A成为基类（父类）， 类B成为派生类（子类）。</p><p>派生类中的成员，包含两大部分：</p><ul><li><p>一类是从基类继承过来的，一类是自己增加的成员。</p></li><li><p>从基类继承过过来的表现其共性，而新增的成员体现了其个性。</p></li></ul><p><img src="/by-jj/C++/wpsC1FE.tmp.png" alt="wpsC1FE.tmp.png"></p><h5 id="_4-7-1-3-派生类的定义" tabindex="-1"><a class="header-anchor" href="#_4-7-1-3-派生类的定义" aria-hidden="true">#</a> 4.7.1.3 派生类的定义</h5><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code> Class 派生类名 <span class="token operator">:</span>  继承方式 基类名<span class="token punctuation">{</span>
         <span class="token comment">//派生类新增的数据成员和成员函数</span>
   <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>三种继承方式：</p><ul><li><p>public ： 公有继承</p></li><li><p>private ： 私有继承</p></li><li><p>protected ： 保护继承</p></li></ul><p>从继承源上分：</p><ul><li><p>单继承：指每个派生类只直接继承了一个基类的特征</p></li><li><p>多继承：指多个基类派生出一个派生类的继承关系,多继承的派生类直接继承了不止一个基类的特征</p></li></ul><h4 id="_4-7-2-派生类访问控制" tabindex="-1"><a class="header-anchor" href="#_4-7-2-派生类访问控制" aria-hidden="true">#</a> 4.7.2 派生类访问控制</h4><p>派生类继承基类，派生类拥有基类中全部成员变量和成员方法（除了构造和析构之外的成员方法），但是在派生类中，继承的成员并不一定能直接访问，不同的继承方式会导致不同的访问权限。</p><p>派生类的访问权限规则如下：</p><p><img src="/by-jj/C++/wps561.tmp.jpg" alt="wps561.tmp.jpg"></p><p><img src="/by-jj/C++/wps2CB0.tmp.jpg" alt="wps2CB0.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//基类</span>
class A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
protected<span class="token operator">:</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mC<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//1. 公有(public)继承</span>
class B <span class="token operator">:</span> public A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">PrintB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类public属性</span>
		cout <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类protected属性</span>
		<span class="token comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span>
	<span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class SubB <span class="token operator">:</span> public B<span class="token punctuation">{</span>
	<span class="token keyword">void</span> <span class="token function">PrintSubB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类public属性</span>
		cout <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类protected属性</span>
		<span class="token comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	B b<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> b<span class="token punctuation">.</span>mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类public属性</span>
	<span class="token comment">//cout &lt;&lt; b.mB &lt;&lt; endl; //不可访问基类protected属性</span>
	<span class="token comment">//cout &lt;&lt; b.mC &lt;&lt; endl; //不可访问基类private属性</span>
<span class="token punctuation">}</span>

<span class="token comment">//2. 私有(private)继承</span>
class C <span class="token operator">:</span> private A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">PrintC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类public属性</span>
		cout <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类protected属性</span>
		<span class="token comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class SubC <span class="token operator">:</span> public C<span class="token punctuation">{</span>
	<span class="token keyword">void</span> <span class="token function">PrintSubC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//cout &lt;&lt; mA &lt;&lt; endl; //不可访问基类public属性</span>
		<span class="token comment">//cout &lt;&lt; mB &lt;&lt; endl; //不可访问基类protected属性</span>
		<span class="token comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	C c<span class="token punctuation">;</span>
	<span class="token comment">//cout &lt;&lt; c.mA &lt;&lt; endl; //不可访问基类public属性</span>
	<span class="token comment">//cout &lt;&lt; c.mB &lt;&lt; endl; //不可访问基类protected属性</span>
	<span class="token comment">//cout &lt;&lt; c.mC &lt;&lt; endl; //不可访问基类private属性</span>
<span class="token punctuation">}</span>
<span class="token comment">//3. 保护(protected)继承</span>
class D <span class="token operator">:</span> protected A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">PrintD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类public属性</span>
		cout <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类protected属性</span>
		<span class="token comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class SubD <span class="token operator">:</span> public D<span class="token punctuation">{</span>
	<span class="token keyword">void</span> <span class="token function">PrintD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mA <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类public属性</span>
		cout <span class="token operator">&lt;&lt;</span> mB <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//可访问基类protected属性</span>
		<span class="token comment">//cout &lt;&lt; mC &lt;&lt; endl; //不可访问基类private属性</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	D d<span class="token punctuation">;</span>
	<span class="token comment">//cout &lt;&lt; d.mA &lt;&lt; endl; //不可访问基类public属性</span>
	<span class="token comment">//cout &lt;&lt; d.mB &lt;&lt; endl; //不可访问基类protected属性</span>
	<span class="token comment">//cout &lt;&lt; d.mC &lt;&lt; endl; //不可访问基类private属性</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h4 id="_4-7-3-继承中的构造和析构" tabindex="-1"><a class="header-anchor" href="#_4-7-3-继承中的构造和析构" aria-hidden="true">#</a> 4.7.3 继承中的构造和析构</h4><h5 id="_4-7-3-1-继承中的对象模型" tabindex="-1"><a class="header-anchor" href="#_4-7-3-1-继承中的对象模型" aria-hidden="true">#</a> 4.7.3.1 继承中的对象模型</h5><p>在C++编译器的内部可以理解为结构体，子类是由父类成员叠加子类新成员而成：</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Aclass<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Bclass <span class="token operator">:</span> public Aclass<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mC<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Cclass <span class="token operator">:</span> public Bclass<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mD<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Aclass<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;B size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Bclass<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Cclass<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h5 id="_4-7-3-2-对象构造和析构的调用原则" tabindex="-1"><a class="header-anchor" href="#_4-7-3-2-对象构造和析构的调用原则" aria-hidden="true">#</a> 4.7.3.2 对象构造和析构的调用原则</h5><p><strong>继承中的构造和析构</strong></p><ul><li><p>子类对象在创建时会首先调用父类的构造函数</p></li><li><p>父类构造函数执行完毕后，才会调用子类的构造函数</p></li><li><p>当父类构造函数有参数时，需要在子类初始化列表(参数列表)中显示调用父类构造函数</p></li><li><p>析构函数调用顺序和构造函数相反</p></li></ul><p><img src="/by-jj/C++/wps6CB8.tmp.jpg" alt="wps6CB8.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class B <span class="token operator">:</span> public A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;B类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;B类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class C <span class="token operator">:</span> public B<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	C c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><strong>继承与组合混搭的构造和析构</strong></p><p><img src="/by-jj/C++/wpsA57C.tmp.jpg" alt="wpsA57C.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class D<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;D类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;D类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class B <span class="token operator">:</span> public A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;B类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;B类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class C <span class="token operator">:</span> public B<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C类构造函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C类析构函数!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	D c<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	C c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h4 id="_4-7-3-继承中同名成员的处理方法" tabindex="-1"><a class="header-anchor" href="#_4-7-3-继承中同名成员的处理方法" aria-hidden="true">#</a> 4.7.3 继承中同名成员的处理方法</h4><ul><li><p>当子类成员和父类成员同名时，子类依然从父类继承同名成员</p></li><li><p>如果子类有成员和父类同名，子类访问其成员默认访问子类的成员(本作用域，就近原则)</p></li><li><p>在子类通过作用域::进行同名成员区分(在派生类中使用基类的同名成员，显示使用类名限定符)</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">mParam</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Derived <span class="token operator">:</span> public Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">mParam</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//在派生类中使用和基类的同名成员,显示使用类名限定符</span>
		cout <span class="token operator">&lt;&lt;</span> Base<span class="token operator">::</span>mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//返回基类重名成员</span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">getBaseParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span>  Base<span class="token operator">::</span>mParam<span class="token punctuation">;</span> <span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Derived derived<span class="token punctuation">;</span>
	<span class="token comment">//派生类和基类成员属性重名，子类访问成员默认是子类成员</span>
	cout <span class="token operator">&lt;&lt;</span> derived<span class="token punctuation">.</span>mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//10</span>
	derived<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//类外如何获得基类重名成员属性</span>
	derived<span class="token punctuation">.</span><span class="token function">getBaseParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base:mParam:&quot;</span> <span class="token operator">&lt;&lt;</span> derived<span class="token punctuation">.</span><span class="token function">getBaseParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><strong>注意: 如果重新定义了基类中的重载函数，将会发生什么？</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base::void func1()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base::void func1(int param)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base::void myfunc()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Derived1 <span class="token operator">:</span> public Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Derived1::void myfunc()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Derived2 <span class="token operator">:</span> public Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//改变成员函数的参数列表</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> param1<span class="token punctuation">,</span> <span class="token keyword">int</span> param2<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Derived2::void func1(int param1,int param2)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Derived3 <span class="token operator">:</span> public Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//改变成员函数的返回值</span>
	<span class="token keyword">int</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Derived3::int func1(int param)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Derived1 derived1<span class="token punctuation">;</span>
	derived1<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	derived1<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	derived1<span class="token punctuation">.</span><span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Derived2 derived2<span class="token punctuation">;</span>
	<span class="token comment">//derived2.func1();  //func1被隐藏</span>
	<span class="token comment">//derived2.func1(20); //func2被隐藏</span>
	derived2<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//重载func1之后，基类的函数被隐藏</span>
	derived2<span class="token punctuation">.</span><span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Derived3 derived3<span class="token punctuation">;</span>
	<span class="token comment">//derived3.func1();  没有重新定义的重载版本被隐藏</span>
	derived3<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	derived3<span class="token punctuation">.</span><span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><ul><li><p>Derive1 重定义了Base类的myfunc函数，derive1可访问func1及其重载版本的函数。</p></li><li><p>Derive2通过改变函数参数列表的方式重新定义了基类的func1函数，则从基类中继承来的其他重载版本被隐藏，不可访问</p></li><li><p>Derive3通过改变函数返回类型的方式重新定义了基类的func1函数，则从基类继承来的没有重新定义的重载版本的函数将被隐藏。</p></li></ul><p><strong>任何时候重新定义基类中的一个重载函数，在新类中所有的其他版本将被自动隐藏.</strong></p><h4 id="_4-7-4-非自动继承的函数" tabindex="-1"><a class="header-anchor" href="#_4-7-4-非自动继承的函数" aria-hidden="true">#</a> 4.7.4 非自动继承的函数</h4><p>不是所有的函数都能自动从基类继承到派生类中。构造函数和析构函数用来处理对象的创建和析构操作，构造和析构函数只知道对它们的特定层次的对象做什么，也就是说构造函数和析构函数不能被继承，必须为每一个特定的派生类分别创建。</p><p>另外operator=也不能被继承，因为它完成类似构造函数的行为。也就是说尽管我们知道如何由=右边的对象如何初始化=左边的对象的所有成员，但是这个并不意味着对其派生类依然有效。</p><p>在继承的过程中，如果没有创建这些函数，编译器会自动生成它们。</p><h4 id="_4-7-5-继承中的静态成员特性" tabindex="-1"><a class="header-anchor" href="#_4-7-5-继承中的静态成员特性" aria-hidden="true">#</a> 4.7.5 继承中的静态成员特性</h4><p>静态成员函数和非静态成员函数的共同点:</p><ol><li><p>他们都可以被继承到派生类中。</p></li><li><p>如果重新定义一个静态成员函数，所有在基类中的其他重载函数会被隐藏。</p></li><li><p>如果我们改变基类中一个函数的特征，所有使用该函数名的基类版本都会被隐藏。</p></li></ol><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
   <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> sNum<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> param<span class="token punctuation">)</span><span class="token punctuation">{</span>
   	<span class="token keyword">return</span> sNum <span class="token operator">+</span> param<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
public<span class="token operator">:</span>
   <span class="token keyword">static</span> <span class="token keyword">int</span> sNum<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Base<span class="token operator">::</span>sNum <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

class Derived <span class="token operator">:</span> public Base<span class="token punctuation">{</span>
public<span class="token operator">:</span>
   <span class="token keyword">static</span> <span class="token keyword">int</span> sNum<span class="token punctuation">;</span> <span class="token comment">//基类静态成员属性将被隐藏</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
   <span class="token comment">//重定义一个函数，基类中重载的函数被隐藏</span>
   <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> param1<span class="token punctuation">,</span> <span class="token keyword">int</span> param2<span class="token punctuation">)</span><span class="token punctuation">{</span>
   	<span class="token keyword">return</span> sNum <span class="token operator">+</span> param1 <span class="token operator">+</span> param2<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
   <span class="token comment">//改变基类函数的某个特征，返回值或者参数个数，将会隐藏基类重载的函数</span>
   <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> param1<span class="token punctuation">,</span> <span class="token keyword">int</span> param2<span class="token punctuation">)</span><span class="token punctuation">{</span>
   	cout <span class="token operator">&lt;&lt;</span>  sNum <span class="token operator">+</span> param1 <span class="token operator">+</span> param2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Derived<span class="token operator">::</span>sNum <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="_4-7-6-多继承" tabindex="-1"><a class="header-anchor" href="#_4-7-6-多继承" aria-hidden="true">#</a> 4.7.6 多继承</h4><h5 id="_4-7-6-1-多继承概念" tabindex="-1"><a class="header-anchor" href="#_4-7-6-1-多继承概念" aria-hidden="true">#</a> 4.7.6.1 多继承概念</h5><p>我们可以从一个类继承，我们也可以能同时从多个类继承，这就是多继承。但是由于多继承是非常受争议的，从多个类继承可能会导致函数、变量等同名导致较多的歧义。</p><p><img src="/by-jj/C++/wpsEDF0.tmp.jpg" alt="wpsEDF0.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Base1<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base1::func1&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base2<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base2::func1&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base2::func2&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//派生类继承Base1、Base2</span>
class Derived <span class="token operator">:</span> public Base1<span class="token punctuation">,</span> public Base2<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Derived derived<span class="token punctuation">;</span>
	<span class="token comment">//func1是从Base1继承来的还是从Base2继承来的？</span>
	<span class="token comment">//derived.func1(); </span>
	derived<span class="token punctuation">.</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//解决歧义:显示指定调用那个基类的func1</span>
	derived<span class="token punctuation">.</span>Base1<span class="token operator">::</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	derived<span class="token punctuation">.</span>Base2<span class="token operator">::</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>多继承会带来一些二义性的问题， 如果两个基类中有同名的函数或者变量，那么通过派生类对象去访问这个函数或变量时就不能明确到底调用从基类1继承的版本还是从基类2继承的版本？</p><p>解决方法就是显示指定调用那个基类的版本。</p><h5 id="_4-7-6-2-菱形继承和虚继承" tabindex="-1"><a class="header-anchor" href="#_4-7-6-2-菱形继承和虚继承" aria-hidden="true">#</a> 4.7.6.2 菱形继承和虚继承</h5><p>两个派生类继承同一个基类而又有某个类同时继承者两个派生类，这种继承被称为菱形继承，或者钻石型继承。</p><p><img src="/by-jj/C++/wps2666.tmp.png" alt="wps2666.tmp.png"></p><p>这种继承所带来的问题：</p><ol><li><p>羊继承了动物的数据和函数，鸵同样继承了动物的数据和函数，当草泥马调用函数或者数据时，就会产生二义性。</p></li><li><p>草泥马继承自动物的函数和数据继承了两份，其实我们应该清楚，这份数据我们只需要一份就可以。</p></li></ol><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class BigBase<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> mParam <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;BigBase::func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Base1 <span class="token operator">:</span> public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base2 <span class="token operator">:</span> public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Derived <span class="token operator">:</span> public Base1<span class="token punctuation">,</span> public Base2<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Derived derived<span class="token punctuation">;</span>
	<span class="token comment">//1. 对“func”的访问不明确</span>
	<span class="token comment">//derived.func();</span>
	<span class="token comment">//cout &lt;&lt; derived.mParam &lt;&lt; endl;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;derived.Base1::mParam:&quot;</span> <span class="token operator">&lt;&lt;</span> derived<span class="token punctuation">.</span>Base1<span class="token operator">::</span>mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;derived.Base2::mParam:&quot;</span> <span class="token operator">&lt;&lt;</span> derived<span class="token punctuation">.</span>Base2<span class="token operator">::</span>mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//2. 重复继承</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Derived size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Derived<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//8</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>上述问题如何解决？对于调用二义性，那么可通过指定调用那个基类的方式来解决，那么重复继承怎么解决？</p><p>对于这种菱形继承所带来的两个问题，c++为我们提供了一种方式，采用虚基类。那么我们采用虚基类方式将代码修改如下：</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class BigBase<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> mParam <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;BigBase::func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Base1 <span class="token operator">:</span> virtual public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base2 <span class="token operator">:</span> virtual public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Derived <span class="token operator">:</span> public Base1<span class="token punctuation">,</span> public Base2<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Derived derived<span class="token punctuation">;</span>
	<span class="token comment">//二义性问题解决</span>
	derived<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> derived<span class="token punctuation">.</span>mParam <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//输出结果:12</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Derived size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Derived<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>以上程序Base1 ，Base2采用虚继承方式继承BigBase,那么BigBase被称为虚基类。</p><p>通过虚继承解决了菱形继承所带来的二义性问题。</p><p><strong>但是虚基类是如何解决二义性的呢？并且derived大小为12字节，这是怎么回事？</strong></p><h5 id="_4-7-6-3-虚继承实现原理" tabindex="-1"><a class="header-anchor" href="#_4-7-6-3-虚继承实现原理" aria-hidden="true">#</a> 4.7.6.3 虚继承实现原理</h5><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class BigBase<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> mParam <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;BigBase::func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
public<span class="token operator">:</span> <span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span> </span><span class="token comment">//虚继承</span></span>
class Base1 <span class="token operator">:</span> virtual public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base2 <span class="token operator">:</span> virtual public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span> <span class="token comment">//普通继承</span></span>
class Base1 <span class="token operator">:</span>  public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base2 <span class="token operator">:</span>  public BigBase<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
class Derived <span class="token operator">:</span> public Base1<span class="token punctuation">,</span> public Base2<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><table><thead><tr><th></th><th>普通继承</th><th>虚继承</th></tr></thead><tbody><tr><td>BigBase：</td><td><img src="/by-jj/C++/wps7F55.tmp.jpg" alt="wps7F55.tmp.jpg"></td><td><img src="/by-jj/C++/wpsAFCC.tmp.jpg" alt="wpsAFCC.tmp.jpg"></td></tr><tr><td>Base1：</td><td><img src="/by-jj/C++/wpsD93E.tmp.jpg" alt="wpsD93E.tmp.jpg"></td><td><img src="/by-jj/C++/wps4E04.tmp.jpg" alt="wps4E04.tmp.jpg"></td></tr><tr><td>Base2：</td><td><img src="/by-jj/C++/wpsFE7B.tmp.jpg" alt="wpsFE7B.tmp.jpg"></td><td><img src="/by-jj/C++/wps7CF5.tmp.jpg" alt="wps7CF5.tmp.jpg"></td></tr><tr><td>Derived：</td><td><img src="/by-jj/C++/wps24B1.tmp.jpg" alt="wps24B1.tmp.jpg"></td><td><img src="/by-jj/C++/wpsA667.tmp.jpg" alt="wpsA667.tmp.jpg"></td></tr></tbody></table><p>通过内存图，我们发现普通继承和虚继承的对象内存图是不一样的。我们也可以猜测到编译器肯定对我们编写的程序做了一些手脚。</p><ul><li><p>BigBase 菱形最顶层的类，内存布局图没有发生改变。</p></li><li><p>Base1和Base2通过虚继承的方式派生自BigBase,这两个对象的布局图中可以看出编译器为我们的对象中增加了一个vbptr (virtual base pointer),vbptr指向了一张表，这张表保存了当前的虚指针相对于虚基类的首地址的偏移量。</p></li><li><p>Derived派生于Base1和Base2,继承了两个基类的vbptr指针，并调整了vbptr与虚基类的首地址的偏移量。</p></li></ul><p>由此可知编译器帮我们做了一些幕后工作，使得这种菱形问题在继承时候能只继承一份数据，并且也解决了二义性的问题。现在模型就变成了Base1和 Base2 Derived三个类对象共享了一份BigBase数据。</p><p>当使用虚继承时，虚基类是被共享的，也就是在继承体系中无论被继承多少次，对象内存模型中均只会出现一个虚基类的子对象（这和多继承是完全不同的）。即使共享虚基类，但是必须要有一个类来完成基类的初始化（因为所有的对象都必须被初始化，哪怕是默认的），同时还不能够重复进行初始化，那到底谁应该负责完成初始化呢？<strong>C++标准中选择在每一次继承子类中都必须书写初始化语句（因为每一次继承子类可能都会用来定义对象），但是虚基类的初始化是由最后的子类完成，其他的初始化语句都不会调用。</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class BigBase<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span>mParam <span class="token operator">=</span> x<span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;BigBase::func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base1 <span class="token operator">:</span> virtual public BigBase<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Base1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//不调用BigBase构造</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Base2 <span class="token operator">:</span> virtual public BigBase<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Base2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//不调用BigBase构造</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Derived <span class="token operator">:</span> public Base1<span class="token punctuation">,</span> public Base2<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">BigBase</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//调用BigBase构造</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//每一次继承子类中都必须书写初始化语句</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Derived derived<span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>注意：</strong></p><p><strong>虚继承只能解决具备公共祖先的多继承所带来的二义性问题，不能解决没有公共祖先的多继承的.</strong></p><p>工程开发中真正意义上的多继承是几乎不被使用，因为多重继承带来的代码复杂性远多于其带来的便利，多重继承对代码维护性上的影响是灾难性的，在设计方法上，任何多继承都可以用单继承代替。</p><h3 id="_4-8多态" tabindex="-1"><a class="header-anchor" href="#_4-8多态" aria-hidden="true">#</a> 4.8多态</h3><h4 id="_4-8-1-多态的基本概念" tabindex="-1"><a class="header-anchor" href="#_4-8-1-多态的基本概念" aria-hidden="true">#</a> 4.8.1 多态的基本概念</h4><p>多态是面向对象程序设计语言中数据抽象和继承之外的第三个基本特征。</p><p>多态性(polymorphism)提供接口与具体实现之间的另一层隔离，从而将”what”和”how”分离开来。多态性改善了代码的可读性和组织性，同时也使创建的程序具有可扩展性，项目不仅在最初创建时期可以扩展，而且当项目在需要有新的功能时也能扩展。</p><p>c++支持编译时多态(静态多态)和运行时多态(动态多态)，运算符重载和函数重载就是编译时多态，而派生类和虚函数实现运行时多态。</p><p>静态多态和动态多态的区别就是函数地址是早绑定(静态联编)还是晚绑定(动态联编)。如果函数的调用，在编译阶段就可以确定函数的调用地址，并产生代码，就是静态多态(编译时多态)，就是说地址是早绑定的。而如果函数的调用地址不能编译不能在编译期间确定，而需要在运行时才能决定，这这就属于晚绑定(动态多态,运行时多态)。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//计算器</span>
class Caculator<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">setA</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mA <span class="token operator">=</span> a<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">setB</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mB <span class="token operator">=</span> b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">setOperator</span><span class="token punctuation">(</span>string oper<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mOperator <span class="token operator">=</span> oper<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mOperator <span class="token operator">==</span> <span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> mA <span class="token operator">+</span> mB<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mOperator <span class="token operator">==</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> mA <span class="token operator">-</span> mB<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mOperator <span class="token operator">==</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> mA <span class="token operator">*</span> mB<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mOperator <span class="token operator">==</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> mA <span class="token operator">/</span> mB<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
	string mOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//这种程序不利于扩展，维护困难，如果修改功能或者扩展功能需要在源代码基础上修改</span>
<span class="token comment">//面向对象程序设计一个基本原则:开闭原则(对修改关闭，对扩展开放)</span>

<span class="token comment">//抽象基类</span>
class AbstractCaculator<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">setA</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mA <span class="token operator">=</span> a<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	virtual <span class="token keyword">void</span> <span class="token function">setB</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mB <span class="token operator">=</span> b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	virtual <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
protected<span class="token operator">:</span>
	<span class="token keyword">int</span> mA<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
	string mOperator<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//加法计算器</span>
class PlusCaculator <span class="token operator">:</span> public AbstractCaculator<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> mA <span class="token operator">+</span> mB<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//减法计算器</span>
class MinusCaculator <span class="token operator">:</span> public AbstractCaculator<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> mA <span class="token operator">-</span> mB<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//乘法计算器</span>
class MultipliesCaculator <span class="token operator">:</span> public AbstractCaculator<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> mA <span class="token operator">*</span> mB<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">DoBussiness</span><span class="token punctuation">(</span>AbstractCaculator<span class="token operator">*</span> caculator<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	caculator<span class="token operator">-&gt;</span><span class="token function">setA</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	caculator<span class="token operator">-&gt;</span><span class="token function">setB</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;计算结果：&quot;</span> <span class="token operator">&lt;&lt;</span> caculator<span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	delete caculator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br></div></div><h4 id="_4-8-2-向上类型转换及问题" tabindex="-1"><a class="header-anchor" href="#_4-8-2-向上类型转换及问题" aria-hidden="true">#</a> 4.8.2 向上类型转换及问题</h4><h5 id="_4-8-2-1-问题抛出" tabindex="-1"><a class="header-anchor" href="#_4-8-2-1-问题抛出" aria-hidden="true">#</a> 4.8.2.1 问题抛出</h5><p>对象可以作为自己的类或者作为它的基类的对象来使用。还能通过基类的地址来操作它。取一个对象的地址(指针或引用)，并将其作为基类的地址来处理，这种称为向上类型转换。</p><p>也就是说：父类引用或指针可以指向子类对象，通过父类指针或引用来操作子类对象。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Animal<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;动物在唱歌...&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Dog <span class="token operator">:</span> public Animal<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;小狗在唱歌...&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">DoBussiness</span><span class="token punctuation">(</span>Animal<span class="token operator">&amp;</span> animal<span class="token punctuation">)</span><span class="token punctuation">{</span>
	animal<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Dog dog<span class="token punctuation">;</span>
	<span class="token function">DoBussiness</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>运行结果</strong>: 动物在唱歌</p><p><strong>问题抛出:</strong> 我们给DoBussiness传入的对象是dog，而不是animal对象，输出的结果应该是Dog::speak。</p><h5 id="_4-8-2-1-问题解决思路" tabindex="-1"><a class="header-anchor" href="#_4-8-2-1-问题解决思路" aria-hidden="true">#</a> 4.8.2.1 问题解决思路</h5><p>解决这个问题，我们需要了解下绑定(捆绑,binding)概念。</p><p>把函数体与函数调用相联系称为绑定(捆绑，binding)</p><p>当绑定在程序运行之前(由编译器和连接器)完成时，称为早绑定(early binding).C语言中只有一种函数调用方式，就是早绑定。</p><p>上面的问题就是由于早绑定引起的，因为编译器在只有Animal地址时并不知道要调用的正确函数。编译<strong>是根据指向对象的指针或引用的类型</strong>来选择函数调用。这个时候由于DoBussiness的参数类型是Animal&amp;,编译器确定了应该调用的speak是Animal::speak的，而不是真正传入的对象Dog::speak。</p><p>解决方法就是迟绑定(迟捆绑,动态绑定,运行时绑定，late binding),意味着绑定要根据对象的实际类型，发生在运行。</p><p>C++语言要实现这种动态绑定，必须有某种机制来确定运行时对象的类型并调用合适的成员函数。对于一种编译语言，编译器并不知道实际的对象类型（编译器并不知道Animal类型的指针或引用指向的实际的对象类型）。</p><h5 id="_4-8-2-1-问题解决方案-虚函数-vitual-function" tabindex="-1"><a class="header-anchor" href="#_4-8-2-1-问题解决方案-虚函数-vitual-function" aria-hidden="true">#</a> 4.8.2.1 问题解决方案（虚函数，vitual function）</h5><p>C++动态多态性是通过虚函数来实现的，虚函数允许子类（派生类）重新定义父类（基类）成员函数，而子类（派生类）重新定义父类（基类）虚函数的做法称为覆盖(override)，或者称为重写。</p><p>对于特定的函数进行动态绑定，c++要求在基类中声明这个函数的时候使用virtual关键字,动态绑定也就对virtual函数起作用.</p><ul><li><p>为创建一个需要动态绑定的虚成员函数，可以简单在这个函数声明前面加上virtual关键字，定义时候不需要.</p></li><li><p>如果一个函数在基类中被声明为virtual，那么在所有派生类中它都是virtual的.</p></li><li><p>在派生类中virtual函数的重定义称为重写(override).</p></li><li><p>Virtual关键字只能修饰成员函数.</p></li><li><p>构造函数不能为虚函数</p></li></ul><p><strong>注意:</strong> 仅需要在基类中声明一个函数为virtual.调用所有匹配基类声明行为的派生类函数都将使用虚机制。虽然可以在派生类声明前使用关键字virtual(这也是无害的)，但这个样会使得程序显得冗余和杂乱。(我建议写上)</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Animal<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;动物在唱歌...&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Dog <span class="token operator">:</span> public Animal<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;小狗在唱歌...&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoBussiness</span><span class="token punctuation">(</span>Animal<span class="token operator">&amp;</span> animal<span class="token punctuation">)</span><span class="token punctuation">{</span>
	animal<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Dog dog<span class="token punctuation">;</span>
	<span class="token function">DoBussiness</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_4-8-3-c-如何实现动态绑定" tabindex="-1"><a class="header-anchor" href="#_4-8-3-c-如何实现动态绑定" aria-hidden="true">#</a> 4.8.3 c++如何实现动态绑定</h4><p>动态绑定什么时候发生？所有的工作都是由编译器在幕后完成。当我们告诉通过创建一个virtual函数来告诉编译器要进行动态绑定，那么编译器就会根据动态绑定机制来实现我们的要求， 不会再执行早绑定。</p><p>问题:C++的动态捆绑机制是怎么样的？</p><p>首先，我们看看编译器如何处理虚函数。当编译器发现我们的类中有虚函数的时候，编译器会创建一张虚函数表，把虚函数的函数入口地址放到虚函数表中，并且在类中秘密增加一个指针，这个指针就是vpointer(缩写vptr)，这个指针是指向对象的虚函数表。在多态调用的时候，根据vptr指针，找到虚函数表来实现动态绑定。</p><p><strong>验证对象中的虚指针：</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	virtual <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//B类为空，那么大小应该是1字节，实际情况是这样吗？</span>
class B <span class="token operator">:</span> public A<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;A size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;B size:&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在编译阶段，编译器秘密增加了一个vptr指针，但是此时vptr指针并没有初始化指向虚函数表(vtable),什么时候vptr才会指向虚函数表？在对象构建的时候，也就是在对象初始化调用构造函数的时候。编译器首先默认会在我们所编写的每一个构造函数中，增加一些vptr指针初始化的代码。如果没有提供构造函数，编译器会提供默认的构造函数，那么就会在默认构造函数里做此项工作，初始化vptr指针，使之指向本对象的虚函数表。</p><p>起初，子类继承基类，子类继承了基类的vptr指针，这个vptr指针是指向基类虚函数表，当子类调用构造函数，使得子类的vptr指针指向了子类的虚函数表。</p><ul><li>当子类无重写基类虚函数时:</li></ul><p><img src="/by-jj/C++/wps21C2.tmp.png" alt="wps21C2.tmp.png"></p><p><img src="/by-jj/C++/wps83C9.tmp.jpg" alt="wps83C9.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>过程分析<span class="token operator">:</span>
     Animal<span class="token operator">*</span> animal <span class="token operator">=</span> new Dog<span class="token punctuation">;</span>
     animal<span class="token operator">-&gt;</span><span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     当程序执行到这里，会去animal指向的空间中寻找vptr指针，通过vptr指针找到func1函数，此时由于子类并没有重写也就是覆盖基类的func1函数，所以调用func1时，仍然调用的是基类的func1<span class="token punctuation">.</span>
         
执行结果<span class="token operator">:</span> 我是基类的func1
测试结论<span class="token operator">:</span> 无重写基类的虚函数，无意义
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>当子类重写基类虚函数时:</li></ul><p><img src="/by-jj/C++/wpsC2D7.tmp.png" alt="wpsC2D7.tmp.png"></p><p><img src="/by-jj/C++/wpsFBF9.tmp.jpg" alt="wpsFBF9.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>过程分析<span class="token operator">:</span>
     Animal<span class="token operator">*</span> animal <span class="token operator">=</span> new Dog<span class="token punctuation">;</span>
     animal<span class="token operator">-&gt;</span><span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     当程序执行到这里，会去animal指向的空间中寻找vptr指针，通过vptr指针找到func1函数，由于子类重写基类的func1函数，所以调用func1时，调用的是子类的func1<span class="token punctuation">.</span>
         
执行结果<span class="token operator">:</span> 我是子类的func1
测试结论<span class="token operator">:</span> 无重写基类的虚函数，无意义
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>多态的成立条件：</strong></p><ul><li><p>有继承</p></li><li><p>子类重写父类虚函数函数</p><p>a) 返回值，函数名字，函数参数，必须和父类完全一致(析构函数除外)</p><p>b) 子类中virtual关键字可写可不写，建议写</p></li><li><p>类型兼容，父类指针，父类引用 指向 子类对象</p></li></ul><h4 id="_4-8-4-抽象基类和纯虚函数-pure-virtual-function" tabindex="-1"><a class="header-anchor" href="#_4-8-4-抽象基类和纯虚函数-pure-virtual-function" aria-hidden="true">#</a> 4.8.4 抽象基类和纯虚函数（pure virtual function）</h4><p>在设计时，常常希望基类仅仅作为其派生类的一个接口。这就是说，仅想对基类进行向上类型转换，使用它的接口，而不希望用户实际的创建一个基类的对象。同时创建一个纯虚函数允许接口中放置成员原函数，而不一定要提供一段可能对这个函数毫无意义的代码。</p><p>做到这点，可以在基类中加入至少一个纯虚函数(pure virtual function),使得基类称为抽象类(abstract class).</p><ul><li><p>纯虚函数使用关键字virtual，并在其后面加上=0。如果试图去实例化一个抽象类，编译器则会阻止这种操作。</p></li><li><p>当继承一个抽象类的时候，必须实现所有的纯虚函数，否则由抽象类派生的类也是一个抽象类。</p></li><li><p>Virtual void fun() = 0;告诉编译器在vtable中为函数保留一个位置，但在这个特定位置不放地址。</p></li></ul><p><strong>建立公共接口目的</strong>是为了将子类公共的操作抽象出来，可以通过一个公共接口来操纵一组类，且这个公共接口不需要事先(或者不需要完全实现)。可以创建一个公共类.</p><p><strong>案例: 模板方法模式</strong></p><p><img src="/by-jj/C++/wps4A39.tmp.jpg" alt="wps4A39.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//抽象制作饮品</span>
class AbstractDrinking<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//烧水</span>
	virtual <span class="token keyword">void</span> <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//冲泡</span>
	virtual <span class="token keyword">void</span> <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//倒入杯中</span>
	virtual <span class="token keyword">void</span> <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//加入辅料</span>
	virtual <span class="token keyword">void</span> <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//规定流程</span>
	<span class="token keyword">void</span> <span class="token function">MakeDrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//制作咖啡</span>
class Coffee <span class="token operator">:</span> public AbstractDrinking<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//烧水</span>
	virtual <span class="token keyword">void</span> <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;煮农夫山泉!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//冲泡</span>
	virtual <span class="token keyword">void</span> <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;冲泡咖啡!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//倒入杯中</span>
	virtual <span class="token keyword">void</span> <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;将咖啡倒入杯中!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//加入辅料</span>
	virtual <span class="token keyword">void</span> <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;加入牛奶!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//制作茶水</span>
class Tea <span class="token operator">:</span> public AbstractDrinking<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//烧水</span>
	virtual <span class="token keyword">void</span> <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;煮自来水!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//冲泡</span>
	virtual <span class="token keyword">void</span> <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;冲泡茶叶!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//倒入杯中</span>
	virtual <span class="token keyword">void</span> <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;将茶水倒入杯中!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//加入辅料</span>
	virtual <span class="token keyword">void</span> <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;加入食盐!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//业务函数</span>
<span class="token keyword">void</span> <span class="token function">DoBussiness</span><span class="token punctuation">(</span>AbstractDrinking<span class="token operator">*</span> drink<span class="token punctuation">)</span><span class="token punctuation">{</span>
	drink<span class="token operator">-&gt;</span><span class="token function">MakeDrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	delete drink<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">DoBussiness</span><span class="token punctuation">(</span>new Coffee<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;--------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">DoBussiness</span><span class="token punctuation">(</span>new Tea<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h4 id="_4-8-5-纯虚函数和多继承" tabindex="-1"><a class="header-anchor" href="#_4-8-5-纯虚函数和多继承" aria-hidden="true">#</a> 4.8.5 纯虚函数和多继承</h4><p>多继承带来了一些争议，但是接口继承可以说一种毫无争议的运用了。</p><p>绝大数面向对象语言都不支持多继承，但是绝大数面向对象对象语言都支持接口的概念，c++中没有接口的概念，但是可以通过纯虚函数实现接口。</p><p><strong>接口类中只有函数原型定义，没有任何数据定义。</strong></p><p>多重继承接口不会带来二义性和复杂性问题。接口类只是一个功能声明，并不是功能实现，子类需要根据功能说明定义功能实现。</p><p><strong>注意:除了析构函数外，其他声明都是纯虚函数。</strong></p><h4 id="_4-8-6虚析构函数" tabindex="-1"><a class="header-anchor" href="#_4-8-6虚析构函数" aria-hidden="true">#</a> 4.8.6虚析构函数</h4><h5 id="_4-8-6-1-虚析构函数作用" tabindex="-1"><a class="header-anchor" href="#_4-8-6-1-虚析构函数作用" aria-hidden="true">#</a> 4.8.6.1 虚析构函数作用</h5><p><strong>虚析构函数是为了解决基类的指针指向派生类对象，并用基类的指针删除派生类对象。</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class People<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">People</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造函数 People!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	virtual <span class="token keyword">void</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	virtual <span class="token operator">~</span><span class="token function">People</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构函数 People!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Worker <span class="token operator">:</span> public People<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Worker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;构造函数 Worker!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		pName <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	virtual <span class="token keyword">void</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打印子类的名字!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Worker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;析构函数 Worker!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			delete pName<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> pName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	People<span class="token operator">*</span> people <span class="token operator">=</span> new Worker<span class="token punctuation">;</span>
	people<span class="token operator">-&gt;</span><span class="token operator">~</span><span class="token function">People</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h5 id="_4-8-6-2-纯虚析构函数" tabindex="-1"><a class="header-anchor" href="#_4-8-6-2-纯虚析构函数" aria-hidden="true">#</a> 4.8.6.2 纯虚析构函数</h5><p>纯虚析构函数在c++中是合法的，但是在使用的时候有一个额外的限制：必须为纯虚析构函数提供一个函数体。</p><p>那么问题是：如果给虚析构函数提供函数体了，那怎么还能称作纯虚析构函数呢？</p><p>纯虚析构函数和非纯析构函数之间唯一的不同之处在于纯虚析构函数使得基类是抽象类，不能创建基类的对象。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//非纯虚析构函数</span>
class A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

A<span class="token operator">::</span><span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">//纯析构函数</span>
class B<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token operator">~</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

B<span class="token operator">::</span><span class="token operator">~</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	A a<span class="token punctuation">;</span> <span class="token comment">//A类不是抽象类，可以实例化对象</span>
	B b<span class="token punctuation">;</span> <span class="token comment">//B类是抽象类，不可以实例化对象</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>如果类的目的不是为了实现多态，作为基类来使用，就不要声明虚析构函数，反之，则应该为类声明虚析构函数。</p><h4 id="_4-8-7-重写-重载-重定义" tabindex="-1"><a class="header-anchor" href="#_4-8-7-重写-重载-重定义" aria-hidden="true">#</a> 4.8.7 重写 重载 重定义</h4><ul><li>重载，同一作用域的同名函数</li></ul><ol><li><p>同一个作用域</p></li><li><p>参数个数，参数顺序，参数类型不同</p></li><li><p>和函数返回值，没有关系</p></li><li><p>const也可以作为重载条件 //do(const Teacher&amp; t){} do(Teacher&amp; t)</p></li></ol><ul><li>重定义（隐藏）</li></ul><ol><li><p>有继承</p></li><li><p>子类（派生类）重新定义父类（基类）的同名成员（非virtual函数）</p></li></ol><ul><li>重写（覆盖）</li></ul><ol><li><p>有继承</p></li><li><p>子类（派生类）重写父类（基类）的virtual函数</p></li><li><p>函数返回值，函数名字，函数参数，必须和基类中的虚函数一致</p></li></ol><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//同一作用域下，func1函数重载</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	virtual <span class="token keyword">void</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class B <span class="token operator">:</span> public A<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token comment">//重定义基类的func2,隐藏了基类的func2方法</span>
	<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token comment">//重写基类的func3函数，也可以覆盖基类func3</span>
	virtual <span class="token keyword">void</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>我</p><h2 id="_5-c-模板" tabindex="-1"><a class="header-anchor" href="#_5-c-模板" aria-hidden="true">#</a> 5.c++模板</h2><h3 id="_5-1-模板概论" tabindex="-1"><a class="header-anchor" href="#_5-1-模板概论" aria-hidden="true">#</a> 5.1 模板概论</h3><p>c++提供了函数模板(function template.)所谓函数模板，**实际上是建立一个通用函数，其函数类型和形参类型不具体制定，用一个虚拟的类型来代表。这个通用函数就成为函数模板。**凡是函数体相同的函数都可以用这个模板代替，不必定义多个函数，只需在模板中定义一次即可。在调用函数时系统会根据实参的类型来取代模板中的虚拟类型，从而实现不同函数的功能。</p><ul><li><p>c++提供两种模板机制:<strong>函数模板</strong>和<strong>类模板</strong></p></li><li><p>类属 - 类型参数化，又称参数模板</p></li></ul><p><strong>总结：</strong></p><ul><li><p>模板把函数或类要处理的数据类型参数化，表现为参数的多态性，成为类属。</p></li><li><p>模板用于表达逻辑结构相同，但具体数据元素类型不同的数据对象的通用行为。</p></li></ul><h3 id="_5-2-函数模板" tabindex="-1"><a class="header-anchor" href="#_5-2-函数模板" aria-hidden="true">#</a> 5.2 函数模板</h3><h4 id="_5-2-1-什么是函数模板" tabindex="-1"><a class="header-anchor" href="#_5-2-1-什么是函数模板" aria-hidden="true">#</a> 5.2.1 什么是函数模板？</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//交换int数据</span>
<span class="token keyword">void</span> <span class="token function">SwapInt</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> b<span class="token punctuation">;</span>
	b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//交换char数据</span>
<span class="token keyword">void</span> <span class="token function">SwapChar</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> b<span class="token punctuation">;</span>
	b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//问题：如果我要交换double类型数据，那么还需要些一个double类型数据交换的函数</span>
<span class="token comment">//繁琐，写的函数越多，当交换逻辑发生变化的时候，所有的函数都需要修改，无形当中增加了代码的维护难度</span>

<span class="token comment">//如果能把类型作为参数传递进来就好了，传递int就是Int类型交换，传递char就是char类型交换</span>
<span class="token comment">//我们有一种技术，可以实现类型的参数化---函数模板</span>


<span class="token comment">//class 和 typename都是一样的，用哪个都可以</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">MySwap</span><span class="token punctuation">(</span>T<span class="token operator">&amp;</span> a<span class="token punctuation">,</span>T<span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	T temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> b<span class="token punctuation">;</span>
	b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//1. 这里有个需要注意点，函数模板可以自动推导参数的类型</span>
	<span class="token function">MySwap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a:&quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; b:&quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">char</span> c1 <span class="token operator">=</span> <span class="token char">&#39;a&#39;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> c2 <span class="token operator">=</span> <span class="token char">&#39;b&#39;</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1:&quot;</span> <span class="token operator">&lt;&lt;</span> c1 <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; c2:&quot;</span> <span class="token operator">&lt;&lt;</span> c2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//2. 函数模板可以自动类型推导，那么也可以显式指定类型</span>
	MySwap<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c1:&quot;</span> <span class="token operator">&lt;&lt;</span> c1 <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; c2:&quot;</span> <span class="token operator">&lt;&lt;</span> c2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p><strong>用模板是为了实现泛型，可以减轻编程的工作量，增强函数的重用性。</strong></p><h4 id="_5-2-2-练习" tabindex="-1"><a class="header-anchor" href="#_5-2-2-练习" aria-hidden="true">#</a> 5.2.2 练习</h4><p><strong>使用函数模板实现对char和int类型数组进行排序？</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//模板打印函数</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">PrintArray</span><span class="token punctuation">(</span>T arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//模板排序函数</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">MySort</span><span class="token punctuation">(</span>T arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> i<span class="token punctuation">;</span>j<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> arr<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				T temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				arr<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token comment">//char数组</span>
	<span class="token keyword">char</span> tempChar<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;aojtifysn&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> charLen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tempChar<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//int数组</span>
	<span class="token keyword">int</span> tempInt<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> intLen <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>tempInt<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//排序前 打印函数</span>
	<span class="token function">PrintArray</span><span class="token punctuation">(</span>tempChar<span class="token punctuation">,</span> charLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">PrintArray</span><span class="token punctuation">(</span>tempInt<span class="token punctuation">,</span> intLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//排序</span>
	<span class="token function">MySort</span><span class="token punctuation">(</span>tempChar<span class="token punctuation">,</span> charLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MySort</span><span class="token punctuation">(</span>tempInt<span class="token punctuation">,</span> intLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//排序后打印</span>
	<span class="token function">PrintArray</span><span class="token punctuation">(</span>tempChar<span class="token punctuation">,</span> charLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">PrintArray</span><span class="token punctuation">(</span>tempInt<span class="token punctuation">,</span> intLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="_5-3函数模板和普通函数区别" tabindex="-1"><a class="header-anchor" href="#_5-3函数模板和普通函数区别" aria-hidden="true">#</a> 5.3函数模板和普通函数区别</h3><ul><li><p>函数模板不允许自动类型转化</p></li><li><p>普通函数能够自动进行类型转化</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//函数模板</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
T <span class="token function">MyPlus</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	T ret <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//普通函数</span>
<span class="token keyword">int</span> <span class="token function">MyPlus</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">char</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> b <span class="token operator">=</span> <span class="token char">&#39;a&#39;</span><span class="token punctuation">;</span>

	<span class="token comment">//调用函数模板，严格匹配类型</span>
	<span class="token function">MyPlus</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MyPlus</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//调用普通函数</span>
	<span class="token function">MyPlus</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//调用普通函数  普通函数可以隐式类型转换</span>
	<span class="token function">MyPlus</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//结论：</span>
	<span class="token comment">//函数模板不允许自动类型转换，必须严格匹配类型</span>
	<span class="token comment">//普通函数可以进行自动类型转换</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_5-4-函数模板和普通函数在一起调用规则" tabindex="-1"><a class="header-anchor" href="#_5-4-函数模板和普通函数在一起调用规则" aria-hidden="true">#</a> 5.4 函数模板和普通函数在一起调用规则</h3><ul><li><p>c++编译器优先考虑普通函数</p></li><li><p>可以通过空模板实参列表的语法限定编译器只能通过模板匹配</p></li><li><p>函数模板可以像普通函数那样可以被重载</p></li><li><p>如果函数模板可以产生一个更好的匹配，那么选择模板</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//函数模板</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
T <span class="token function">MyPlus</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	T ret <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//普通函数</span>
<span class="token keyword">int</span> <span class="token function">MyPlus</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token char">&#39;a&#39;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> d <span class="token operator">=</span> <span class="token char">&#39;b&#39;</span><span class="token punctuation">;</span>
	<span class="token comment">//如果函数模板和普通函数都能匹配，c++编译器优先考虑普通函数</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">MyPlus</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//如果我必须要调用函数模板,那么怎么办?</span>
	cout <span class="token operator">&lt;&lt;</span> MyPlus<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//此时普通函数也可以匹配，因为普通函数可以自动类型转换</span>
	<span class="token comment">//但是此时函数模板能够有更好的匹配</span>
	<span class="token comment">//如果函数模板可以产生一个更好的匹配，那么选择模板</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">MyPlus</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//函数模板重载</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
T <span class="token function">MyPlus</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">,</span> T c<span class="token punctuation">)</span><span class="token punctuation">{</span>
	T ret <span class="token operator">=</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">MyPlus</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//如果函数模板和普通函数都能匹配，c++编译器优先考虑普通函数</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="_5-5-模板机制剖析" tabindex="-1"><a class="header-anchor" href="#_5-5-模板机制剖析" aria-hidden="true">#</a> 5.5 模板机制剖析</h3><p><strong>思考:为什么函数模板可以和普通函数放在一起?c++编译器是如何实现函数模板机制的？</strong></p><h4 id="_5-5-1-编译过程" tabindex="-1"><a class="header-anchor" href="#_5-5-1-编译过程" aria-hidden="true">#</a> 5.5.1 编译过程</h4><p>hello.cpp程序是高级c语言程序，这种程序易于被人读懂。为了在系统上运行hello.c程序，每一条c语句都必须转化为低级的机器指令。然后将这些机器指令打包成可执行目标文件格式，并以二进制形式存储于磁盘中。</p><p>预处理(Pre-processing) -&gt; 编译(Compiling) -&gt;汇编(Assembling) -&gt; 链接(Linking)</p><p><img src="/by-jj/C++/wps6A.tmp.jpg" alt="wps6A.tmp.jpg"></p><h4 id="_5-5-2模板实现机制" tabindex="-1"><a class="header-anchor" href="#_5-5-2模板实现机制" aria-hidden="true">#</a> 5.5.2模板实现机制</h4><p><strong>函数模板机制结论：</strong></p><ul><li><p><strong>编译器并不是把函数模板处理成能够处理任何类型的函数</strong></p></li><li><p><strong>函数模板通过具体类型产生不同的函数</strong></p></li><li><p><strong>编译器会对函数模板进行两次编译，在声明的地方对模板代码本身进行编译，在调用的地方对参数替换后的代码进行编译。</strong></p></li></ul><h3 id="_5-6-模板的局限性" tabindex="-1"><a class="header-anchor" href="#_5-6-模板的局限性" aria-hidden="true">#</a> 5.6 模板的局限性</h3><p><strong>假设有如下模板函数：</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
	<span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span>
	<span class="token punctuation">{</span> … <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>如果代码实现时定义了赋值操作 a = b，但是T为数组，这种假设就不成立了</strong></p><p><strong>同样，如果里面的语句为判断语句 if(a&gt;b),但T如果是结构体，该假设也不成立，另外如果是传入的数组，数组名为地址，因此它比较的是地址，而这也不是我们所希望的操作。</strong></p><p><strong>总之，编写的模板函数很可能无法处理某些类型，另一方面，有时候通用化是有意义的，但C++语法不允许这样做。为了解决这种问题，可以提供模板的重载，为这些特定的类型提供具体化的模板。</strong></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	string mName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//普通交换函数</span>
template <span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">mySwap</span><span class="token punctuation">(</span>T <span class="token operator">&amp;</span>a<span class="token punctuation">,</span>T <span class="token operator">&amp;</span>b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	T temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
	a <span class="token operator">=</span> b<span class="token punctuation">;</span> 
	b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//第三代具体化，显示具体化的原型和定意思以template&lt;&gt;开头，并通过名称来指出类型</span>
<span class="token comment">//具体化优先于常规模板</span>
template<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token keyword">void</span>  mySwap<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p1<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>p2<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	string nameTemp<span class="token punctuation">;</span>
	<span class="token keyword">int</span> ageTemp<span class="token punctuation">;</span>

	nameTemp <span class="token operator">=</span> p1<span class="token punctuation">.</span>mName<span class="token punctuation">;</span>
	p1<span class="token punctuation">.</span>mName <span class="token operator">=</span> p2<span class="token punctuation">.</span>mName<span class="token punctuation">;</span>
	p2<span class="token punctuation">.</span>mName <span class="token operator">=</span> nameTemp<span class="token punctuation">;</span>

	ageTemp <span class="token operator">=</span> p1<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
	p1<span class="token punctuation">.</span>mAge <span class="token operator">=</span> p2<span class="token punctuation">.</span>mAge<span class="token punctuation">;</span>
	p2<span class="token punctuation">.</span>mAge <span class="token operator">=</span> ageTemp<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Person <span class="token function">P1</span><span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">P2</span><span class="token punctuation">(</span><span class="token string">&quot;Jerry&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;P1 Name = &quot;</span> <span class="token operator">&lt;&lt;</span> P1<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; P1 Age = &quot;</span> <span class="token operator">&lt;&lt;</span> P1<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;P2 Name = &quot;</span> <span class="token operator">&lt;&lt;</span> P2<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; P2 Age = &quot;</span> <span class="token operator">&lt;&lt;</span> P2<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">mySwap</span><span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;P1 Name = &quot;</span> <span class="token operator">&lt;&lt;</span> P1<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; P1 Age = &quot;</span> <span class="token operator">&lt;&lt;</span> P1<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;P2 Name = &quot;</span> <span class="token operator">&lt;&lt;</span> P2<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; P2 Age = &quot;</span> <span class="token operator">&lt;&lt;</span> P2<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><h3 id="_5-7-类模板" tabindex="-1"><a class="header-anchor" href="#_5-7-类模板" aria-hidden="true">#</a> 5.7 类模板</h3><h4 id="_5-7-1-类模板基本概念" tabindex="-1"><a class="header-anchor" href="#_5-7-1-类模板基本概念" aria-hidden="true">#</a> 5.7.1 类模板基本概念</h4><p>类模板和函数模板的定义和使用类似，我们已经进行了介绍。有时，有两个或多个类，其功能是相同的，仅仅是数据类型不同。</p><ul><li>类模板用于实现类所需数据的类型参数化</li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>template<span class="token operator">&lt;</span>class NameType<span class="token punctuation">,</span> class AgeType<span class="token operator">&gt;</span>
class Person
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>NameType name<span class="token punctuation">,</span> AgeType age<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;name: &quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; age: &quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	NameType mName<span class="token punctuation">;</span>
	AgeType mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//Person P1(&quot;德玛西亚&quot;,18); // 类模板不能进行类型自动推导 </span>
	Person<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token function">P1</span><span class="token punctuation">(</span><span class="token string">&quot;德玛西亚&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	P1<span class="token punctuation">.</span><span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="_5-7-2-类模板做函数参数" tabindex="-1"><a class="header-anchor" href="#_5-7-2-类模板做函数参数" aria-hidden="true">#</a> 5.7.2 类模板做函数参数</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//类模板</span>
template<span class="token operator">&lt;</span>class NameType<span class="token punctuation">,</span> class AgeType<span class="token operator">&gt;</span>
class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>NameType name<span class="token punctuation">,</span> AgeType age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	NameType mName<span class="token punctuation">;</span>
	AgeType mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//类模板做函数参数</span>
<span class="token keyword">void</span> <span class="token function">DoBussiness</span><span class="token punctuation">(</span>Person<span class="token operator">&lt;</span>string<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">{</span>
	p<span class="token punctuation">.</span>mAge <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	p<span class="token punctuation">.</span>mName <span class="token operator">+=</span> <span class="token string">&quot;_vip&quot;</span><span class="token punctuation">;</span>
	p<span class="token punctuation">.</span><span class="token function">PrintPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">DoBussiness</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="_5-7-3-类模板派生普通类" tabindex="-1"><a class="header-anchor" href="#_5-7-3-类模板派生普通类" aria-hidden="true">#</a> 5.7.3 类模板派生普通类</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//类模板</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
class MyClass<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">MyClass</span><span class="token punctuation">(</span>T property<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mProperty <span class="token operator">=</span> property<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	T mProperty<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//子类实例化的时候需要具体化的父类，子类需要知道父类的具体类型是什么样的</span>
<span class="token comment">//这样c++编译器才能知道给子类分配多少内存</span>

<span class="token comment">//普通派生类</span>
class SubClass <span class="token operator">:</span> public MyClass<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">SubClass</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token operator">:</span> MyClass<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mB <span class="token operator">=</span> b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="_5-7-4-类模板派生类模板" tabindex="-1"><a class="header-anchor" href="#_5-7-4-类模板派生类模板" aria-hidden="true">#</a> 5.7.4 类模板派生类模板</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//父类类模板</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
class Base
<span class="token punctuation">{</span>
	T m<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
template<span class="token operator">&lt;</span>class T <span class="token operator">&gt;</span>
class Child2 <span class="token operator">:</span> public Base<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span>  <span class="token comment">//继承类模板的时候，必须要确定基类的大小</span>
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	T mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Child2<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> d2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="_5-7-5-类模板类内实现" tabindex="-1"><a class="header-anchor" href="#_5-7-5-类模板类内实现" aria-hidden="true">#</a> 5.7.5 类模板类内实现</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//父类类模板</span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
class Base
<span class="token punctuation">{</span>
	T m<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
template<span class="token operator">&lt;</span>class T <span class="token operator">&gt;</span>
class Child2 <span class="token operator">:</span> public Base<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span>  <span class="token comment">//继承类模板的时候，必须要确定基类的大小</span>
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	T mParam<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Child2<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> d2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="_5-7-6-类模板类外实现" tabindex="-1"><a class="header-anchor" href="#_5-7-6-类模板类外实现" aria-hidden="true">#</a> 5.7.6 类模板类外实现</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string&gt;</span></span>
using namespace std<span class="token punctuation">;</span>

template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>T1 name<span class="token punctuation">,</span> T2 age<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

public<span class="token operator">:</span>
	T1 mName<span class="token punctuation">;</span>
	T2 mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//类外实现</span>
template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">Person</span><span class="token punctuation">(</span>T1 name<span class="token punctuation">,</span> T2 age<span class="token punctuation">)</span><span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
<span class="token keyword">void</span> Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Person<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token string">&quot;Obama&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	p<span class="token punctuation">.</span><span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h4 id="_5-7-7-类模板头文件和源文件分离问题" tabindex="-1"><a class="header-anchor" href="#_5-7-7-类模板头文件和源文件分离问题" aria-hidden="true">#</a> 5.7.7 类模板头文件和源文件分离问题</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//Person.hpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span>class T2<span class="token operator">&gt;</span>
class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>T1 name<span class="token punctuation">,</span>T2 age<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
public<span class="token operator">:</span>
	T1 mName<span class="token punctuation">;</span>
	T2 mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">Person</span><span class="token punctuation">(</span>T1 name<span class="token punctuation">,</span> T2 age<span class="token punctuation">)</span><span class="token punctuation">{</span>
	this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
	this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
<span class="token keyword">void</span> Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//main.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&quot;Person.hpp&quot;</span></span>

<span class="token comment">//模板二次编译</span>
<span class="token comment">//编译器编译源码 逐个编译单元编译的</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Person<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token string">&quot;Obama&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	p<span class="token punctuation">.</span><span class="token function">ShowPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>结论:</strong> 案例代码在qt编译器顺利通过编译并执行，但是在Linux和vs编辑器下如果只包含头文件，那么会报错链接错误，需要包含cpp文件，但是如果类模板中有友元类，那么编译失败！</p><p><strong>解决方案: 类模板的声明和实现放到一个文件中，我们把这个文件命名为.hpp(这个是个约定的规则，并不是标准，必须这么写).</strong></p><p><strong>原因：</strong></p><ul><li><p><strong>类模板需要二次编译，在出现模板的地方编译一次，在调用模板的地方再次编译。</strong></p></li><li><p><strong>C++编译规则为独立编译。</strong></p></li></ul><h4 id="_5-7-8-模板类碰到友元函数" tabindex="-1"><a class="header-anchor" href="#_5-7-8-模板类碰到友元函数" aria-hidden="true">#</a> 5.7.8 模板类碰到友元函数</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span> class Person<span class="token punctuation">;</span>
<span class="token comment">//告诉编译器这个函数模板是存在</span>
template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span> <span class="token keyword">void</span> <span class="token function">PrintPerson2</span><span class="token punctuation">(</span>Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//友元函数在类内实现</span>
template<span class="token operator">&lt;</span>class T1<span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
class Person<span class="token punctuation">{</span>
	<span class="token comment">//1. 友元函数在类内实现</span>
	friend <span class="token keyword">void</span> <span class="token function">PrintPerson</span><span class="token punctuation">(</span>Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//2.友元函数类外实现</span>
	<span class="token comment">//告诉编译器这个函数模板是存在</span>
	friend <span class="token keyword">void</span> PrintPerson2<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//3. 类模板碰到友元函数模板</span>
	template<span class="token operator">&lt;</span>class U1<span class="token punctuation">,</span> class U2<span class="token operator">&gt;</span>
	friend <span class="token keyword">void</span> <span class="token function">PrintPerson</span><span class="token punctuation">(</span>Person<span class="token operator">&lt;</span>U1<span class="token punctuation">,</span> U2<span class="token operator">&gt;</span><span class="token operator">&amp;</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>T1 name<span class="token punctuation">,</span> T2 age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> this<span class="token operator">-&gt;</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
private<span class="token operator">:</span>
	T1 mName<span class="token punctuation">;</span>
	T2 mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Person <span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token string">&quot;Jerry&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">PrintPerson</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// 类模板碰到友元函数</span>
<span class="token comment">//友元函数类外实现  加上&lt;&gt;空参数列表，告诉编译去匹配函数模板</span>
template<span class="token operator">&lt;</span>class T1 <span class="token punctuation">,</span> class T2<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">PrintPerson2</span><span class="token punctuation">(</span>Person<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token operator">&gt;</span><span class="token operator">&amp;</span> p<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name2:&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age2:&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span>  <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	Person <span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token function">p</span><span class="token punctuation">(</span><span class="token string">&quot;Jerry&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">PrintPerson2</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//不写可以编译通过，写了之后，会找PrintPerson2的普通函数调用，因为写了普通函数PrintPerson2的声明	</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token comment">//test01();</span>
	<span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h3 id="_5-8-类模板的应用" tabindex="-1"><a class="header-anchor" href="#_5-8-类模板的应用" aria-hidden="true">#</a> 5.8 类模板的应用</h3><p>设计一个数组模板类(MyArray),完成对不同类型元素的管理</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
template<span class="token operator">&lt;</span>class T<span class="token operator">&gt;</span>
class MyArray
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	explicit <span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token comment">// 如果T是对象，那么这个对象必须提供默认的构造函数</span>
		pAddress <span class="token operator">=</span> new T<span class="token punctuation">[</span>this<span class="token operator">-&gt;</span>m_Capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//拷贝构造</span>
	<span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyArray <span class="token operator">&amp;</span> arr<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">=</span> arr<span class="token punctuation">.</span>m_Capacity<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> arr<span class="token punctuation">.</span>m_Size<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>pAddress <span class="token operator">=</span> new T<span class="token punctuation">[</span>this<span class="token operator">-&gt;</span>m_Capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">.</span>pAddress<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//重载[] 操作符  arr[0]</span>
	T<span class="token operator">&amp;</span> operator <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token comment">//尾插法</span>
	<span class="token keyword">void</span> <span class="token function">Push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span> val<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">==</span> this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">[</span>this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>m_Size<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>m_Size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		this<span class="token operator">-&gt;</span>m_Size<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span>	<span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>m_Size<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//析构</span>
	<span class="token operator">~</span><span class="token function">MyArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>pAddress <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			delete<span class="token punctuation">[</span><span class="token punctuation">]</span> this<span class="token operator">-&gt;</span>pAddress<span class="token punctuation">;</span>
			this<span class="token operator">-&gt;</span>pAddress <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			this<span class="token operator">-&gt;</span>m_Capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
			this<span class="token operator">-&gt;</span>m_Size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

private<span class="token operator">:</span>
	T <span class="token operator">*</span> pAddress<span class="token punctuation">;</span>  <span class="token comment">//指向一个堆空间，这个空间存储真正的数据</span>
	<span class="token keyword">int</span> m_Capacity<span class="token punctuation">;</span> <span class="token comment">//容量</span>
	<span class="token keyword">int</span> m_Size<span class="token punctuation">;</span>   <span class="token comment">// 大小</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//测试代码：</span>


class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	string mName<span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">PrintMyArrayInt</span><span class="token punctuation">(</span>MyArray<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">PrintMyPerson</span><span class="token punctuation">(</span>MyArray<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span><span class="token operator">&amp;</span> personArr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> personArr<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;姓名：&quot;</span> <span class="token operator">&lt;&lt;</span> personArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; 年龄： &quot;</span> <span class="token operator">&lt;&lt;</span> personArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
	
	MyArray<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">myArrayInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		myArrayInt<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	myArrayInt<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">PrintMyArrayInt</span><span class="token punctuation">(</span>myArrayInt<span class="token punctuation">)</span><span class="token punctuation">;</span>

MyArray<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token function">myArrayPerson</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token string">&quot;德玛西亚&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token string">&quot;提莫&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p3</span><span class="token punctuation">(</span><span class="token string">&quot;孙悟空&quot;</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p4</span><span class="token punctuation">(</span><span class="token string">&quot;赵信&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p5</span><span class="token punctuation">(</span><span class="token string">&quot;赵云&quot;</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	myArrayPerson<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	myArrayPerson<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	myArrayPerson<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span>p3<span class="token punctuation">)</span><span class="token punctuation">;</span>
	myArrayPerson<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span>p4<span class="token punctuation">)</span><span class="token punctuation">;</span>
	myArrayPerson<span class="token punctuation">.</span><span class="token function">Push_back</span><span class="token punctuation">(</span>p5<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br></div></div><h2 id="_6-c-类型转换" tabindex="-1"><a class="header-anchor" href="#_6-c-类型转换" aria-hidden="true">#</a> 6.c++类型转换</h2><p>类型转换(cast)是将一种数据类型转换成另一种数据类型。例如，如果将一个整型值赋给一个浮点类型的变量，编译器会暗地里将其转换成浮点类型。</p><p>转换是非常有用的，但是它也会带来一些问题，比如在转换指针时，我们很可能将其转换成一个比它更大的类型，但这可能会破坏其他的数据。</p><p>应该小心类型转换，因为转换也就相当于对编译器说：忘记类型检查，把它看做其他的类型。</p><p>一般情况下，尽量少的去使用类型转换，除非用来解决非常特殊的问题。</p><p>**无论什么原因，任何一个程序如果使用很多类型转换都值得怀疑. **</p><p>标准c++提供了一个显示的转换的语法，来替代旧的C风格的类型转换。</p><p>使用C风格的强制转换可以把想要的任何东西转换成我们需要的类型。那为什么还需要一个新的C++类型的强制转换呢？</p><p>新类型的强制转换可以提供更好的控制强制转换过程，允许控制各种不同种类的强制转换。C++风格的强制转换其他的好处是，它们能更清晰的表明它们要干什么。程序员只要扫一眼这样的代码，就能立即知道一个强制转换的目的。</p><h3 id="_6-1-静态转换-static-cast" tabindex="-1"><a class="header-anchor" href="#_6-1-静态转换-static-cast" aria-hidden="true">#</a> 6.1 静态转换（static_cast）</h3><ul><li><p>用于类层次结构中基类（父类）和（子类）之间指针或引用的转换。</p></li><li><p>进行上行转换（把派生类的指针或引用转换成基类表示）是安全的；</p></li><li><p>进行下行转换（把基类指针或引用转换成派生类表示）时，由于没有动态类型检查，所以是不安全的。</p></li><li><p>用于基本数据类型之间的转换，如把int转换成char，把char转换成int。这种转换的安全性也要开发人员来保证。</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Animal<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Dog <span class="token operator">:</span> public Animal<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
class Other<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//基础数据类型转换</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> a <span class="token operator">=</span> <span class="token char">&#39;a&#39;</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> b <span class="token operator">=</span> static_cast<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//继承关系指针互相转换</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//继承关系指针转换</span>
	Animal<span class="token operator">*</span> animal01 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	Dog<span class="token operator">*</span> dog01 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token comment">//子类指针转成父类指针,安全</span>
	Animal<span class="token operator">*</span> animal02 <span class="token operator">=</span> static_cast<span class="token operator">&lt;</span>Animal<span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dog01<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//父类指针转成子类指针，不安全</span>
	Dog<span class="token operator">*</span> dog02 <span class="token operator">=</span> static_cast<span class="token operator">&lt;</span>Dog<span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>animal01<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//继承关系引用相互转换</span>
<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Animal ani_ref<span class="token punctuation">;</span>
	Dog dog_ref<span class="token punctuation">;</span>
	<span class="token comment">//继承关系指针转换</span>
	Animal<span class="token operator">&amp;</span> animal01 <span class="token operator">=</span> ani_ref<span class="token punctuation">;</span>
	Dog<span class="token operator">&amp;</span> dog01 <span class="token operator">=</span> dog_ref<span class="token punctuation">;</span>
	<span class="token comment">//子类指针转成父类指针,安全</span>
	Animal<span class="token operator">&amp;</span> animal02 <span class="token operator">=</span> static_cast<span class="token operator">&lt;</span>Animal<span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dog01<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//父类指针转成子类指针，不安全</span>
	Dog<span class="token operator">&amp;</span> dog02 <span class="token operator">=</span> static_cast<span class="token operator">&lt;</span>Dog<span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>animal01<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//无继承关系指针转换</span>
<span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	Animal<span class="token operator">*</span> animal01 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	Other<span class="token operator">*</span> other01 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">//转换失败</span>
	<span class="token comment">//Animal* animal02 = static_cast&lt;Animal*&gt;(other01);</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="_6-2-动态转换-dynamic-cast" tabindex="-1"><a class="header-anchor" href="#_6-2-动态转换-dynamic-cast" aria-hidden="true">#</a> 6.2 动态转换（dynamic_cast）</h3><ul><li><p>dynamic_cast主要用于类层次间的上行转换和下行转换；</p></li><li><p>在类层次间进行上行转换时，dynamic_cast和static_cast的效果是一样的；</p></li><li><p>在进行下行转换时，dynamic_cast具有类型检查的功能，比static_cast更安全；</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Animal <span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Dog <span class="token operator">:</span> public Animal<span class="token punctuation">{</span>
	virtual <span class="token keyword">void</span> <span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;I am a dog!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
class Other <span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">PrintSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;我是其他类!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//普通类型转换</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token comment">//不支持基础数据类型</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token comment">//double a = dynamic_cast&lt;double&gt;(a);</span>
<span class="token punctuation">}</span>

<span class="token comment">//继承关系指针</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Animal<span class="token operator">*</span> animal01 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	Dog<span class="token operator">*</span> dog01 <span class="token operator">=</span> new Dog<span class="token punctuation">;</span>

	<span class="token comment">//子类指针转换成父类指针 可以</span>
	Animal<span class="token operator">*</span> animal02 <span class="token operator">=</span> dynamic_cast<span class="token operator">&lt;</span>Animal<span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dog01<span class="token punctuation">)</span><span class="token punctuation">;</span>
	animal02<span class="token operator">-&gt;</span><span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//父类指针转换成子类指针 不可以</span>
	<span class="token comment">//Dog* dog02 = dynamic_cast&lt;Dog*&gt;(animal01);</span>
<span class="token punctuation">}</span>

<span class="token comment">//继承关系引用</span>
<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	Dog dog_ref<span class="token punctuation">;</span>
	Dog<span class="token operator">&amp;</span> dog01 <span class="token operator">=</span> dog_ref<span class="token punctuation">;</span>

	<span class="token comment">//子类引用转换成父类引用 可以</span>
	Animal<span class="token operator">&amp;</span> animal02 <span class="token operator">=</span> dynamic_cast<span class="token operator">&lt;</span>Animal<span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dog01<span class="token punctuation">)</span><span class="token punctuation">;</span>
	animal02<span class="token punctuation">.</span><span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//无继承关系指针转换</span>
<span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	Animal<span class="token operator">*</span> animal01 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	Other<span class="token operator">*</span> other <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">//不可以</span>
	<span class="token comment">//Animal* animal02 = dynamic_cast&lt;Animal*&gt;(other);</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h3 id="_6-3-常量转换-const-cast" tabindex="-1"><a class="header-anchor" href="#_6-3-常量转换-const-cast" aria-hidden="true">#</a> 6.3 常量转换（const_cast）</h3><p>该运算符用来修改类型的const属性。。</p><ul><li><p>常量指针被转化成非常量指针，并且仍然指向原来的对象；</p></li><li><p>常量引用被转换成非常量引用，并且仍然指向原来的对象；</p></li></ul><p>**注意:**不能直接对非指针和非引用的变量使用const_cast操作符去直接移除它的const.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//常量指针转换成非常量指针</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> np <span class="token operator">=</span> const_cast<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span><span class="token operator">*</span> pp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span> npp <span class="token operator">=</span> const_cast<span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>pp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">const</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token comment">//不能对非指针或非引用进行转换</span>
	<span class="token comment">//int b = const_cast&lt;int&gt;(a); }</span>

<span class="token comment">//常量引用转换成非常量引用</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">&amp;</span> refNum <span class="token operator">=</span> num<span class="token punctuation">;</span>

	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> refNum2 <span class="token operator">=</span> const_cast<span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>refNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_6-4-重新解释转换-reinterpret-cast" tabindex="-1"><a class="header-anchor" href="#_6-4-重新解释转换-reinterpret-cast" aria-hidden="true">#</a> 6.4 重新解释转换(reinterpret_cast)</h3><p>这是最不安全的一种转换机制，最有可能出问题。</p><p>主要用于将一种数据类型从一种类型转换为另一种类型。它可以将一个指针转换成一个整数，也可以将一个整数转换成一个指针.</p><h2 id="_7-c-异常" tabindex="-1"><a class="header-anchor" href="#_7-c-异常" aria-hidden="true">#</a> 7.c++异常</h2><h3 id="_7-1-异常基本概念" tabindex="-1"><a class="header-anchor" href="#_7-1-异常基本概念" aria-hidden="true">#</a> 7.1 异常基本概念</h3><p>Bjarne Stroustrup说：提供异常的基本目的就是为了处理上面的问题。基本思想是：让一个函数在发现了自己无法处理的错误时抛出（throw）一个异常，然后它的（直接或者间接）调用者能够处理这个问题。也就是《C++ primer》中说的：将问题检测和问题处理相分离。</p><p>一种思想：在所有支持异常处理的编程语言中（例如java），要认识到的一个思想：在异常处理过程中，由问题检测代码可以抛出一个对象给问题处理代码，通过这个对象的类型和内容，实际上完成了两个部分的通信，通信的内容是“出现了什么错误”。当然，各种语言对异常的具体实现有着或多或少的区别，但是这个通信的思想是不变的。</p><p><strong>一句话：异常处理就是处理程序中的错误。所谓错误是指在程序运行的过程中发生的一些异常事件（如：除0溢出，数组下标越界，所要读取的文件不存在,空指针，内存不足等等）。</strong></p><p><strong>回顾一下：我们以前编写程序是如何处理异常？</strong></p><p>在C语言的世界中，对错误的处理总是围绕着两种方法：一是使用整型的返回值标识错误；二是使用errno宏（可以简单的理解为一个全局整型变量）去记录错误。当然C++中仍然是可以用这两种方法的。</p><p>​ 这两种方法最大的缺陷就是会出现不一致问题。例如有些函数返回1表示成功，返回0表示出错；而有些函数返回0表示成功，返回非0表示出错。</p><p>​ 还有一个缺点就是函数的返回值只有一个，你通过函数的返回值表示错误代码，那么函数就不能返回其他的值。当然，你也可以通过指针或者C++的引用来返回另外的值，但是这样可能会令你的程序略微晦涩难懂。</p><p><strong>c++异常机制相比C语言异常处理的优势?</strong></p><ul><li><p>函数的返回值可以忽略，但异常不可忽略。如果程序出现异常，但是没有被捕获，程序就会终止，这多少会促使程序员开发出来的程序更健壮一点。而如果使用C语言的error宏或者函数返回值，调用者都有可能忘记检查，从而没有对错误进行处理，结果造成程序莫名其面的终止或出现错误的结果。</p></li><li><p>整型返回值没有任何语义信息。而异常却包含语义信息，有时你从类名就能够体现出来。</p></li><li><p>整型返回值缺乏相关的上下文信息。异常作为一个类，可以拥有自己的成员，这些成员就可以传递足够的信息。</p></li><li><p>异常处理可以在调用跳级。这是一个代码编写时的问题：假设在有多个函数的调用栈中出现了某个错误，使用整型返回码要求你在每一级函数中都要进行处理。而使用异常处理的栈展开机制，只需要在一处进行处理就可以了，不需要每级函数都处理。</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//如果判断返回值，那么返回值是错误码还是结果？</span>
<span class="token comment">//如果不判断返回值，那么b==0时候，程序结果已经不正确</span>
<span class="token comment">//A写的代码</span>
<span class="token keyword">int</span> <span class="token function">A_MyDivide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//B写的代码</span>
<span class="token keyword">int</span> <span class="token function">B_MyDivide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> ba <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> bb <span class="token operator">=</span> b<span class="token punctuation">;</span>

	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">A_MyDivide</span><span class="token punctuation">(</span>ba<span class="token punctuation">,</span> bb<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//由于B没有处理异常，导致B结果运算错误</span>

	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//C写的代码</span>
<span class="token keyword">int</span> <span class="token function">C_MyDivide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">B_MyDivide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更严重的是，由于B没有继续抛出异常，导致C的代码没有办法捕获异常</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//所以,我们希望：</span>
<span class="token comment">//1.异常应该捕获，如果你捕获，可以，那么异常必须继续抛给上层函数,你不处理，不代表你的上层不处理</span>
<span class="token comment">//2.这个例子，异常没有捕获的结果就是运行结果错的一塌糊涂，结果未知，未知的结果程序没有必要执行下去</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="_7-2-异常语法" tabindex="-1"><a class="header-anchor" href="#_7-2-异常语法" aria-hidden="true">#</a> 7.2 异常语法</h3><h4 id="_7-2-1-异常基本语法" tabindex="-1"><a class="header-anchor" href="#_7-2-1-异常基本语法" aria-hidden="true">#</a> 7.2.1 异常基本语法</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">A_MyDivide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		throw <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//B写的代码 B写代码比较粗心，忘记处理异常</span>
<span class="token keyword">int</span> <span class="token function">B_MyDivide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> ba <span class="token operator">=</span> a<span class="token punctuation">;</span>
	<span class="token keyword">int</span> bb <span class="token operator">=</span> b<span class="token punctuation">;</span>

	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">A_MyDivide</span><span class="token punctuation">(</span>ba<span class="token punctuation">,</span> bb<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>  <span class="token comment">//由于B没有处理异常，导致B结果运算错误</span>

	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//C写的代码</span>
<span class="token keyword">int</span> <span class="token function">C_MyDivide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">//没有处理异常，程序直接中断执行</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span> </span></span>
	ret <span class="token operator">=</span> <span class="token function">B_MyDivide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//处理异常</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span> </span>
	try<span class="token punctuation">{</span>
		ret <span class="token operator">=</span> <span class="token function">B_MyDivide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更严重的是，由于B没有继续抛出异常，导致C的代码没有办法捕获异常</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token keyword">int</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C_MyDivide Call B_MyDivide 除数为:&quot;</span> <span class="token operator">&lt;&lt;</span> e <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
	
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token function">C_MyDivide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p><strong>总结:</strong></p><ul><li><p>若有异常则通过throw操作创建一个异常对象并抛出。</p></li><li><p>将可能抛出异常的程序段放到try块之中。</p></li><li><p>如果在try段执行期间没有引起异常，那么跟在try后面的catch字句就不会执行。</p></li><li><p>catch子句会根据出现的先后顺序被检查，匹配的catch语句捕获并处理异常(或继续抛出异常)</p></li><li><p>如果匹配的处理未找到，则运行函数terminate将自动被调用，其缺省功能调用abort终止程序。</p></li><li><p>处理不了的异常，可以在catch的最后一个分支，使用throw，向上抛。</p></li></ul><p>c++异常处理使得异常的引发和异常的处理不必在一个函数中，这样底层的函数可以着重解决具体问题，而不必过多的考虑异常的处理。上层调用者可以在适当的位置设计对不同类型异常的处理。</p><h4 id="_7-2-2-异常严格类型匹配" tabindex="-1"><a class="header-anchor" href="#_7-2-2-异常严格类型匹配" aria-hidden="true">#</a> 7.2.2 异常严格类型匹配</h4><p>异常机制和函数机制互不干涉,但是<strong>捕捉方式是通过严格类型匹配</strong>。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">TestFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;开始抛出异常...&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//throw 10; //抛出int类型异常</span>
	<span class="token comment">//throw &#39;a&#39;; //抛出char类型异常</span>
	<span class="token comment">//throw &quot;abcd&quot;; //抛出char*类型异常</span>
	string ex <span class="token operator">=</span> <span class="token string">&quot;string exception!&quot;</span><span class="token punctuation">;</span>
	throw ex<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	try<span class="token punctuation">{</span>
		<span class="token function">TestFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;抛出Int类型异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;抛出Char类型异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;抛出Char*类型异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;抛出string类型异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//捕获所有异常</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;抛出其他类型异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h4 id="_7-2-3-栈解旋-unwinding" tabindex="-1"><a class="header-anchor" href="#_7-2-3-栈解旋-unwinding" aria-hidden="true">#</a> 7.2.3 栈解旋（unwinding）</h4><p>异常被抛出后，从进入try块起，到异常被抛掷前，这期间在栈上构造的所有对象，都会被自动析构。析构的顺序与构造的顺序相反，这一过程称为栈的解旋(unwinding).</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mName <span class="token operator">=</span> name<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;对象被创建!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;对象被析构!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	string mName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">TestFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p3</span><span class="token punctuation">(</span><span class="token string">&quot;ccc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//抛出异常</span>
	throw <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	try<span class="token punctuation">{</span>
		<span class="token function">TestFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;异常被捕获!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="_7-2-4-异常接口声明" tabindex="-1"><a class="header-anchor" href="#_7-2-4-异常接口声明" aria-hidden="true">#</a> 7.2.4 异常接口声明</h4><ul><li><p>为了加强程序的可读性，可以在函数声明中列出可能抛出异常的所有类型，例如：void func() throw(A,B,C);这个函数func能够且只能抛出类型A,B,C及其子类型的异常。</p></li><li><p>如果在函数声明中没有包含异常接口声明，则此函数可以抛任何类型的异常，例如:void func()</p></li><li><p>一个不抛任何类型异常的函数可声明为:void func() throw()</p></li><li><p>如果一个函数抛出了它的异常接口声明所不允许抛出的异常,unexcepted函数会被调用，该函数默认行为调用terminate函数中断程序。</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//可抛出所有类型异常</span>
<span class="token keyword">void</span> <span class="token function">TestFunction01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	throw <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//只能抛出int char char*类型异常</span>
<span class="token keyword">void</span> <span class="token function">TestFunction02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">throw</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">char</span><span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	string exception <span class="token operator">=</span> <span class="token string">&quot;error!&quot;</span><span class="token punctuation">;</span>
	throw exception<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//不能抛出任何类型异常</span>
<span class="token keyword">void</span> <span class="token function">TestFunction03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">throw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	throw <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	try<span class="token punctuation">{</span>
		<span class="token comment">//TestFunction01();</span>
		<span class="token comment">//TestFunction02();</span>
		<span class="token comment">//TestFunction03();</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;捕获异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>可以分别在qt vs linux下做测试! Qt and Linux 正确!</p><h4 id="_7-2-5-异常变量生命周期" tabindex="-1"><a class="header-anchor" href="#_7-2-5-异常变量生命周期" aria-hidden="true">#</a> 7.2.5 异常变量生命周期</h4><ul><li><p>throw的异常是有类型的，可以是数字、字符串、类对象。</p></li><li><p>throw的异常是有类型的，catch需严格匹配异常类型。</p></li></ul><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class MyException
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">MyException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;异常变量构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">MyException</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyException <span class="token operator">&amp;</span> e<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;拷贝构造&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">MyException</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;异常变量析构&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	throw new <span class="token function">MyException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//test1 2都用 throw MyExecption();</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	try
	<span class="token punctuation">{</span>
		<span class="token function">DoWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>MyException e<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;捕获 异常&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	try
	<span class="token punctuation">{</span>
		<span class="token function">DoWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>MyException <span class="token operator">&amp;</span>e<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;捕获 异常&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	try
	<span class="token punctuation">{</span>
		<span class="token function">DoWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>MyException <span class="token operator">*</span>e<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;捕获 异常&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		delete e<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h4 id="_7-2-6-异常的多态使用" tabindex="-1"><a class="header-anchor" href="#_7-2-6-异常的多态使用" aria-hidden="true">#</a> 7.2.6 异常的多态使用</h4><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//异常基类</span>
class BaseException<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">printError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//空指针异常</span>
class NullPointerException <span class="token operator">:</span> public BaseException<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">printError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;空指针异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//越界异常</span>
class OutOfRangeException <span class="token operator">:</span> public BaseException<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	virtual <span class="token keyword">void</span> <span class="token function">printError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;越界异常!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	throw <span class="token function">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	try<span class="token punctuation">{</span>
		<span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>BaseException<span class="token operator">&amp;</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		ex<span class="token punctuation">.</span><span class="token function">printError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_7-3-c-标准库异常" tabindex="-1"><a class="header-anchor" href="#_7-3-c-标准库异常" aria-hidden="true">#</a> 7.3 c++标准库异常</h3><h4 id="_7-3-1-标准库介绍" tabindex="-1"><a class="header-anchor" href="#_7-3-1-标准库介绍" aria-hidden="true">#</a> 7.3.1 标准库介绍</h4><p>标准库中也提供了很多的异常类，它们是通过类继承组织起来的。异常类继承层级结构图如下：</p><p><img src="/by-jj/C++/wps4A21.tmp.jpg" alt="wps4A21.tmp.jpg"></p><p>每个类所在的头文件在图下方标识出来。</p><p><strong>标准异常类的成员：</strong></p><p>① 在上述继承体系中，每个类都有提供了构造函数、复制构造函数、和赋值操作符重载。</p><p>② logic_error类及其子类、runtime_error类及其子类，它们的构造函数是接受一个string类型的形式参数，用于异常信息的描述</p><p>③ 所有的异常类都有一个what()方法，返回const char* 类型（C风格字符串）的值，描述异常信息。</p><p><strong>标准异常类的具体描述：</strong></p><table><thead><tr><th>异常名称</th><th>描述</th></tr></thead><tbody><tr><td>exception</td><td>所有标准异常类的父类</td></tr><tr><td>bad_alloc</td><td>当operator new and operator new[]，请求分配内存失败时</td></tr><tr><td>bad_exception</td><td>这是个特殊的异常，如果函数的异常抛出列表里声明了bad_exception异常，当函数内部抛出了异常抛出列表中没有的异常，这是调用的unexpected函数中若抛出异常，不论什么类型，都会被替换为bad_exception类型</td></tr><tr><td>bad_typeid</td><td>使用typeid操作符，操作一个NULL指针，而该指针是带有虚函数的类，这时抛出bad_typeid异常</td></tr><tr><td>bad_cast</td><td>使用dynamic_cast转换引用失败的时候</td></tr><tr><td>ios_base::failure</td><td>io操作过程出现错误</td></tr><tr><td>logic_error</td><td>逻辑错误，可以在运行前检测的错误</td></tr><tr><td>runtime_error</td><td>运行时错误，仅在运行时才可以检测的错误</td></tr></tbody></table><p><strong>logic_error的子类：</strong></p><table><thead><tr><th>异常名称</th><th>描述</th></tr></thead><tbody><tr><td>length_error</td><td>试图生成一个超出该类型最大长度的对象时，例如vector的resize操作</td></tr><tr><td>domain_error</td><td>参数的值域错误，主要用在数学函数中。例如使用一个负值调用只能操作非负数的函数</td></tr><tr><td>out_of_range</td><td>超出有效范围</td></tr><tr><td>invalid_argument</td><td>参数不合适。在标准库中，当利用string对象构造bitset时，而string中的字符不是’0’或’1’的时候，抛出该异常</td></tr></tbody></table><p><strong>runtime_error的子类：</strong></p><table><thead><tr><th>异常名称</th><th>描述</th></tr></thead><tbody><tr><td>range_error</td><td>计算结果超出了有意义的值域范围</td></tr><tr><td>overflow_error</td><td>算术计算上溢</td></tr><tr><td>underflow_error</td><td>算术计算下溢</td></tr><tr><td>invalid_argument</td><td>参数不合适。在标准库中，当利用string对象构造bitset时，而string中的字符不是’0’或’1’的时候，抛出该异常</td></tr></tbody></table><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdexcept&gt;</span></span>
class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> age <span class="token operator">&gt;</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			throw <span class="token function">out_of_range</span><span class="token punctuation">(</span><span class="token string">&quot;年龄应该在0-150岁之间!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	try<span class="token punctuation">{</span>
		Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">151</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>out_of_range<span class="token operator">&amp;</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> ex<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="_7-3-2-编写自己的异常类" tabindex="-1"><a class="header-anchor" href="#_7-3-2-编写自己的异常类" aria-hidden="true">#</a> 7.3.2 编写自己的异常类</h4><p>① 标准库中的异常是有限的；</p><p>② 在自己的异常类中，可以添加自己的信息。（标准库中的异常类值允许设置一个用来描述异常的字符串）。</p><p><strong>如何编写自己的异常类？</strong></p><p>① 建议自己的异常类要继承标准异常类。因为C++中可以抛出任何类型的异常，所以我们的异常类可以不继承自标准异常，但是这样可能会导致程序混乱，尤其是当我们多人协同开发时。</p><p>② 当继承标准异常类时，应该重载父类的what函数和虚析构函数。</p><p>③ 因为栈展开的过程中，要复制异常类型，那么要根据你在类中添加的成员考虑是否提供自己的复制构造函数。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//自定义异常类</span>
class MyOutOfRange<span class="token operator">:</span>public exception
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">MyOutOfRange</span><span class="token punctuation">(</span><span class="token keyword">const</span> string  errorInfo<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>m_Error <span class="token operator">=</span> errorInfo<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">MyOutOfRange</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> errorInfo<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		this<span class="token operator">-&gt;</span>m_Error <span class="token operator">=</span> <span class="token function">string</span><span class="token punctuation">(</span> errorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	virtual  <span class="token operator">~</span><span class="token function">MyOutOfRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
	
	<span class="token punctuation">}</span>
	virtual <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>  <span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> this<span class="token operator">-&gt;</span>m_Error<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	string m_Error<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

class Person
<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> age <span class="token operator">&gt;</span> <span class="token number">150</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//抛出异常 越界</span>
			<span class="token comment">//cout &lt;&lt; &quot;越界&quot; &lt;&lt; endl;</span>
			<span class="token comment">//throw  out_of_range(&quot;年龄必须在0~150之间&quot;);</span>

			<span class="token comment">//throw length_error(&quot;长度异常&quot;);</span>
			throw <span class="token function">MyOutOfRange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;我的异常 年龄必须在0~150之间&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			this<span class="token operator">-&gt;</span>m_Age <span class="token operator">=</span> age<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	try
	<span class="token punctuation">{</span>
		Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">151</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span> out_of_range <span class="token operator">&amp;</span> e <span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>length_error <span class="token operator">&amp;</span> e<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">catch</span> <span class="token punctuation">(</span>MyOutOfRange e<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><h2 id="_8-c-输入和输出流" tabindex="-1"><a class="header-anchor" href="#_8-c-输入和输出流" aria-hidden="true">#</a> 8.c++输入和输出流</h2><h3 id="_8-1-流的概念和流类库的结构" tabindex="-1"><a class="header-anchor" href="#_8-1-流的概念和流类库的结构" aria-hidden="true">#</a> 8.1 流的概念和流类库的结构</h3><p>程序的输入指的是从输入文件将数据传送给程序，程序的输出指的是从程序将数据传送给输出文件。</p><p>C++输入输出包含以下三个方面的内容：</p><p>对系统指定的标准设备的输入和输出。即从键盘输入数据，输出到显示器屏幕。这种输入输出称为标准的输入输出，简称标准I/O。</p><p>以外存磁盘文件为对象进行输入和输出，即从磁盘文件输入数据，数据输出到磁盘文件。以外存文件为对象的输入输出称为文件的输入输出，简称文件I/O。</p><p>对内存中指定的空间进行输入和输出。通常指定一个字符数组作为存储空间(实际上可以利用该空间存储任何信息)。这种输入和输出称为字符串输入输出，简称串I/O。</p><p>​ C++编译系统提供了用于输入输出的iostream类库。iostream这个单词是由3个部 分组成的，即i-o-stream，意为输入输出流。在iostream类库中包含许多用于输入输出的 类。常用的见表</p><p><img src="/by-jj/C++/wpsD01B.tmp.jpg" alt="wpsD01B.tmp.jpg"></p><p><img src="/by-jj/C++/wps1B2F.tmp.jpg" alt="wps1B2F.tmp.jpg"></p><p>ios是抽象基类，由它派生出istream类和ostream类，两个类名中第1个字母i和o分别代表输入(input)和输出(output)。 istream类支持输入操作，ostream类支持输出操作， iostream类支持输入输出操作。iostream类是从istream类和ostream类通过多重继承而派生的类。其继承层次见上图表示。</p><p>C++对文件的输入输出需要用ifstrcam和ofstream类，两个类名中第1个字母i和o分别代表输入和输出，第2个字母f代表文件 (file)。ifstream支持对文件的输入操作， ofstream支持对文件的输出操作。类ifstream继承了类istream，类ofstream继承了类ostream，类fstream继承了 类iostream。见图</p><p><img src="/by-jj/C++/wps5B94.tmp.jpg" alt="wps5B94.tmp.jpg"></p><p>I/O类库中还有其他一些类，但是对于一般用户来说，以上这些已能满足需要了。</p><p><strong>与iostream类库有关的头文件</strong></p><p>iostream类库中不同的类的声明被放在不同的头文件中，用户在自己的程序中用#include命令包含了有关的头文件就相当于在本程序中声明了所需 要用到的类。可以换 —种说法：头文件是程序与类库的接口，iostream类库的接口分别由不同的头文件来实现。常用的有</p><ul><li><p>iostream 包含了对输入输出流进行操作所需的基本信息。</p></li><li><p>fstream 用于用户管理的文件的I/O操作。</p></li><li><p>strstream 用于字符串流I/O。</p></li><li><p>stdiostream 用于混合使用C和C + +的I/O机制时，例如想将C程序转变为C++程序。</p></li><li><p>iomanip 在使用格式化I/O时应包含此头文件。</p></li></ul><p><strong>在iostream头文件中定义的流对象</strong></p><p>在 iostream 头文件中定义的类有 ios，istream，ostream，iostream，istream 等。</p><p>在iostream头文件中不仅定义了有关的类，还定义了4种流对象，</p><table><thead><tr><th><strong>对象</strong></th><th><strong>含义</strong></th><th><strong>对应设备</strong></th><th><strong>对应的类</strong></th><th><strong>c语言中相应的标准文件</strong></th></tr></thead><tbody><tr><td>cin</td><td>标准输入流</td><td>键盘</td><td>istream_withassign</td><td>stdin</td></tr><tr><td>cout</td><td>标准输出流</td><td>屏幕</td><td>ostream_withassign</td><td>stdout</td></tr><tr><td>cerr</td><td>标准错误流</td><td>屏幕</td><td>ostream_withassign</td><td>stderr</td></tr><tr><td>clog</td><td>标准日志流</td><td>屏幕</td><td>ostream_withassign</td><td>stderr</td></tr></tbody></table><p>缓冲区的概念:</p><p><img src="/by-jj/C++/wps96BA.tmp.jpg" alt="wps96BA.tmp.jpg"></p><h3 id="_8-2-标准输入流" tabindex="-1"><a class="header-anchor" href="#_8-2-标准输入流" aria-hidden="true">#</a> 8.2 标准输入流</h3><p>标准输入流对象cin，重点掌握的函数</p><p>cin.get() //一次只能读取一个字符</p><p>cin.get(一个参数) //读一个字符</p><p>cin.get(两个参数) //可以读字符串</p><p>cin.getline()</p><p>cin.ignore()</p><p>cin.peek()</p><p>cin.putback()</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//cin.get</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>


	<span class="token comment">//链式编程</span>
	<span class="token keyword">char</span> char1<span class="token punctuation">,</span> char2<span class="token punctuation">,</span> char3<span class="token punctuation">,</span> char4<span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>char1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>char2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>char3<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>char4<span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> char1 <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> char2 <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&quot;</span> <span class="token operator">&lt;&lt;</span> char3 <span class="token operator">&lt;&lt;</span>  <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> char4 <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">//cin.get(buf.1024);</span>
	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> buf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//cin.ignore</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//忽略缓冲区当前字符</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//cin.putback 将数据放回缓冲区</span>
<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token comment">//从缓冲区取走一个字符</span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;从缓冲区取走的字符:&quot;</span> <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//将数据再放回缓冲区</span>
	cin<span class="token punctuation">.</span><span class="token function">putback</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">//cin.peek 偷窥</span>
<span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token comment">//偷窥下缓冲区的数据</span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;偷窥缓冲区数据:&quot;</span> <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//练习  作业 使用cin.get和putback完成类似功能</span>
<span class="token keyword">void</span> <span class="token function">test05</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;请输入一个数字或者字符串:&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> cin<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>ch <span class="token operator">&gt;=</span> <span class="token char">&#39;0&#39;</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&lt;=</span> <span class="token char">&#39;9&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> number<span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> number<span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;数字:&quot;</span> <span class="token operator">&lt;&lt;</span> number <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;字符串:&quot;</span> <span class="token operator">&lt;&lt;</span>  buf <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h3 id="_8-3-标准输出流" tabindex="-1"><a class="header-anchor" href="#_8-3-标准输出流" aria-hidden="true">#</a> 8.3 标准输出流</h3><h4 id="_8-3-1-字符输出" tabindex="-1"><a class="header-anchor" href="#_8-3-1-字符输出" aria-hidden="true">#</a> 8.3.1 字符输出</h4><p>cout.flush() //刷新缓冲区 Linux下有效</p><p>cout.put() //向缓冲区写字符</p><p>cout.write() //从buffer中写num个字节到当前输出流中。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//cout.flush 刷新缓冲区，linux下有效</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>	
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
	<span class="token comment">//刷新缓冲区</span>
	cout<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token comment">//cout.put 输出一个字符</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	cout<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token char">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//链式编程</span>
	cout<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token char">&#39;h&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token char">&#39;e&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token char">&#39;l&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//cout.write 输出字符串 buf,输出多少个</span>
<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token comment">//char* str = &quot;hello world!&quot;;</span>
	<span class="token comment">//cout.write(str, strlen(str));</span>
	<span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">&quot;*************&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h4 id="_8-3-2-格式化输出" tabindex="-1"><a class="header-anchor" href="#_8-3-2-格式化输出" aria-hidden="true">#</a> 8.3.2 格式化输出</h4><p>在输出数据时，为简便起见，往往不指定输出的格式，由系统根据数据的类型采取默认的格式，但有时希望数据按指定的格式输出，如要求以十六进制或八进制形式输出一个整数，对输出的小数只保留两位小数等。有两种方法可以达到此目的。</p><p>1）使用控制符的方法；</p><p>2）使用流对象的有关成员函数。</p><h5 id="_8-3-2-1-使用流对象的有关成员函数" tabindex="-1"><a class="header-anchor" href="#_8-3-2-1-使用流对象的有关成员函数" aria-hidden="true">#</a> 8.3.2.1 使用流对象的有关成员函数</h5><p>通过调用流对象cout中用于控制输出格式的成员函数来控制输出格式。用于控制输出格式的常用的成员函数如下：</p><p><img src="/by-jj/C++/wpsE392.tmp.jpg" alt="wpsE392.tmp.jpg"></p><p>流成员函数setf和控制符setiosflags括号中的参数表示格式状态，它是通过格式标志来指定的。格式标志在类ios中被定义为枚举值。因此在引用这些格式标志时要在前面加上类名ios和域运算符“::”。格式标志见表13.5。</p><p><img src="/by-jj/C++/wps1487.tmp.jpg" alt="wps1487.tmp.jpg"></p><h5 id="_8-3-2-2-控制符格式化输出" tabindex="-1"><a class="header-anchor" href="#_8-3-2-2-控制符格式化输出" aria-hidden="true">#</a> 8.3.2.2 控制符格式化输出</h5><p>C++提供了在输入输出流中使用的控制符(有的书中称为操纵符)。</p><p><img src="/by-jj/C++/wps888F.tmp.jpg" alt="wps888F.tmp.jpg"></p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//通过流成员函数</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	
	<span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token char">&#39;*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">unsetf</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>dec<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//卸载十进制</span>
	cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>hex<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>showbase<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">unsetf</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>hex<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token punctuation">.</span><span class="token function">setf</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>oct<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> number <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">//使用控制符</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
		<span class="token operator">&lt;&lt;</span> <span class="token function">setfill</span><span class="token punctuation">(</span><span class="token char">&#39;~&#39;</span><span class="token punctuation">)</span>
		<span class="token operator">&lt;&lt;</span> <span class="token function">setiosflags</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>showbase<span class="token punctuation">)</span>
		<span class="token operator">&lt;&lt;</span> <span class="token function">setiosflags</span><span class="token punctuation">(</span>ios<span class="token operator">::</span>left<span class="token punctuation">)</span>
		<span class="token operator">&lt;&lt;</span> hex
		<span class="token operator">&lt;&lt;</span> number
		<span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h5 id="_8-3-2-3-对程序的几点说明" tabindex="-1"><a class="header-anchor" href="#_8-3-2-3-对程序的几点说明" aria-hidden="true">#</a> 8.3.2.3 对程序的几点说明</h5><ol><li>成员函数width(n)和控制符setw(n)只对其后的第一个输出项有效。如：</li></ol><p>cout. width(6); cout &lt;&lt;20 &lt;&lt;3.14&lt;&lt;endl; 输出结果为 203.14</p><p>在输出第一个输出项20时，域宽为6，因此在20前面有4个空格，在输出3.14时，width (6)已不起作用，此时按系统默认的域宽输出（按数据实际长度输出）。如果要求在输出数据时都按指定的同一域宽n输出，不能只调用一次width(n)， 而必须在输出每一项前都调用一次width(n&gt;，上面的程序中就是这样做的。</p><ol start="2"><li>在表13.5中的输出格式状态分为5组，每一组中同时只能选用一种（例如dec、hex和oct中只能选一，它们是互相排斥的）。在用成员函数setf和 控制符setiosflags设置输出格式状态后，如果想改设置为同组的另一状态，应当调用成员函数unsetf（对应于成员函数self）或 resetiosflags（对应于控制符setiosflags），先终止原来设置的状态。然后再设置其他状态，大家可以从本程序中看到这点。程序在开 始虽然没有用成员函数self和控制符setiosflags设置用dec输出格式状态，但系统默认指定为dec，因此要改变为hex或oct，也应当先 用unsetf 函数终止原来设置。如果删去程序中的第7行和第10行，虽然在第8行和第11行中用成员函数setf设置了hex和oct格式，由于未终止dec格式，因 此hex和oct的设置均不起作用，系统依然以十进制形式输出。</li></ol><p>同理，程序倒数第8行的unsetf 函数的调用也是不可缺少的。</p><ol start="3"><li>用setf 函数设置格式状态时，可以包含两个或多个格式标志，由于这些格式标志在ios类中被定义为枚举值，每一个格式标志以一个二进位代表，因此可以用位或运算符“|”组合多个格式标志。如倒数第5、第6行可以用下面一行代替：</li></ol><p>cout.setf(ios::internal I ios::showpos); //包含两个状态标志，用&quot;|&quot;组合</p><ol><li>可以看到：对输出格式的控制，既可以用控制符(如例13.2)，也可以用cout流的有关成员函数(如例13.3)，二者的作用是相同的。控制符是在头文件iomanip中定义的，因此用控制符时，必须包含iomanip头文件。cout流的成员函数是在头文件iostream 中定义的，因此只需包含头文件iostream，不必包含iomanip。许多程序人员感到使用控制符方便简单，可以在一个cout输出语句中连续使用多种控制符。</li></ol><h3 id="_8-4-文件读写" tabindex="-1"><a class="header-anchor" href="#_8-4-文件读写" aria-hidden="true">#</a> 8.4 文件读写</h3><h4 id="_8-4-1-文件流类和文件流对象" tabindex="-1"><a class="header-anchor" href="#_8-4-1-文件流类和文件流对象" aria-hidden="true">#</a> 8.4.1 文件流类和文件流对象</h4><p>输入输出是以系统指定的标准设备（输入设备为键盘，输出设备为显示器）为对象的。在实际应用中，常以磁盘文件作为对象。即从磁盘文件读取数据，将数据输出到磁盘文件。</p><p>和文件有关系的输入输出类主要在fstream.h这个头文件中被定义，在这个头文件中主要被定义了三个类，由这三个类控制对文件的各种输入输出操作，他们分别是ifstream、ofstream、fstream，其中fstream类是由iostream类派生而来，他们之间的继承关系见下图所示：</p><p><img src="/by-jj/C++/wpsEAE4.tmp.jpg" alt="wpsEAE4.tmp.jpg"></p><p>由于文件设备并不像显示器屏幕与键盘那样是标准默认设备，所以它在fstream头文件中是没有像cout那样预先定义的全局对象，所以我们必须自己定义一个该类的对象。ifstream类，它是从istream类派生的，用来支持从磁盘文件的输入。ofstream类，它是从ostream类派生的，用来支持向磁盘文件的输出。</p><p>fstream类，它是从iostream类派生的，用来支持对磁盘文件的输入输出。</p><h4 id="_8-4-2-c-打开文件" tabindex="-1"><a class="header-anchor" href="#_8-4-2-c-打开文件" aria-hidden="true">#</a> 8.4.2 c++打开文件</h4><p>所谓打开(open)文件是一种形象的说法，如同打开房门就可以进入房间活动一样。 打开文件是指在文件读写之前做必要的准备工作，包括：</p><p>1）为文件流对象和指定的磁盘文件建立关联，以便使文件流流向指定的磁盘文件。</p><p>2）指定文件的工作方式，如：该文件是作为输入文件还是输出文件，是ASCII文件还是二进制文件等。</p><p>以上工作可以通过两种不同的方法实现:</p><ol><li>调用文件流的成员函数open。如</li></ol><p>ofstream outfile; //定义ofstream类(输出文件流类)对象outfile</p><p>outfile.open(&quot;f1.dat&quot;,ios::out); //使文件流与f1.dat文件建立关联</p><p>第2行是调用输出文件流的成员函数open打开磁盘文件f1.dat，并指定它为输出文件， 文件流对象outfile将向磁盘文件f1.dat输出数据。ios::out是I/O模式的一种，表示 以输出方式打开一个文件。或者简单地说，此时f1.dat是一个输出文件，接收从内存 输出的数据。</p><p>磁盘文件名可以包括路径，如&quot;c:\new\f1.dat&quot;，如缺省路径，则默认为当前目录下的文件。</p><ol start="2"><li>在定义文件流对象时指定参数</li></ol><p>在声明文件流类时定义了带参数的构造函数，其中包含了打开磁盘文件的功能。因此， 可以在定义文件流对象时指定参数，调用文件流类的构造函数来实现打开文件的功能。</p><p><img src="/by-jj/C++/wps2221.tmp.jpg" alt="wps2221.tmp.jpg"></p><p>几点说明：</p><ol><li><p>新版本的I/O类库中不提供ios::nocreate和ios::noreplace。</p></li><li><p>每一个打开的文件都有一个文件指针，该指针的初始位置由I/O方式指定，每次读写都从文件指针的当前位置开始。每读入一个字节，指针就后移一个字节。当文件指针移到最后，就会遇到文件结束EOF（文件结束符也占一个字节，其值为-1)，此时流对象的成员函数eof的值为非0值(一般设为1)，表示文件结束 了。</p></li><li><p>可以用“位或”运算符“|”对输入输出方式进行组合，如表13.6中最后3行所示那样。还可以举出下面一些例子： ios::in | ios:: noreplace //打开一个输入文件，若文件不存在则返回打开失败的信息 ios::app | ios::nocreate //打开一个输出文件，在文件尾接着写数据，若文件不存在，则返回打开失败的信息 ios::out l ios::noreplace //打开一个新文件作为输出文件，如果文件已存在则返回打开失败的信息 ios::in l ios::out I ios::binary //打开一个二进制文件，可读可写 但不能组合互相排斥的方式，如 ios::nocreate l ios::noreplace。</p></li><li><p>如果打开操作失败，open函数的返回值为0(假)，如果是用调用构造函数的方式打开文件的，则流对象的值为0。可以据此测试打开是否成功。如 if(outfile.open(&quot;f1.bat&quot;, ios::app) ==0) cout &lt;&lt;&quot;open error&quot;; 或 if( !outfile.open(&quot;f1.bat&quot;, ios::app) ) cout &lt;&lt;&quot;open error&quot;;</p></li></ol><h4 id="_8-4-3-文件关闭" tabindex="-1"><a class="header-anchor" href="#_8-4-3-文件关闭" aria-hidden="true">#</a> 8.4.3 文件关闭</h4><p>在对已打开的磁盘文件的读写操作完成后，应关闭该文件。关闭文件用成员函数close。如：outfile.close( ); //将输出文件流所关联的磁盘文件关闭 所谓关闭，实际上是解除该磁盘文件与文件流的关联，原来设置的工作方式也失效，这样，就不能再通过文件流对该文件进行输入或输出。此时可以将文件流与其他磁盘文件建立关联，通过文件流对新的文件进行输入或输出。如: outfile.open(&quot;f2.dat&quot;,ios::app|ios::nocreate)；</p><p>此时文件流outfile与f2.dat建立关联，并指定了f2.dat的工作方式。</p><h4 id="_8-4-4-c-对ascll文件的读写操作" tabindex="-1"><a class="header-anchor" href="#_8-4-4-c-对ascll文件的读写操作" aria-hidden="true">#</a> 8.4.4 c++对ASCll文件的读写操作</h4><p>如果文件的每一个字节中均以ASCII代码形式存放数据,即一个字节存放一个字符,这个文件就是ASCII文件(或称字符文件)。程序可以从ASCII文件中读入若干个字符,也可以向它输出一些字符。</p><ol><li><p>用流插入运算符“&lt;&lt;”和流提取运算符“&gt;&gt;”输入输出标准类型的数据。“&lt;&lt;”和“ &gt;&gt;”都巳在iostream中被重载为能用于ostream和istream类对象的标准类型的输入输出。由于ifstream和 ofstream分别是ostream和istream类的派生类；因此它们从ostream和istream类继承了公用的重载函数，所以在对磁盘文件的操作中，可以通过文件流对象和流插入运算符“&lt;&lt;”及 流提取运算符“&gt;&gt;”实现对磁盘 文件的读写，如同用cin、cout和&lt;&lt;、&gt;&gt;对标准设备进行读写一样。</p></li><li><p>用文件流的put、get、geiline等成员函数进行字符的输入输出，：用C++流成员函数put输出单个字符、C++ get()函数读入一个字符和C++ getline()函数读入一行字符。</p></li></ol><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">char</span><span class="token operator">*</span> sourceFileName <span class="token operator">=</span> <span class="token string">&quot;./source.txt&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> targetFileName <span class="token operator">=</span> <span class="token string">&quot;./target.txt&quot;</span><span class="token punctuation">;</span>
	<span class="token comment">//创建文件输入流对象</span>
	ifstream <span class="token function">ism</span><span class="token punctuation">(</span>sourceFileName<span class="token punctuation">,</span> ios<span class="token operator">::</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//创建文件输出流对象</span>
	ofstream <span class="token function">osm</span><span class="token punctuation">(</span>targetFileName<span class="token punctuation">,</span>ios<span class="token operator">::</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ism<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;文件打开失败!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>ism<span class="token punctuation">.</span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		ism<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		osm <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//关闭文件流对象</span>
	ism<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	osm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="_8-4-5-c-对二进制文件的读写操作" tabindex="-1"><a class="header-anchor" href="#_8-4-5-c-对二进制文件的读写操作" aria-hidden="true">#</a> 8.4.5 c++对二进制文件的读写操作</h4><p>二进制文件不是以ASCII代码存放数据的，它将内存中数据存储形式不加转换地传送到磁盘文件，因此它又称为内存数据的映像文件。因为文件中的信息不是字符数据，而是字节中的二进制形式的信息，因此它又称为字节文件。</p><p>对二进制文件的操作也需要先打开文件，用完后要关闭文件。在打开时要用ios::binary指定为以二进制形式传送和存储。二进制文件除了可以作为输入文件或输出文件外,还可以是既能输入又能输出的文件。这是和ASCII文件不同的地方。</p><p><strong>用成员函数read和write读写二进制文件</strong></p><p>对二进制文件的读写主要用istream类的成员函数read和write来实现。这两个成员函数的原型为 istream&amp; read(char *buffer,int len); ostream&amp; write(const char * buffer,int len); 字符指针buffer指向内存中一段存储空间。len是读写的字节数。调用的方式为： a. write(p1,50); b. read(p2,30); 上面第一行中的a是输出文件流对象，write函数将字符指针p1所给出的地址开始的50个字节的内容不加转换地写到磁盘文件中。在第二行中，b是输入文件流对象，read 函数从b所关联的磁盘文件中，读入30个字节(或遇EOF结束），存放在字符指针p2所指的一段空间内。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code>class Person<span class="token punctuation">{</span>
public<span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>this<span class="token operator">-&gt;</span>mName<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		this<span class="token operator">-&gt;</span>mAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
public<span class="token operator">:</span>
	<span class="token keyword">char</span> mName<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> mAge<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

	<span class="token keyword">char</span><span class="token operator">*</span> fileName <span class="token operator">=</span> <span class="token string">&quot;person.txt&quot;</span><span class="token punctuation">;</span>
	<span class="token comment">//二进制模式读写文件</span>
	<span class="token comment">//创建文件对象输出流</span>
	ofstream <span class="token function">osm</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> ios<span class="token operator">::</span>out <span class="token operator">|</span> ios<span class="token operator">::</span>binary<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token string">&quot;Edward&quot;</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//Person对象写入文件</span>
	osm<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p1<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	osm<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p2<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//关闭文件输出流</span>
	osm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//从文件中读取对象数组</span>
	ifstream <span class="token function">ism</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> ios<span class="token operator">::</span>in <span class="token operator">|</span> ios<span class="token operator">::</span>binary<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ism<span class="token punctuation">)</span><span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;打开失败!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	Person p3<span class="token punctuation">;</span>
	Person p4<span class="token punctuation">;</span>

	ism<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p3<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ism<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p4<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Name:&quot;</span> <span class="token operator">&lt;&lt;</span> p3<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> p3<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Age:&quot;</span> <span class="token operator">&lt;&lt;</span> p4<span class="token punctuation">.</span>mName <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; Age:&quot;</span> <span class="token operator">&lt;&lt;</span> p4<span class="token punctuation">.</span>mAge <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">//关闭文件输入流</span>
	ism<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/by-jj/assets/app.f5f78651.js" defer></script>
  </body>
</html>
